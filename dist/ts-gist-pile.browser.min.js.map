{
  "version": 3,
  "sources": ["../src/index.browser.ts", "../src/any/anyUtil.ts", "../src/object/objectUtil.ts", "../src/clone/cloneUtil.ts", "../src/string/stringUtil.ts", "../src/boolean/booleanUtil.ts", "../src/log/logUtil.ts", "../src/env/environmentUtil.ts", "../src/log/smartObfuscate.ts", "../src/log/piiSanitizer.ts", "../src/number/numberUtil.ts", "../src/date/dateUtil.ts", "../src/map/mapUtil.ts", "../src/function/functionUtil.ts", "../src/exception/extendedExceptionList.ts", "../src/exception/ProgrammerErrorException.ts", "../src/exception/BadRequest400Exception.ts", "../src/exception/ActuallyUnauthenticated401Exception.ts", "../src/exception/Forbidden403Exception.ts", "../src/exception/NotFound404Exception.ts", "../src/exception/ArgumentException.ts", "../src/exception/InternalServerError500Exception.ts", "../src/exception/ServiceUnavailable503Exception.ts", "../src/exception/NotImplementedException.ts", "../src/array/arrayUtil.ts", "../src/try/tryUtil.ts", "../src/radix/radixUtil.ts", "../src/uuid/uuidUtil.ts", "../node_modules/uuid/dist/esm-browser/regex.js", "../node_modules/uuid/dist/esm-browser/validate.js", "../node_modules/uuid/dist/esm-browser/parse.js", "../node_modules/uuid/dist/esm-browser/stringify.js", "../node_modules/uuid/dist/esm-browser/rng.js", "../node_modules/uuid/dist/esm-browser/v1.js", "../node_modules/uuid/dist/esm-browser/v1ToV6.js", "../node_modules/uuid/dist/esm-browser/native.js", "../node_modules/uuid/dist/esm-browser/v4.js", "../node_modules/uuid/dist/esm-browser/v6.js", "../node_modules/uuid/dist/esm-browser/v7.js", "../src/id/idUtil.ts", "../src/email/emailUtil.ts", "../src/phone/phoneUtil.ts", "../src/dice/diceUtil.ts", "../src/shortcode/shortcodeUtil.ts", "../src/request/requestUtil.ts", "../src/stat/statUtil.ts", "../node_modules/@opentelemetry/api/src/platform/browser/globalThis.ts", "../node_modules/@opentelemetry/api/src/version.ts", "../node_modules/@opentelemetry/api/src/internal/semver.ts", "../node_modules/@opentelemetry/api/src/internal/global-utils.ts", "../node_modules/@opentelemetry/api/src/diag/ComponentLogger.ts", "../node_modules/@opentelemetry/api/src/diag/types.ts", "../node_modules/@opentelemetry/api/src/diag/internal/logLevelLogger.ts", "../node_modules/@opentelemetry/api/src/api/diag.ts", "../node_modules/@opentelemetry/api/src/context/context.ts", "../node_modules/@opentelemetry/api/src/context/NoopContextManager.ts", "../node_modules/@opentelemetry/api/src/api/context.ts", "../node_modules/@opentelemetry/api/src/trace/trace_flags.ts", "../node_modules/@opentelemetry/api/src/trace/invalid-span-constants.ts", "../node_modules/@opentelemetry/api/src/trace/NonRecordingSpan.ts", "../node_modules/@opentelemetry/api/src/trace/context-utils.ts", "../node_modules/@opentelemetry/api/src/trace/spancontext-utils.ts", "../node_modules/@opentelemetry/api/src/trace/NoopTracer.ts", "../node_modules/@opentelemetry/api/src/trace/ProxyTracer.ts", "../node_modules/@opentelemetry/api/src/trace/NoopTracerProvider.ts", "../node_modules/@opentelemetry/api/src/trace/ProxyTracerProvider.ts", "../node_modules/@opentelemetry/api/src/context-api.ts", "../node_modules/@opentelemetry/api/src/api/trace.ts", "../node_modules/@opentelemetry/api/src/trace-api.ts", "../src/log/getLogger.ts", "../src/retry/retryUtil.ts", "../src/json/jsonUtil.ts", "../src/di/Container.ts", "../src/string/safeStringify.ts", "../src/container/BooleanStringPair.ts", "../src/container/OptionallyCachedValue.ts", "../src/object/ObjectIdFinder.ts", "../src/date/DateProviderServiceImpl.ts", "../src/date/UtcGetterServiceImpl.ts", "../src/date/ImmutableUtc.ts", "../src/uuid/CanonicalUuid.ts", "../src/keyvalue/SimplestKeyValueStoreInMemImpl.ts", "../src/csv/CsvDataExtractor.ts", "../src/llm/LlmQueryImpl.ts", "../src/opentelemetry/api/NoOpAddEventHandler.ts", "../src/opentelemetry/api/NoOpSpanEndHandler.ts", "../src/documentstore/RetryPolicy.ts", "../src/documentstore/ReadAfterWriteOptions.ts"],
  "sourcesContent": ["// Browser-safe subset of ts-gist-pile\n// Excludes Node-only modules: terraform/* (fs/promises), env/set_env (fs/promises), TraceInitializer\n\n// Namespace utility exports\nexport * as anyUtil from \"./any/anyUtil\"\nexport * as objectUtil from \"./object/objectUtil\"\nexport * as cloneUtil from \"./clone/cloneUtil\"\nexport * as stringUtil from \"./string/stringUtil\"\nexport * as booleanUtil from \"./boolean/booleanUtil\"\nexport * as logUtil from \"./log/logUtil\"\nexport * as numberUtil from \"./number/numberUtil\"\nexport * as dateUtil from \"./date/dateUtil\"\nexport * as mapUtil from \"./map/mapUtil\"\nexport * as functionUtil from \"./function/functionUtil\"\nexport * as extendedExceptionList from \"./exception/extendedExceptionList\"\nexport * as arrayUtil from \"./array/arrayUtil\"\nexport * as tryUtil from \"./try/tryUtil\"\nexport * as radixUtil from \"./radix/radixUtil\"\nexport * as uuidUtil from \"./uuid/uuidUtil\"\nexport * as idUtil from \"./id/idUtil\"\nexport * as emailUtil from \"./email/emailUtil\"\nexport * as phoneUtil from \"./phone/phoneUtil\"\nexport * as diceUtil from \"./dice/diceUtil\"\nexport * as shortcodeUtil from \"./shortcode/shortcodeUtil\"\nexport * as requestUtil from \"./request/requestUtil\"\nexport * as retryUtil from \"./retry/retryUtil\"\nexport * as environmentUtil from \"./env/environmentUtil\"\nexport * as statUtil from \"./stat/statUtil\"\nexport * as jsonUtil from \"./json/jsonUtil\"\n\n// Named exports\nexport { Container } from \"./di/Container\"\nexport { getLogger, LOG_RULES, withStoreId } from \"./log/getLogger\"\nexport { d4l, d4lObfuscate, d4lPii, plain, blur, blurIfEnabled, blurWhereNeeded, p4l, b4l, c4l, s4l } from \"./log/logUtil\"\nexport { safeStringify } from \"./string/safeStringify\"\nexport { BooleanStringPair } from \"./container/BooleanStringPair\"\nexport { ResultOrErr } from \"./result/ResultOrErr\"\nexport { ResultTuple } from \"./result/ResultTuple\"\nexport { JsonApiError, DomainError } from \"./error/JsonApiError\"\nexport { CollectionWithMeta } from \"./collection/CollectionWithMeta\"\nexport { OptionallyCachedValue } from \"./container/OptionallyCachedValue\"\nexport { ObjectIdFinder } from \"./object/ObjectIdFinder\"\nexport { JsonValue } from \"./json/JsonValue\"\nexport { DateProviderServiceImpl } from \"./date/DateProviderServiceImpl\"\nexport { DateProviderService } from \"./date/DateProviderService\"\nexport { UtcGetterService } from \"./date/UtcGetterService\"\nexport { UtcGetterServiceImpl } from \"./date/UtcGetterServiceImpl\"\nexport { ImmutableUtc } from \"./date/ImmutableUtc\"\nexport { CanonicalUuid } from \"./uuid/CanonicalUuid\"\nexport { SimplestKeyValueStoreInMemImpl, EvictionMode } from \"./keyvalue/SimplestKeyValueStoreInMemImpl\"\nexport { CsvDataExtractor } from \"./csv/CsvDataExtractor\"\nexport { retryWithBackoff, DEFAULT_RETRY_OPTIONS } from \"./retry/retryUtil\"\nexport { extractIpAddress } from \"./request/requestUtil\"\n\n// LLM types (pure data models)\nexport { LlmQuery } from \"./llm/LlmQuery\"\nexport { LlmQueryImpl } from \"./llm/LlmQueryImpl\"\nexport { LlmQAndA } from \"./llm/LlmQAndA\"\nexport { LlmAnswerMeta } from \"./llm/LlmAnswerMeta\"\nexport { LlmResponse } from \"./llm/LlmResponse\"\nexport { LlmConversationService } from \"./llm/LlmConversationService\"\n\n// Email models (pure data, no SMTP)\nexport { GpEmail } from \"./email/GpEmail\"\nexport { GpEmailGroup } from \"./email/GpEmailGroup\"\nexport { GpEmailMixedMultipart } from \"./email/GpEmailMixedMultipart\"\nexport { GpEmailPart } from \"./email/GpEmailPart\"\n\n// OpenTelemetry (pure interfaces and no-ops)\nexport { AddEventHandlerService } from \"./opentelemetry/AddEventHandlerService\"\nexport { SpanEndHandlingService } from \"./opentelemetry/SpanEndHandlingService\"\nexport { NoOpAddEventHandler } from \"./opentelemetry/api/NoOpAddEventHandler\"\nexport { NoOpSpanEndHandler } from \"./opentelemetry/api/NoOpSpanEndHandler\"\n\n// Document Store interfaces\nexport { DEFAULT_RETRY_POLICY, AGGRESSIVE_RETRY_POLICY } from \"./documentstore/RetryPolicy\"\nexport { DEFAULT_READ_AFTER_WRITE_OPTIONS, FAST_READ_AFTER_WRITE_OPTIONS, PATIENT_READ_AFTER_WRITE_OPTIONS } from \"./documentstore/ReadAfterWriteOptions\"\n\n// EXCLUDED (Node-only):\n// - TerraformParserServiceImpl (fs/promises)\n// - TerraformToEnvConversionServiceImpl (fs/promises)\n// - parseDotenvContent, parseArgs, runSetEnv (fs/promises)\n// - TraceInitializer (commented out in main index too)\n", "export function hasValue(input: any): boolean {\n  if (typeof input === 'undefined' || input === null) {\n    return false;\n  }\n  return true;\n}\n\nexport function isNullish(input: any): boolean {\n  if (typeof input === 'undefined' || input === null) {\n    return true;\n  }\n  return false;\n}\n\n", "// This was moved to cloneUtil\n// cloneDeep now uses native structuredClone()\n\n// Empty export to make this a module\nexport {}\n", "/**\n * Deep clone an object using native structuredClone()\n * Available in Node 17+ and all modern browsers\n */\nexport function cloneDeep<T>(obj: T): T {\n  return structuredClone(obj);\n}\n\n/**\n * Clone an object and apply overrides\n */\nexport function cloneWithOverrides<T>(original: T, overrides: Partial<T>): T {\n  const result = { ...structuredClone(original), ...overrides };\n  return result as T;\n}", "\nexport function isPresent(input: string | undefined | null): boolean {\n  if (input == null) {\n    return false\n  }\n  if (typeof input === 'string') {\n    if (input.trim().length > 0 ) {\n      return true\n    }\n  }\n  return false\n}\n\n//  StringUtils.isBlank(\" \")       = true  \n//  StringUtils.isEmpty(\" \")       = false  \n//  StringUtils.isEmpty(\"\")        = true  \n\nexport function isEmpty(input: string | undefined | null): boolean {\n  if (input == null) {\n    return true\n  }\n  if (typeof input === 'string') {\n    if (input.length === 0 ) {\n      return true\n    }\n  }\n  return false\n}\n\nexport function isBlank(input: string | undefined | null): boolean {\n  if (input == null) {\n    return true\n  }\n  if (typeof input === 'string') {\n    if (input.length >= 0 && input.trim().length === 0 ) {\n      return true\n    }\n  }\n  return false\n}\n\nexport function isWellFormedCanonicalUuid(input: string | undefined | null): boolean {\n  if (input == null) {\n    return false\n  }\n  if (typeof input === 'string') {\n    // Changed 2025: Updated regex from [0-5] to [0-7] to support UUID v6 and v7\n    // UUIDv7 is now commonly used for time-ordered identifiers\n    // Format: xxxxxxxx-xxxx-Vxxx-Nxxx-xxxxxxxxxxxx where V = version (0-7), N = variant (8,9,a,b)\n    const regexp = /^[0-9a-f]{8}-[0-9a-f]{4}-[0-7][0-9a-f]{3}-[089ab][0-9a-f]{3}-[0-9a-f]{12}$/i\n    if (input.toLowerCase().match(regexp)) {\n      return true\n    }\n  }\n  return false\n}\n\nexport function padLeftWithZeros(input: any, notLessThanXDigits: number): string {\n  let workingValue: string = input.toString();\n  while (workingValue.length < notLessThanXDigits) {\n    workingValue = \"0\" + workingValue;\n  }\n  return workingValue;\n}\n\nexport function tryRemoveTrailingSlashesIfPresent(input: string | null | undefined): string| null | undefined {\n  if (input == null) {\n    return input\n  }\n\n  while (input.endsWith(\"\\/\")) {\n    input = input.replace(/\\/$/g, \"\")\n  }\n  return input\n}\n\n\nexport function tryRemoveDoubleSlashesIfPresent(input: string| null | undefined, opt?: { butTryToBeSmartAboutUrls: boolean }): string| null | undefined {\n  if (input == null) {\n    return input\n  }\n  \n  while (input.match(/\\/\\//)) {\n    input = input.replace(/\\/\\//g, \"/\")\n  }\n\n  if (opt?.butTryToBeSmartAboutUrls) {\n    input = input.replace(/^https:\\//, \"https://\")\n    input = input.replace(/^http:\\//, \"http://\")\n    input = input.replace(/^ftp:\\//, \"ftp://\")\n  }\n\n  return input\n}", "export function isTruelike(input: boolean | string | number | undefined | null): boolean {\n  if (input == null) {\n    return false\n  }\n  if ([\n    'true', 'yes', 't', 'y', '1'\n  ].includes(input.toString().trim().toLowerCase())) {\n    return true\n  }\n  return false\n}\n\nexport const doesImplyTrue = isTruelike\nexport const isTrueLike = isTruelike\nexport const isTrueIsh = isTruelike\n", "import { safeStringify } from \"../string/safeStringify\"\nimport { isPIISecureModeEnabled, hashPIIValue, eagerSanitizePII, sanitizePII } from \"./piiSanitizer\"\nimport { isEagerAutoSanitizeEnabled } from \"../env/environmentUtil\"\nimport { smartObfuscate } from \"./smartObfuscate\"\n\nexport function d4l(input: string | number | boolean | Error | Array<any> | any, logOptions: LogOptions = {}): string {\n  if (typeof input === 'undefined') {\n    return \"<undefined> (undefined)\"\n  }\n  else if (input == null) {\n    return \"<null> (null)\"\n  }\n  else if (typeof input === 'string') {\n    if (logOptions.obfuscate) {\n      return smartObfuscate(input);\n    }\n\n    if (logOptions.joinLines) {\n      input = input?.replace(/\\r\\n/g, \" \")\n      input = input?.replace(/\\n\\r/g, \" \")\n      input = input?.replace(/\\n/g, \" \")\n      input = input?.replace(/\\r/g, \" \")      \n    }\n    return `'${input}' (string, ${input.length})`\n  }\n  else if (typeof input === 'number') {\n    return `${input} (number)`\n  }\n  else if (typeof input === 'boolean') {\n    return `${input == true ? 'TRUE' : 'FALSE'} (boolean)`\n  }\n  else if (input instanceof Error) {\n    let stackStr: string | undefined = (input as Error).stack\n    stackStr = stackStr?.replace(/\\r\\n/g, \"\\\\n,   \")\n    stackStr = stackStr?.replace(/\\n\\r/g, \"\\\\n,   \")\n    stackStr = stackStr?.replace(/\\n/g, \"\\\\n,   \")\n    stackStr = stackStr?.replace(/\\r/g, \"\\\\n,   \")\n    return `${input} (Error, stack: ${stackStr}`\n  }\n  else if (Array.isArray(input)) {\n    const parts: string[] = []\n\n    const inputAsArray = (input as Array<any>)\n    if (inputAsArray.length > 0) {\n      parts.push(`${d4l(inputAsArray[0])}`)\n    }\n    if (inputAsArray.length > 2) {\n      parts.push(`\u2026`)\n    }\n    if (inputAsArray.length > 1) {\n      parts.push(`${d4l(inputAsArray[inputAsArray.length-1])}`)\n    }\n\n    return `Array(len=${inputAsArray.length}) [${parts.join(\", \")}]`\n  }\n  else if (Object.prototype.toString.call(input) === '[object Date]') {\n    return (input as Date).toISOString();\n  }  \n  else if (input instanceof RegExp) {\n    return input.toString() + \" (RegExp)\";\n  }\n  else if (typeof input === 'object') {\n    // Apply eager sanitization if enabled\n    let objectToLog = input;\n    if (isEagerAutoSanitizeEnabled()) {\n      objectToLog = eagerSanitizePII(input);\n    }\n\n    if (typeof ((objectToLog as any).toDebugString) === 'function' ) {\n      return (objectToLog as any).toDebugString() + \" (object; via toDebugString())\"\n    }\n    if (typeof ((objectToLog as any).toLogString) === 'function' ) {\n      return (objectToLog as any).toLogString() + \" (object; via toLogString())\"\n    }\n    // Do yourself a huge favor and don't mess with toJSON\n    // if (typeof ((objectToLog as any).toJSON) === 'function' ) {\n    //   const whateverToJSONReturns = (objectToLog as any).toJSON()\n    //   if (typeof whateverToJSONReturns === 'string') {\n    //     return whateverToJSONReturns\n    //   }\n    // }\n\n    if (typeof ((objectToLog as any).asJson) === 'function' ) {\n      const whateverAsJsonReturns = (objectToLog as any).asJson()\n      // return whateverAsJsonReturns\n      try {\n        return localSafeStringify(whateverAsJsonReturns) || `${objectToLog}`\n      } catch (err){}\n    }\n    try {\n      return localSafeStringify(objectToLog) + \" (object)\"\n    } catch (err){}\n  }\n  return `${input}`\n}\n\nexport function d4lObfuscate(input: string | number | boolean | Error | Array<any> | any, logOptions: LogOptions = {}) {\n  // For special object types (Error, Date, RegExp), pass through to d4l\n  if (input instanceof Error || input instanceof Date || input instanceof RegExp) {\n    return d4l(input, logOptions);\n  }\n\n  // For plain objects and arrays, apply eager sanitization\n  if (typeof input === 'object' && input !== null) {\n    const sanitized = eagerSanitizePII(input);\n    return d4l(sanitized, logOptions);\n  }\n\n  // For strings, apply smart obfuscation\n  if (typeof input === 'string') {\n    const obfuscated = smartObfuscate(input);\n\n    // If PII secure mode is enabled, also append the hash for correlation\n    if (isPIISecureModeEnabled() && input.length > 10) {\n      const hash = hashPIIValue(input);\n      return `${obfuscated} (hashed=${hash})`;\n    }\n\n    return obfuscated;\n  }\n\n  return d4l(input, logOptions);\n}\n\n/**\n * Debug-for-logging for PII (Personally Identifiable Information) values.\n *\n * When LOG_HASH_SECRET is UNSET:\n *   - Behaves exactly like d4l() - logs the value normally\n *\n * When LOG_HASH_SECRET is SET:\n *   - Behaves like d4lObfuscate() - shows smart obfuscation with hash\n *   - Uses context-aware obfuscation (emails show domain, cards show last 4, etc.)\n *   - Hash is consistent (same input = same hash)\n *   - Hash is irreversible (cannot recover original value)\n *\n * Use this for values that might contain PII (emails, user IDs, etc.)\n *\n * @example\n * logger.info(`User logged in: ${d4lPii(userId)}`)\n * // Without LOG_HASH_SECRET: \"User logged in: 'user-12345' (string, 10)\"\n * // With LOG_HASH_SECRET: \"User logged in: ****2345 (hashed=abc123def456)\"\n */\nexport function d4lPii(input: string | number | boolean | Error | Array<any> | any, logOptions: LogOptions = {}): string {\n  if (!isPIISecureModeEnabled()) {\n    // PII mode not enabled - use regular d4l (pass through)\n    return d4l(input, logOptions);\n  }\n\n  // PII mode enabled - only obfuscate strings, pass through everything else\n  // d4lPii is designed for use in template strings with individual values,\n  // not for entire objects (use logger context for objects)\n  if (typeof input === 'string') {\n    return d4lObfuscate(input, logOptions);\n  }\n\n  // Pass through non-strings unchanged\n  return d4l(input, logOptions);\n}\n\n/**\n * Helper function to recursively scan object values for PII and redact them.\n * Used by blurWhereNeeded() to handle objects.\n */\nfunction scanObjectForPII(obj: any): any {\n  if (obj == null) return obj;\n  if (typeof obj !== 'object') return obj;\n\n  // Handle arrays\n  if (Array.isArray(obj)) {\n    return obj.map(item => {\n      if (typeof item === 'string') {\n        return scanStringForPII(item);\n      } else if (typeof item === 'object') {\n        return scanObjectForPII(item);\n      }\n      return item;\n    });\n  }\n\n  // Handle objects\n  const scanned: any = {};\n  for (const [key, value] of Object.entries(obj)) {\n    if (typeof value === 'string') {\n      scanned[key] = scanStringForPII(value);\n    } else if (typeof value === 'object' && value !== null) {\n      scanned[key] = scanObjectForPII(value);\n    } else {\n      scanned[key] = value;\n    }\n  }\n\n  return scanned;\n}\n\n/**\n * Helper function to scan a string for PII patterns and redact them.\n * Used by blurWhereNeeded() and scanObjectForPII().\n */\nfunction scanStringForPII(input: string): string {\n  let result = input;\n\n  // Credit card numbers (15-16 digits, with or without separators)\n  result = result.replace(/\\b\\d{4}[\\s\\-]?\\d{4}[\\s\\-]?\\d{4}[\\s\\-]?\\d{3,4}\\b/g, (match) => {\n    const digits = match.replace(/\\D/g, '');\n    if (digits.length >= 15 && digits.length <= 16) {\n      return '****' + match.slice(-4);\n    }\n    return match;\n  });\n\n  // SSN (###-##-####)\n  result = result.replace(/\\b\\d{3}-\\d{2}-\\d{4}\\b/g, (match) => {\n    return '****' + match.slice(-4);\n  });\n\n  // Phone numbers (various formats)\n  result = result.replace(/\\b[\\+]?[\\d\\s\\-\\(\\)]{10,}\\b/g, (match) => {\n    const digits = match.replace(/\\D/g, '');\n    if (digits.length >= 10 && digits.length <= 15) {\n      return '****' + match.slice(-4);\n    }\n    return match;\n  });\n\n  // Email addresses\n  result = result.replace(/\\b[a-zA-Z0-9._%+\\-]+@[a-zA-Z0-9.\\-]+\\.[a-zA-Z]{2,}\\b/g, (match) => {\n    const parts = match.split('@');\n    const local = parts[0];\n    const domain = parts[1];\n    if (local.length <= 2) {\n      return `****@${domain}`;\n    }\n    return `${local.substring(0, 2)}****@${domain}`;\n  });\n\n  // IP addresses (IPv4)\n  result = result.replace(/\\b(?:\\d{1,3}\\.){3}\\d{1,3}\\b/g, (match) => {\n    const parts = match.split('.');\n    if (parts.every(p => parseInt(p) <= 255)) {\n      return `****${match.slice(-4)}`;\n    }\n    return match;\n  });\n\n  // Names (capitalized words, at least 2 words)\n  result = result.replace(/\\b([A-Z][a-z]{2,})\\s+([A-Z][a-z]{2,})\\b/g, (match, first, last) => {\n    return `${first.substring(0, 2)}**** ${last.substring(0, 2)}****`;\n  });\n\n  return result;\n}\n\n/**\n * Smart content-aware PII detection and redaction.\n *\n * Scans text for PII patterns (emails, SSNs, phone numbers, credit cards, IPs, etc.)\n * and redacts ONLY those parts while keeping the rest of the text readable.\n *\n * \u26A0\uFE0F PERFORMANCE WARNING: This is the slowest logging option as it performs\n * multiple regex scans on the content. Use sparingly for user input, error messages,\n * or other free-form text that might contain PII.\n *\n * Always active when called - does not depend on environment variables.\n *\n * @example\n * blurWhereNeeded(\"My email is john@example.com\")\n * // \u2192 \"My email is jo****@example.com\"\n *\n * blurWhereNeeded(\"Call me at 555-123-4567 or email alice@example.com\")\n * // \u2192 \"Call me at ****4567 or email al****@example.com\"\n *\n * blurWhereNeeded(\"SSN: 123-45-6789, Card: 4532-1234-5678-9012\")\n * // \u2192 \"SSN: ****6789, Card: ****9012\"\n */\nexport function blurWhereNeeded(input: string | number | boolean | Error | Array<any> | any, logOptions: LogOptions = {}): string {\n  // For objects, recursively apply content scanning to all string values\n  if (typeof input === 'object' && input !== null) {\n    const scanned = scanObjectForPII(input);\n    return d4l(scanned, logOptions);\n  }\n\n  // For non-string primitives, use regular d4l\n  if (typeof input !== 'string') {\n    return d4l(input, logOptions);\n  }\n\n  // For strings, use the helper function\n  return scanStringForPII(input);\n}\n\n// Aliases for cleaner API\nexport const plain = d4l;\nexport const blur = d4lObfuscate;\nexport const blurIfEnabled = d4lPii;\n\n/**\n * Short aliases for frequent use (all 3 characters for consistency):\n *\n * d4l - Direct/decorate for logging (plain output with type info)\n * p4l - Plain for logging (same as d4l)\n * b4l - Blur for logging (always obfuscates)\n * c4l - Conditional for logging (blur only if LOG_HASH_SECRET set)\n * s4l - Scan for logging (content-aware PII detection, always active)\n */\nexport const p4l = d4l;                // plain for logging (alias for d4l)\nexport const b4l = d4lObfuscate;       // blur for logging (always)\nexport const c4l = d4lPii;             // conditional for logging (blur if enabled)\nexport const s4l = blurWhereNeeded;    // scan for logging (content-aware PII)\n\nexport type LogOptions = {\n  joinLines?: boolean\n  obfuscate?: boolean\n}\n\nconst localSafeStringify = (obj: any, indent = 0) => {\n  let cache: any = []\n  try {\n    const retval = JSON.stringify(\n      obj,\n      (key, value) => {\n        // https://stackoverflow.com/questions/12075927/serialization-of-regexp\n\n        if (value instanceof RegExp) {\n          return value.toString();\n        }\n        return typeof value === 'object' && value !== null\n          ? cache.includes(value)\n            ? undefined // Duplicate reference found, discard key\n            : cache.push(value) && value // Store value in our collection\n          : value\n      },\n      indent\n    )\n    cache = null\n    return retval\n  } catch (err) {\n    cache = null\n    return undefined;\n  }  \n}", "\n\nconst memoized = new Map<string, true>();\n\n/**\n * Resets the memoization cache for tryGetEnvVar.\n * This is primarily useful for testing.\n * @internal\n */\nexport function resetEnvVarCache(): void {\n  memoized.clear();\n}\n\nexport function tryGetEnvVar(envVarName: string): string | undefined {\n  // @ts-ignore: import.meta may not be recognized depending on tsconfig/module system\n  let retval: string | undefined = undefined;\n\n  if (typeof retval === 'undefined') {\n    if (typeof process !== 'undefined' && typeof process.env?.[envVarName] !== 'undefined') {\n      retval = process.env[envVarName];\n      if (!memoized.has(`process.env.${envVarName}`)) {\n        console.log(`ts-gist-pile: tryGetEnvVar(): During logger configuration, found process.env[${envVarName}] = ${retval}`);\n        memoized.set(`process.env.${envVarName}`, true);\n      }\n    }\n  }\n\n  const prefixes = [`REACT_APP_`, `VITE_`]\n  for (let ii = 0; ii < prefixes.length; ++ii) {\n    const prefix = prefixes[ii]\n\n    if (/* typeof window !== \"undefined\" && */ typeof retval === 'undefined') {\n      const effectiveEnvVarName = `${prefix}${envVarName}`;\n\n      if (typeof process !== 'undefined' && typeof process.env?.[effectiveEnvVarName] !== 'undefined') {\n        retval = process.env[effectiveEnvVarName];\n        if (!memoized.has(`process.env.${effectiveEnvVarName}`)) {\n          console.log(`ts-gist-pile: tryGetEnvVar(): During logger configuration, found process.env[${effectiveEnvVarName}] = ${retval}`);\n          memoized.set(`process.env.${effectiveEnvVarName}`, true);\n        }\n      }\n    }\n  }\n\n  return retval;\n}\n\nexport function isProductionLikeEnv(): boolean {\n  const nodeEnv = tryGetEnvVar('NODE_ENV');\n  return nodeEnv === 'production' || nodeEnv === 'prod';\n}\n\nexport function isDevelopmentLikeEnv(): boolean {\n  const nodeEnv = tryGetEnvVar('NODE_ENV');\n  return nodeEnv === 'development' || nodeEnv === 'dev';\n}\n\nexport function isStagingLikeEnv(): boolean {\n  const nodeEnv = tryGetEnvVar('NODE_ENV');\n  return nodeEnv === 'staging' || nodeEnv === 'stage';\n}\n\nexport function isTestLikeEnv(): boolean {\n  const nodeEnv = tryGetEnvVar('NODE_ENV');\n  return nodeEnv === 'test';\n}\n\nexport function isEagerAutoSanitizeEnabled(): boolean {\n  const value = tryGetEnvVar('LOG_EAGER_AUTO_SANITIZE');\n  return isTruelike(value);\n}\n\nfunction isTruelike(input: boolean | string | number | undefined): boolean {\n  if (input == null) {\n    return false;\n  }\n  if (['true', 'yes', 't', 'y', '1'].includes(input.toString().trim().toLowerCase())) {\n    return true;\n  }\n  return false;\n}", "/**\n * Smart context-aware obfuscation that detects data type and applies appropriate masking.\n *\n * This function analyzes the input string and applies the most appropriate obfuscation\n * strategy based on the detected pattern:\n *\n * - **Credit cards** (15-16 digits): Shows last 4 (PCI DSS compliant)\n * - **SSN** (###-##-####): Shows last 4 (HIPAA compliant)\n * - **Phone numbers**: Shows last 4 digits\n * - **Emails**: Shows first 2 chars + full domain (GDPR compliant, more recognizable)\n * - **Names** (capitalized words): Shows first 2 of first and last word\n * - **Everything else**: Length-based obfuscation\n *\n * All obfuscation patterns are fully compliant with:\n * - PCI DSS (Payment Card Industry Data Security Standard)\n * - HIPAA (Health Insurance Portability and Accountability Act)\n * - GDPR (General Data Protection Regulation)\n * - SOC 2 (System and Organization Controls)\n *\n * @param input - The string to obfuscate\n * @returns Obfuscated string\n *\n * @example\n * smartObfuscate('4532123456789012')           // '****9012' (CC last 4)\n * smartObfuscate('user@example.com')           // 'us****@example.com' (email)\n * smartObfuscate('+1-555-123-4567')            // '****4567' (phone)\n * smartObfuscate('123-45-6789')                // '****6789' (SSN)\n * smartObfuscate('John Smith')                 // 'Jo**** Sm****' (name)\n * smartObfuscate('MySecurePassword123!')       // '****123!' (password)\n */\nexport function smartObfuscate(input: string): string {\n  const len = input.length;\n\n  // Credit card: 15-16 digits (show last 4, industry standard)\n  if (/^\\d{15,16}$/.test(input)) {\n    return `****${input.substring(len-4)}`;\n  }\n\n  // Credit card with dashes or spaces: show last 4\n  if (/^[\\d\\s\\-]{15,19}$/.test(input) && /\\d{4}/.test(input.substring(len-4))) {\n    return `****${input.substring(len-4)}`;\n  }\n\n  // SSN format: show last 4\n  if (/^\\d{3}-\\d{2}-\\d{4}$/.test(input)) {\n    return `****${input.substring(len-4)}`;\n  }\n\n  // Phone number patterns: show last 4 digits\n  if (/^\\+?[\\d\\s\\-()]{10,}$/.test(input)) {\n    // Extract just the digits\n    const digits = input.replace(/\\D/g, '');\n    if (digits.length >= 10) {\n      return `****${input.substring(len-4)}`;\n    }\n  }\n\n  // Email: show first 2 and full domain (more recognizable than just domain)\n  // Only match if it looks like an email (has @ with alphanumeric on both sides)\n  if (input.includes('@') && input.includes('.') && /^[a-zA-Z0-9]/.test(input)) {\n    const parts = input.split('@');\n    if (parts.length === 2 && parts[0].length > 0 && /^[a-zA-Z0-9]/.test(parts[1])) {\n      const local = parts[0];\n      const domain = parts[1];\n      if (local.length <= 2) {\n        return `****@${domain}`;\n      }\n      return `${local.substring(0, 2)}****@${domain}`;\n    }\n  }\n\n  // Name-like (starts with capital, has spaces, mostly letters)\n  if (/^[A-Z][a-z]+(\\s+[A-Z][a-z]+)+$/.test(input)) {\n    const words = input.split(' ');\n    return `${words[0].substring(0, 2)}**** ${words[words.length-1].substring(0, 2)}****`;\n  }\n\n  // Default: show last N chars based on length\n  if (len > 36) return `****${input.substring(len-6)}`;\n  if (len > 26) return `****${input.substring(len-5)}`;\n  if (len > 16) return `****${input.substring(len-4)}`;\n  if (len > 10) return `****${input.substring(len-2)}`;\n  return \"****\";\n}\n", "import { tryGetEnvVar } from \"../env/environmentUtil\"\nimport { smartObfuscate } from \"./smartObfuscate\";\n\n// Conditionally import crypto only in Node.js\nlet nodeCrypto: any;\nif (typeof window === \"undefined\" && typeof global !== \"undefined\") {\n  try {\n    nodeCrypto = require(\"crypto\");\n  } catch (err) {\n    // Crypto not available\n  }\n}\n\n/**\n * PII field names to be sanitized when LOG_HASH_SECRET is set or LOG_EAGER_AUTO_SANITIZE is enabled.\n * Includes common patterns for personally identifiable information.\n */\nconst PII_FIELDS = [\n  // User identifiers\n  'userId', 'user_id', 'principalId', 'principal_id', 'uid', 'login',\n  'username', 'user_name', 'userName',\n\n  // Email variations\n  'email', 'e_mail', 'e-mail', 'eMail', 'Email',\n  'emailAddress', 'email_address', 'emailSanitized', 'email_sanitized',\n  'emailNormalized', 'email_normalized',\n\n  // Names\n  'name', 'fullname', 'fullName', 'full_name',\n  'firstName', 'first_name', 'lastName', 'last_name',\n  'middleName', 'middle_name',\n\n  // Contact information\n  'phone', 'phoneNumber', 'phone_number', 'telephone', 'mobile', 'cellPhone',\n\n  // Sensitive identifiers\n  'ssn', 'socialSecurity', 'social_security',\n  'dob', 'dateOfBirth', 'date_of_birth', 'birthdate', 'birth_date',\n  'passport', 'passportNumber', 'passport_number',\n  'license', 'driversLicense', 'drivers_license', 'driverLicense', 'driver_license',\n\n  // Financial information\n  'creditCard', 'credit_card', 'creditCardNumber', 'credit_card_number',\n  'ccNumber', 'cc_number', 'cardNumber', 'card_number',\n  'cvv', 'cvc', 'securityCode', 'security_code',\n  'accountNumber', 'account_number', 'bankAccount', 'bank_account',\n  'routingNumber', 'routing_number',\n\n  // Location information\n  'address', 'street', 'streetAddress', 'street_address',\n  'city', 'state', 'province',\n  'zip', 'zipCode', 'zip_code', 'postal', 'postalCode', 'postal_code',\n  'country',\n  'ip', 'ipAddress', 'ip_address', 'ipv4', 'ipv6',\n  'lat', 'latitude', 'lon', 'longitude', 'coordinates',\n\n  // Authentication & Security\n  'password', 'passwd', 'pwd', 'pass',\n  'secret', 'apiKey', 'api_key', 'accessToken', 'access_token',\n  'refreshToken', 'refresh_token', 'token', 'auth', 'authToken', 'auth_token',\n  'privateKey', 'private_key', 'publicKey', 'public_key',\n\n  // Medical information\n  'medicalRecordNumber', 'medical_record_number', 'mrn',\n  'healthInsurance', 'health_insurance', 'insuranceNumber', 'insurance_number'\n];\n\n/**\n * Checks if PII Secure Mode is enabled.\n * Requires both Node.js environment and LOG_HASH_SECRET to be set.\n */\nexport function isPIISecureModeEnabled(): boolean {\n  if (typeof window !== \"undefined\") {\n    // Browser environment - PII mode not supported\n    return false;\n  }\n\n  const secret = tryGetEnvVar('LOG_HASH_SECRET');\n  return secret != null && secret.trim().length > 0 && nodeCrypto != null;\n}\n\n/**\n * Creates a consistent, irreversible hash for logging.\n * HIPAA/GDPR compliant for de-identification.\n *\n * @param value - The value to hash\n * @returns 12-character hex hash (48 bits of entropy)\n */\nfunction hashPII(value: string | null | undefined): string {\n  if (value == null) return 'null';\n\n  if (!nodeCrypto) {\n    // Fallback if crypto is not available\n    return '****';\n  }\n\n  const secret = tryGetEnvVar('LOG_HASH_SECRET') || '';\n\n  try {\n    return nodeCrypto\n      .createHash('sha256')\n      .update(value + secret)\n      .digest('hex')\n      .substring(0, 12); // 12 hex chars = 48 bits of entropy\n  } catch (err) {\n    // Fallback on error\n    return '****';\n  }\n}\n\n/**\n * Public function to hash a single PII value.\n * Used by d4lPii() and other utilities that need to hash individual values.\n *\n * @param value - The value to hash\n * @returns 12-character hex hash (48 bits of entropy)\n */\nexport function hashPIIValue(value: string | null | undefined): string {\n  return hashPII(value);\n}\n\n/**\n * Sanitizes an object by hashing known PII fields.\n * Only active when LOG_HASH_SECRET environment variable is set.\n *\n * @param obj - Object potentially containing PII\n * @returns Sanitized object with PII fields hashed\n */\nexport function sanitizePII(obj: any): any {\n  if (!isPIISecureModeEnabled()) {\n    // PII mode not enabled, return as-is\n    return obj;\n  }\n\n  if (obj == null) return obj;\n  if (typeof obj !== 'object') return obj;\n\n  // Handle arrays\n  if (Array.isArray(obj)) {\n    return obj.map(item => sanitizePII(item));\n  }\n\n  // Handle objects\n  const sanitized: any = {};\n\n  for (const [key, value] of Object.entries(obj)) {\n    const lowerKey = key.toLowerCase();\n    // Strip leading underscore for matching (e.g., _userId should match userId)\n    const keyWithoutUnderscore = lowerKey.startsWith('_') ? lowerKey.substring(1) : lowerKey;\n\n    const isPIIField = PII_FIELDS.some(piiField => {\n      const lowerPIIField = piiField.toLowerCase();\n      return (\n        lowerKey === lowerPIIField ||\n        keyWithoutUnderscore === lowerPIIField ||\n        lowerKey.includes(lowerPIIField) ||\n        keyWithoutUnderscore.includes(lowerPIIField)\n      );\n    });\n\n    if (isPIIField) {\n      // Replace PII field with hashed version\n      const hashedKey = `${key}_hash`;\n      sanitized[hashedKey] = hashPII(value != null ? String(value) : value);\n      // Original field is NOT included\n    } else if (typeof value === 'object' && value !== null) {\n      // Recursively sanitize nested objects\n      sanitized[key] = sanitizePII(value);\n    } else {\n      // Keep non-PII fields as-is\n      sanitized[key] = value;\n    }\n  }\n\n  return sanitized;\n}\n\n/**\n * Gets the list of PII field names that will be sanitized.\n * Useful for documentation and testing.\n */\nexport function getPIIFieldNames(): string[] {\n  return [...PII_FIELDS];\n}\n\n/**\n * Scans a string value for PII patterns and redacts them.\n * Used by eagerSanitizePII to check values even when field names don't indicate PII.\n */\nfunction scanStringValueForPII(input: string): string {\n  let result = input;\n\n  // Credit card numbers (15-16 digits, with or without separators)\n  result = result.replace(/\\b\\d{4}[\\s\\-]?\\d{4}[\\s\\-]?\\d{4}[\\s\\-]?\\d{3,4}\\b/g, (match) => {\n    const digits = match.replace(/\\D/g, '');\n    if (digits.length >= 15 && digits.length <= 16) {\n      return '****' + match.slice(-4);\n    }\n    return match;\n  });\n\n  // SSN (###-##-####)\n  result = result.replace(/\\b\\d{3}-\\d{2}-\\d{4}\\b/g, (match) => {\n    return '****' + match.slice(-4);\n  });\n\n  // Phone numbers (various formats)\n  result = result.replace(/\\b[\\+]?[\\d\\s\\-\\(\\)]{10,}\\b/g, (match) => {\n    const digits = match.replace(/\\D/g, '');\n    if (digits.length >= 10 && digits.length <= 15) {\n      return '****' + match.slice(-4);\n    }\n    return match;\n  });\n\n  // Email addresses\n  result = result.replace(/\\b[a-zA-Z0-9._%+\\-]+@[a-zA-Z0-9.\\-]+\\.[a-zA-Z]{2,}\\b/g, (match) => {\n    const parts = match.split('@');\n    const local = parts[0];\n    const domain = parts[1];\n    if (local.length <= 2) {\n      return `****@${domain}`;\n    }\n    return `${local.substring(0, 2)}****@${domain}`;\n  });\n\n  // IP addresses (IPv4)\n  result = result.replace(/\\b(?:\\d{1,3}\\.){3}\\d{1,3}\\b/g, (match) => {\n    const parts = match.split('.');\n    if (parts.every(p => parseInt(p) <= 255)) {\n      return `****${match.slice(-4)}`;\n    }\n    return match;\n  });\n\n  // Names (capitalized words, at least 2 words)\n  result = result.replace(/\\b([A-Z][a-z]{2,})\\s+([A-Z][a-z]{2,})\\b/g, (match, first, last) => {\n    return `${first.substring(0, 2)}**** ${last.substring(0, 2)}****`;\n  });\n\n  return result;\n}\n\n/**\n * Eagerly sanitizes an object by detecting and obfuscating known PII fields.\n * This function works INDEPENDENTLY of LOG_HASH_SECRET - it always sanitizes when called.\n *\n * Key differences from sanitizePII():\n * - Always active (does not check isPIISecureModeEnabled)\n * - Keeps original field names (no _redacted suffix)\n * - Replaces PII values with obfuscated versions (e.g., \"****me\" for \"password\")\n * - When LOG_HASH_SECRET is set, also includes hash: \"****me (hashed=abc123)\"\n *\n * Use this when LOG_EAGER_AUTO_SANITIZE is enabled to automatically\n * protect sensitive data before it reaches the logger.\n *\n * @param obj - Object potentially containing PII\n * @returns Sanitized object with PII field values obfuscated\n */\nexport function eagerSanitizePII(obj: any): any {\n  if (obj == null) return obj;\n  if (typeof obj !== 'object') return obj;\n\n  // Handle arrays\n  if (Array.isArray(obj)) {\n    return obj.map(item => eagerSanitizePII(item));\n  }\n\n  // Handle objects\n  const sanitized: any = {};\n\n  for (const [key, value] of Object.entries(obj)) {\n    const lowerKey = key.toLowerCase();\n    // Strip leading underscore for matching (e.g., _userId should match userId)\n    const keyWithoutUnderscore = lowerKey.startsWith('_') ? lowerKey.substring(1) : lowerKey;\n\n    const isPIIField = PII_FIELDS.some(piiField => {\n      const lowerPIIField = piiField.toLowerCase();\n      return (\n        lowerKey === lowerPIIField ||\n        keyWithoutUnderscore === lowerPIIField ||\n        lowerKey.includes(lowerPIIField) ||\n        keyWithoutUnderscore.includes(lowerPIIField)\n      );\n    });\n\n    if (isPIIField && typeof value === 'string') {\n      // Use smart context-aware obfuscation\n      let obfuscated = smartObfuscate(value);\n\n      // If LOG_HASH_SECRET is set, also add hash for correlation\n      if (isPIISecureModeEnabled() && value.length > 10) {\n        const hash = hashPIIValue(value);\n        obfuscated = `${obfuscated} (hashed=${hash})`;\n      }\n\n      // Keep original field name, just obfuscate the value\n      sanitized[key] = obfuscated;\n    } else if (isPIIField && value != null) {\n      // For non-string PII values, convert to string first then obfuscate\n      const stringValue = String(value);\n      let obfuscated = smartObfuscate(stringValue);\n\n      if (isPIISecureModeEnabled() && stringValue.length > 10) {\n        const hash = hashPIIValue(stringValue);\n        obfuscated = `${obfuscated} (hashed=${hash})`;\n      }\n\n      sanitized[key] = obfuscated;\n    } else if (typeof value === 'string') {\n      // For non-PII field names, still scan the string value for PII patterns\n      // This catches cases like keyIsPrettyNormal: \"bob@example.com\"\n      const scanned = scanStringValueForPII(value);\n      sanitized[key] = scanned;\n    } else if (typeof value === 'object' && value !== null) {\n      // Recursively sanitize nested objects\n      sanitized[key] = eagerSanitizePII(value);\n    } else {\n      // Keep non-PII fields as-is\n      sanitized[key] = value;\n    }\n  }\n\n  return sanitized;\n}\n", "export function tryAsNumber( input: string | number | null | undefined ): undefined | number | null {\n  if (typeof input == 'number') {\n    return input\n  }\n  else if (typeof input == 'undefined') {\n    return undefined\n  }\n  else if (input == null) {\n    return null\n  }\n  else if (typeof input == 'string') {\n    const workingInput = input.trim()\n    if (workingInput.length > 0 && \n        !isNaN(workingInput as unknown as number)) {\n      try {\n        return parseFloat(input)\n      } catch(err) {\n      }\n    }\n  } \n  return undefined\n}\n\n/**\n * Converts the input into a number if it can.  Otherwise, throws an error.\n * \n * @param input \n * @returns \n */\n\nexport function ensureNumber( input: string | number ): number {\n  if (typeof input == 'number') {\n    return input\n  }\n  else if (typeof input == 'string') {\n    const workingInput = input.trim()\n    if (workingInput.length > 0 && \n        !isNaN(workingInput as unknown as number)) {\n      try {\n        return parseFloat(input)\n      } catch (err) {\n        throw err\n      }\n    }\n  }\n  throw new Error(`Not a number`)\n}\n\n\n", "/**\n * \n * @param year \n * @returns Array of starting unixtime in SECONDS\n */\n\nexport function generateSortedFiveMinuteBucketsForYearInSeconds(year: number): number[] {\n  const firstMomentOfYear = Date.UTC(year, 0, 0, 0, 0, 0)\n  const firstMomentOfNextYear = Date.UTC(year + 1, 0, 0, 0, 0, 0)\n\n  const retval = []\n  let workingValueInMilliseconds = firstMomentOfYear\n  while (workingValueInMilliseconds < firstMomentOfNextYear) {\n    retval.push(workingValueInMilliseconds / 1000) // array of seconds NOT milliseconds\n    workingValueInMilliseconds += (5 * 60 * 1000) // 5 minutes in seconds later\n  }\n  return retval\n}\n\nexport function dateToYyyyMmDdStringAtUtc(date: Date): string {\n  const dateAtUtc: Date = new Date(date.toUTCString())\n  const yyyyMmDdString = `${dateAtUtc.getUTCFullYear()}${padLeftWithZeros(dateAtUtc.getUTCMonth() + 1, 2)}${padLeftWithZeros(dateAtUtc.getUTCDate(), 2)}` \n  return yyyyMmDdString\n}\n\nexport function getDateInLondon(date: Date): Date {\n  const dateAtUtc: Date = new Date(date.toUTCString())\n  return dateAtUtc\n}\n\nfunction padLeftWithZeros(input: any, notLessThanXDigits: number): string {\n  let workingValue: string = input.toString();\n  while (workingValue.length < notLessThanXDigits) {\n    workingValue = \"0\" + workingValue;\n  }\n  return workingValue;\n}\n\n\n/**\n * This can return a negative number if the start date is after the end date.\n * @param start \n * @param end \n * @returns a positive or negative number representing milliseconds between the two dates.\n */\nexport function getMillisecondsBetweenDates(start: Date, end: Date): number {\n  return end.getTime() - start.getTime()\n}\n\n/**\n * This can return a negative number if the start date is after the end date.\n * @param start \n * @param end \n * @returns a positive or negative number representing seconds between the two dates.\n */\nexport function getSecondsBetweenDates(start: Date, end: Date): number {\n  // Returns the number of seconds between two dates.\n  return Math.floor((end.getTime() - start.getTime()) / 1000);\n}\n\n\nexport function getSecondsBetweenEpochAndDate(date: Date): number {\n  // Returns the number of seconds since the Unix epoch (January 1, 1970).\n  return Math.floor(date.getTime() / 1000);\n}\n\nexport function getMillisecondsBetweenEpochAndDate(date: Date): number {\n  // Returns the number of milliseconds since the Unix epoch (January 1, 1970).\n  return date.getTime();\n} \n\n\n// https://stackoverflow.com/questions/643782/how-to-check-whether-an-object-is-a-date\nexport function isValidDateObject(obj: any): boolean {\n  return !!(obj && Object.prototype.toString.call(obj) === \"[object Date]\" && !isNaN(obj));\n}\n\nexport function isIso8601(input: string): boolean {\n  if (typeof input !== 'string') {\n    return false\n  }\n  return (new Date(input)).toISOString() === input\n}\n\nexport function isIso8601Utc(input: string): boolean {\n  if (typeof input !== 'string') {\n    return false\n  }\n  // return (new Date(input)).toISOString() === input && input.endsWith('Z')\n\n  if (!/\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}.\\d{3}Z/.test(input)) return false;\n  const d = new Date(input); \n  return !isNaN(d.getTime()) && d.toISOString()===input; // valid date \n\n  // https://stackoverflow.com/questions/52869695/check-if-a-date-string-is-in-iso-and-utc-format\n}", "// https://stackoverflow.com/questions/35341696/how-to-convert-map-keys-to-array\nexport function getKeys<T>(myMap: Map<T, any>): Array<T> {\n  return Array.from(myMap.keys());\n}", "export const tryFn = <T>(fn: () => T): T | undefined => {\n  try {\n    return fn()\n  } catch (e) {\n    return undefined\n  }\n}", "export { ProgrammerErrorException } from \"./ProgrammerErrorException\"\nexport { BadRequest400Exception } from \"./BadRequest400Exception\"\nexport { ActuallyUnauthenticated401Exception } from \"./ActuallyUnauthenticated401Exception\"\nexport { Forbidden403Exception } from \"./Forbidden403Exception\"\nexport { NotFound404Exception } from \"./NotFound404Exception\"\nexport { ArgumentException } from \"./ArgumentException\"\nexport { InternalServerError500Exception } from \"./InternalServerError500Exception\"\nexport { ServiceUnavailable503Exception } from \"./ServiceUnavailable503Exception\"\nexport { NotImplementedException } from \"./NotImplementedException\"\n", "export class ProgrammerErrorException extends Error {\n  constructor(msg: string | undefined = undefined) {\n    super(`ProgrammerErrorException${msg ? ': ' + msg : ''}`);\n\n    // Set the prototype explicitly.\n    Object.setPrototypeOf(this, ProgrammerErrorException.prototype);\n  }\n}\n", "export class BadRequest400Exception extends Error {\n  public readonly statusCode: number = 400;\n\n  constructor(msg: string | undefined = undefined) {\n    super(`BadRequest400Exception${msg ? ': ' + msg : ''}`);\n\n    // Set the prototype explicitly.\n    Object.setPrototypeOf(this, BadRequest400Exception.prototype);\n  }\n}\n", "/**\n * HTTP standard says this means Unauthorized\n * but actually it means Unauthenticated\n */\n\nexport class ActuallyUnauthenticated401Exception extends Error {\n  public readonly statusCode: number = 401;\n\n  constructor(msg: string | undefined = undefined) {\n    super(`ActuallyUnauthenticated401Exception${msg ? ': ' + msg : ''}`);\n\n    // Set the prototype explicitly.\n    Object.setPrototypeOf(this, ActuallyUnauthenticated401Exception.prototype);\n  }\n}\n", "/**\n * HTTP standard says this means Unauthorized\n * but actually it means Unauthenticated\n */\n\nexport class Forbidden403Exception extends Error {\n  public readonly statusCode: number = 403;\n\n  constructor(msg: string | undefined = undefined) {\n    super(`Forbidden403Exception${msg ? ': ' + msg : ''}`);\n\n    // Set the prototype explicitly.\n    Object.setPrototypeOf(this, Forbidden403Exception.prototype);\n  }\n}\n", "export class NotFound404Exception extends Error {\n  public readonly statusCode: number = 404;\n\n  constructor(msg: string | undefined = undefined) {\n    super(`NotFound404Exception${msg ? ': ' + msg : ''}`);\n\n    // Set the prototype explicitly.\n    Object.setPrototypeOf(this, NotFound404Exception.prototype);\n  }\n}\n", "export class ArgumentException extends Error {\n  constructor(msg: string | undefined = undefined) {\n    super(`ArgumentException${msg ? ': ' + msg : ''}`);\n\n    // Set the prototype explicitly.\n    Object.setPrototypeOf(this, ArgumentException.prototype);\n  }\n}\n", "export class InternalServerError500Exception extends Error {\n  public readonly statusCode: number = 500;\n\n  constructor(msg: string | undefined = undefined) {\n    super(`InternalServerError500Exception${msg ? ': ' + msg : ''}`);\n\n    // Set the prototype explicitly.\n    Object.setPrototypeOf(this, InternalServerError500Exception.prototype);\n  }\n}\n", "export class ServiceUnavailable503Exception extends Error {\n  public readonly statusCode: number = 503;\n\n  constructor(msg: string | undefined = undefined) {\n    super(`ServiceUnavailable503Exception${msg ? ': ' + msg : ''}`);\n\n    // Set the prototype explicitly.\n    Object.setPrototypeOf(this, ServiceUnavailable503Exception.prototype);\n  }\n}\n", "export class NotImplementedException extends Error {\n  constructor(msg: string | undefined = undefined) {\n    super(`NotImplementedException${msg ? ': ' + msg : ''}`);\n\n    // Set the prototype explicitly.\n    Object.setPrototypeOf(this, NotImplementedException.prototype);\n  }\n}\n", "\n\n\n\nexport function tryParseStringToArray(input: string | undefined | null): Array<string> {\n  if (input == null) {\n    return []\n  }\n  \n  input = input.replace(/\\[/g, \"\")\n  input = input.replace(/\\]/g, \"\")\n  input = input.replace(/\\\"/g, \"\")\n  input = input.replace(/\\'/g, \"\")\n\n  // common delimiters\n  // TODO:  colon is tricky, let's avoid it for now\n  // a:1,b:2.   I might want colon to be a sub-delimiter\n  const parts = input.split(/[,;\\s\\t]/);\n  const result: Array<string> = []\n\n  for (let part of parts) {\n    if (part.trim().length > 0) {\n      const trimmedPart = part.trim()\n      if (trimmedPart.length > 0) {\n        result.push(trimmedPart)\n      }\n    }\n  }\n\n  return result\n}\n\n\nexport function hasExactlyOneItem(input: any[]): boolean {\n  if (Array.isArray(input) && input.length == 1) {\n    return true\n  }\n  return false;\n}\n\nexport function isPopulated(input: any[]): boolean {\n  if (Array.isArray(input) && input.length > 0) {\n    return true\n  }\n  return false;\n}\n\nexport function existsButIsEmpty(input: any[]): boolean {\n  if (Array.isArray(input) && input.length === 0) {\n    return true\n  }\n  return false;\n}\n\n// export function arrayify(input: any, options: {nullIsAnElement: boolean, undefinedIsAnElement: boolean, emptyStringIsAnElement?: boolean}): Array<any> {\n//   if (Array.isArray(input)) {\n//     // It's already an array\n//     return input\n//   }\n//   if (typeof input === 'undefined') {\n//     if (options?.undefinedIsAnElement === true) {\n//       return [undefined]\n//     }\n//     return []\n//   }\n//   if (input === null) {\n//     if (options?.nullIsAnElement === true) {\n//       return [null]\n//     }\n//     return []\n//   }\n//   return [input]\n// }", "import { ResultTuple } from \"../result/ResultTuple\";\n\nexport function tryCatchTuplify<T, E = Error>(fn: () => T): ResultTuple<T, E> {\n  try {\n    return [fn(), null];\n  } catch (error) {\n    return [null, error as E];\n  }\n}\n\nexport async function tryCatchTuplifyAsync<T, E = Error>(promise: Promise<T>): Promise<ResultTuple<T, E>> {\n  try {\n    return [await promise, null];\n  } catch (error) {\n    return [null, error as E];\n  }\n}\n", "// radixUtil is a lower level library than is uuidUtil\nconst BASE62_ALPHABET = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz';\nconst BASE64_ALPHABET = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz+/';\n\n// https://github.com/JamoCA/cfml-nanoid/blob/main/README.md\n// https://zelark.github.io/nano-id-cc/\nconst NANOID_ALPHABET = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz-'\nconst NOLOOKALIKES_ALPHABET = '346789ABCDEFGHJKLMNPQRTUVWXYabcdefghijkmnpqrtwxyz'\n\nexport function encodeNumberAsBase62(num: number): string {\n  if (num === 0) return '0';\n  if (num < 0) {\n    throw new Error(`Cannot encode negative numbers`);\n  }\n\n  let result = '';\n  while (num > 0) {\n    result = BASE62_ALPHABET[num % 62] + result;\n    num = Math.floor(num / 62);\n  }\n  return result;\n}\n\nconst BASE62_CHAR_MAP = Object.fromEntries(BASE62_ALPHABET.split('').map((char, i) => [char, i]));\n\nexport function decodeBase62ToNumber(str: string): number {\n  let result = 0;\n  for (let i = 0; i < str.length; i++) {\n    const char = str[i];\n    const value = BASE62_CHAR_MAP[char];\n    if (typeof value === 'undefined') {\n      throw new Error(`Invalid base62 character: ${char}`);\n    }\n    result = result * 62 + value;\n  }\n  return result;\n}\n\n/**\n * Converts a hex string (base16) to a base62 string.\n * Works in TypeScript without BigInt or external libraries.\n */\nexport function convertHexToBase62(hex: string): string {\n  if (!/^[0-9a-fA-F]+$/.test(hex)) {\n    throw new Error('Invalid hex input');\n  }\n\n  let decimal = '0';\n\n  for (let i = 0; i < hex.length; i++) {\n    const digit = parseInt(hex[i], 16);\n    decimal = multiplyDecimalStringByInt(decimal, 16);\n    decimal = addDecimalStrings(decimal, digit.toString());\n  }\n\n  if (decimal === '0') return '0';\n\n  let result = '';\n  while (decimal !== '0') {\n    const { quotient, remainder } = divideDecimalStringByInt(decimal, 62);\n    result = BASE62_ALPHABET[parseInt(remainder, 10)] + result;\n    decimal = quotient;\n  }\n\n  return result;\n}\n\n/**\n * Converts a hex string (base16) to a base62 string.\n * Works in TypeScript without BigInt or external libraries.\n */\nexport function convertHexToNanoIdAlphabet(hex: string): string {\n  if (!/^[0-9a-fA-F]+$/.test(hex)) {\n    throw new Error('Invalid hex input');\n  }\n\n  let decimal = '0';\n\n  for (let i = 0; i < hex.length; i++) {\n    const digit = parseInt(hex[i], 16);\n    decimal = multiplyDecimalStringByInt(decimal, 16);\n    decimal = addDecimalStrings(decimal, digit.toString());\n  }\n\n  if (decimal === '0') return '0';\n\n  let result = '';\n  while (decimal !== '0') {\n    const { quotient, remainder } = divideDecimalStringByInt(decimal, 64);\n    result = NANOID_ALPHABET[parseInt(remainder, 10)] + result;\n    decimal = quotient;\n  }\n\n  return result;\n}\n\nfunction multiplyDecimalStringByInt(decimal: string, multiplier: number): string {\n  let carry = 0;\n  let result = '';\n\n  for (let i = decimal.length - 1; i >= 0; i--) {\n    const product = parseInt(decimal[i], 10) * multiplier + carry;\n    result = (product % 10).toString() + result;\n    carry = Math.floor(product / 10);\n  }\n\n  if (carry > 0) {\n    result = carry.toString() + result;\n  }\n\n  return result;\n}\n\nfunction addDecimalStrings(a: string, b: string): string {\n  let result = '';\n  let carry = 0;\n  let i = a.length - 1;\n  let j = b.length - 1;\n\n  while (i >= 0 || j >= 0 || carry > 0) {\n    const digitA = i >= 0 ? parseInt(a[i--], 10) : 0;\n    const digitB = j >= 0 ? parseInt(b[j--], 10) : 0;\n    const sum = digitA + digitB + carry;\n    result = (sum % 10).toString() + result;\n    carry = Math.floor(sum / 10);\n  }\n\n  return result;\n}\n\nfunction divideDecimalStringByInt(decimal: string, divisor: number): { quotient: string; remainder: string } {\n  let quotient = '';\n  let remainder = 0;\n\n  for (let i = 0; i < decimal.length; i++) {\n    const digit = parseInt(decimal[i], 10);\n    const accumulator = remainder * 10 + digit;\n    const q = Math.floor(accumulator / divisor);\n    remainder = accumulator % divisor;\n    if (quotient !== '' || q > 0) {\n      quotient += q.toString();\n    }\n  }\n\n  return {\n    quotient: quotient || '0',\n    remainder: remainder.toString(),\n  };\n}", "import { v6 } from 'uuid';\nimport { v7 } from 'uuid';\n\nexport function generateV6(): string {\n  return v6()\n}\n\nexport function generateV7(): string {\n  return v7()\n}\n\n", "export default /^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-8][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/i;\n", "import REGEX from './regex.js';\nfunction validate(uuid) {\n    return typeof uuid === 'string' && REGEX.test(uuid);\n}\nexport default validate;\n", "import validate from './validate.js';\nfunction parse(uuid) {\n    if (!validate(uuid)) {\n        throw TypeError('Invalid UUID');\n    }\n    let v;\n    return Uint8Array.of((v = parseInt(uuid.slice(0, 8), 16)) >>> 24, (v >>> 16) & 0xff, (v >>> 8) & 0xff, v & 0xff, (v = parseInt(uuid.slice(9, 13), 16)) >>> 8, v & 0xff, (v = parseInt(uuid.slice(14, 18), 16)) >>> 8, v & 0xff, (v = parseInt(uuid.slice(19, 23), 16)) >>> 8, v & 0xff, ((v = parseInt(uuid.slice(24, 36), 16)) / 0x10000000000) & 0xff, (v / 0x100000000) & 0xff, (v >>> 24) & 0xff, (v >>> 16) & 0xff, (v >>> 8) & 0xff, v & 0xff);\n}\nexport default parse;\n", "import validate from './validate.js';\nconst byteToHex = [];\nfor (let i = 0; i < 256; ++i) {\n    byteToHex.push((i + 0x100).toString(16).slice(1));\n}\nexport function unsafeStringify(arr, offset = 0) {\n    return (byteToHex[arr[offset + 0]] +\n        byteToHex[arr[offset + 1]] +\n        byteToHex[arr[offset + 2]] +\n        byteToHex[arr[offset + 3]] +\n        '-' +\n        byteToHex[arr[offset + 4]] +\n        byteToHex[arr[offset + 5]] +\n        '-' +\n        byteToHex[arr[offset + 6]] +\n        byteToHex[arr[offset + 7]] +\n        '-' +\n        byteToHex[arr[offset + 8]] +\n        byteToHex[arr[offset + 9]] +\n        '-' +\n        byteToHex[arr[offset + 10]] +\n        byteToHex[arr[offset + 11]] +\n        byteToHex[arr[offset + 12]] +\n        byteToHex[arr[offset + 13]] +\n        byteToHex[arr[offset + 14]] +\n        byteToHex[arr[offset + 15]]).toLowerCase();\n}\nfunction stringify(arr, offset = 0) {\n    const uuid = unsafeStringify(arr, offset);\n    if (!validate(uuid)) {\n        throw TypeError('Stringified UUID is invalid');\n    }\n    return uuid;\n}\nexport default stringify;\n", "let getRandomValues;\nconst rnds8 = new Uint8Array(16);\nexport default function rng() {\n    if (!getRandomValues) {\n        if (typeof crypto === 'undefined' || !crypto.getRandomValues) {\n            throw new Error('crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported');\n        }\n        getRandomValues = crypto.getRandomValues.bind(crypto);\n    }\n    return getRandomValues(rnds8);\n}\n", "import rng from './rng.js';\nimport { unsafeStringify } from './stringify.js';\nconst _state = {};\nfunction v1(options, buf, offset) {\n    let bytes;\n    const isV6 = options?._v6 ?? false;\n    if (options) {\n        const optionsKeys = Object.keys(options);\n        if (optionsKeys.length === 1 && optionsKeys[0] === '_v6') {\n            options = undefined;\n        }\n    }\n    if (options) {\n        bytes = v1Bytes(options.random ?? options.rng?.() ?? rng(), options.msecs, options.nsecs, options.clockseq, options.node, buf, offset);\n    }\n    else {\n        const now = Date.now();\n        const rnds = rng();\n        updateV1State(_state, now, rnds);\n        bytes = v1Bytes(rnds, _state.msecs, _state.nsecs, isV6 ? undefined : _state.clockseq, isV6 ? undefined : _state.node, buf, offset);\n    }\n    return buf ?? unsafeStringify(bytes);\n}\nexport function updateV1State(state, now, rnds) {\n    state.msecs ??= -Infinity;\n    state.nsecs ??= 0;\n    if (now === state.msecs) {\n        state.nsecs++;\n        if (state.nsecs >= 10000) {\n            state.node = undefined;\n            state.nsecs = 0;\n        }\n    }\n    else if (now > state.msecs) {\n        state.nsecs = 0;\n    }\n    else if (now < state.msecs) {\n        state.node = undefined;\n    }\n    if (!state.node) {\n        state.node = rnds.slice(10, 16);\n        state.node[0] |= 0x01;\n        state.clockseq = ((rnds[8] << 8) | rnds[9]) & 0x3fff;\n    }\n    state.msecs = now;\n    return state;\n}\nfunction v1Bytes(rnds, msecs, nsecs, clockseq, node, buf, offset = 0) {\n    if (rnds.length < 16) {\n        throw new Error('Random bytes length must be >= 16');\n    }\n    if (!buf) {\n        buf = new Uint8Array(16);\n        offset = 0;\n    }\n    else {\n        if (offset < 0 || offset + 16 > buf.length) {\n            throw new RangeError(`UUID byte range ${offset}:${offset + 15} is out of buffer bounds`);\n        }\n    }\n    msecs ??= Date.now();\n    nsecs ??= 0;\n    clockseq ??= ((rnds[8] << 8) | rnds[9]) & 0x3fff;\n    node ??= rnds.slice(10, 16);\n    msecs += 12219292800000;\n    const tl = ((msecs & 0xfffffff) * 10000 + nsecs) % 0x100000000;\n    buf[offset++] = (tl >>> 24) & 0xff;\n    buf[offset++] = (tl >>> 16) & 0xff;\n    buf[offset++] = (tl >>> 8) & 0xff;\n    buf[offset++] = tl & 0xff;\n    const tmh = ((msecs / 0x100000000) * 10000) & 0xfffffff;\n    buf[offset++] = (tmh >>> 8) & 0xff;\n    buf[offset++] = tmh & 0xff;\n    buf[offset++] = ((tmh >>> 24) & 0xf) | 0x10;\n    buf[offset++] = (tmh >>> 16) & 0xff;\n    buf[offset++] = (clockseq >>> 8) | 0x80;\n    buf[offset++] = clockseq & 0xff;\n    for (let n = 0; n < 6; ++n) {\n        buf[offset++] = node[n];\n    }\n    return buf;\n}\nexport default v1;\n", "import parse from './parse.js';\nimport { unsafeStringify } from './stringify.js';\nexport default function v1ToV6(uuid) {\n    const v1Bytes = typeof uuid === 'string' ? parse(uuid) : uuid;\n    const v6Bytes = _v1ToV6(v1Bytes);\n    return typeof uuid === 'string' ? unsafeStringify(v6Bytes) : v6Bytes;\n}\nfunction _v1ToV6(v1Bytes) {\n    return Uint8Array.of(((v1Bytes[6] & 0x0f) << 4) | ((v1Bytes[7] >> 4) & 0x0f), ((v1Bytes[7] & 0x0f) << 4) | ((v1Bytes[4] & 0xf0) >> 4), ((v1Bytes[4] & 0x0f) << 4) | ((v1Bytes[5] & 0xf0) >> 4), ((v1Bytes[5] & 0x0f) << 4) | ((v1Bytes[0] & 0xf0) >> 4), ((v1Bytes[0] & 0x0f) << 4) | ((v1Bytes[1] & 0xf0) >> 4), ((v1Bytes[1] & 0x0f) << 4) | ((v1Bytes[2] & 0xf0) >> 4), 0x60 | (v1Bytes[2] & 0x0f), v1Bytes[3], v1Bytes[8], v1Bytes[9], v1Bytes[10], v1Bytes[11], v1Bytes[12], v1Bytes[13], v1Bytes[14], v1Bytes[15]);\n}\n", "const randomUUID = typeof crypto !== 'undefined' && crypto.randomUUID && crypto.randomUUID.bind(crypto);\nexport default { randomUUID };\n", "import native from './native.js';\nimport rng from './rng.js';\nimport { unsafeStringify } from './stringify.js';\nfunction v4(options, buf, offset) {\n    if (native.randomUUID && !buf && !options) {\n        return native.randomUUID();\n    }\n    options = options || {};\n    const rnds = options.random ?? options.rng?.() ?? rng();\n    if (rnds.length < 16) {\n        throw new Error('Random bytes length must be >= 16');\n    }\n    rnds[6] = (rnds[6] & 0x0f) | 0x40;\n    rnds[8] = (rnds[8] & 0x3f) | 0x80;\n    if (buf) {\n        offset = offset || 0;\n        if (offset < 0 || offset + 16 > buf.length) {\n            throw new RangeError(`UUID byte range ${offset}:${offset + 15} is out of buffer bounds`);\n        }\n        for (let i = 0; i < 16; ++i) {\n            buf[offset + i] = rnds[i];\n        }\n        return buf;\n    }\n    return unsafeStringify(rnds);\n}\nexport default v4;\n", "import { unsafeStringify } from './stringify.js';\nimport v1 from './v1.js';\nimport v1ToV6 from './v1ToV6.js';\nfunction v6(options, buf, offset) {\n    options ??= {};\n    offset ??= 0;\n    let bytes = v1({ ...options, _v6: true }, new Uint8Array(16));\n    bytes = v1ToV6(bytes);\n    if (buf) {\n        for (let i = 0; i < 16; i++) {\n            buf[offset + i] = bytes[i];\n        }\n        return buf;\n    }\n    return unsafeStringify(bytes);\n}\nexport default v6;\n", "import rng from './rng.js';\nimport { unsafeStringify } from './stringify.js';\nconst _state = {};\nfunction v7(options, buf, offset) {\n    let bytes;\n    if (options) {\n        bytes = v7Bytes(options.random ?? options.rng?.() ?? rng(), options.msecs, options.seq, buf, offset);\n    }\n    else {\n        const now = Date.now();\n        const rnds = rng();\n        updateV7State(_state, now, rnds);\n        bytes = v7Bytes(rnds, _state.msecs, _state.seq, buf, offset);\n    }\n    return buf ?? unsafeStringify(bytes);\n}\nexport function updateV7State(state, now, rnds) {\n    state.msecs ??= -Infinity;\n    state.seq ??= 0;\n    if (now > state.msecs) {\n        state.seq = (rnds[6] << 23) | (rnds[7] << 16) | (rnds[8] << 8) | rnds[9];\n        state.msecs = now;\n    }\n    else {\n        state.seq = (state.seq + 1) | 0;\n        if (state.seq === 0) {\n            state.msecs++;\n        }\n    }\n    return state;\n}\nfunction v7Bytes(rnds, msecs, seq, buf, offset = 0) {\n    if (rnds.length < 16) {\n        throw new Error('Random bytes length must be >= 16');\n    }\n    if (!buf) {\n        buf = new Uint8Array(16);\n        offset = 0;\n    }\n    else {\n        if (offset < 0 || offset + 16 > buf.length) {\n            throw new RangeError(`UUID byte range ${offset}:${offset + 15} is out of buffer bounds`);\n        }\n    }\n    msecs ??= Date.now();\n    seq ??= ((rnds[6] * 0x7f) << 24) | (rnds[7] << 16) | (rnds[8] << 8) | rnds[9];\n    buf[offset++] = (msecs / 0x10000000000) & 0xff;\n    buf[offset++] = (msecs / 0x100000000) & 0xff;\n    buf[offset++] = (msecs / 0x1000000) & 0xff;\n    buf[offset++] = (msecs / 0x10000) & 0xff;\n    buf[offset++] = (msecs / 0x100) & 0xff;\n    buf[offset++] = msecs & 0xff;\n    buf[offset++] = 0x70 | ((seq >>> 28) & 0x0f);\n    buf[offset++] = (seq >>> 20) & 0xff;\n    buf[offset++] = 0x80 | ((seq >>> 14) & 0x3f);\n    buf[offset++] = (seq >>> 6) & 0xff;\n    buf[offset++] = ((seq << 2) & 0xff) | (rnds[10] & 0x03);\n    buf[offset++] = rnds[11];\n    buf[offset++] = rnds[12];\n    buf[offset++] = rnds[13];\n    buf[offset++] = rnds[14];\n    buf[offset++] = rnds[15];\n    return buf;\n}\nexport default v7;\n", "import { v7 } from 'uuid';\nimport * as radixUtil from '../radix/radixUtil';\n\nexport function generateTimeOrderedBase62Id(): string {\n  return radixUtil.convertHexToBase62(v7().toLowerCase().replace(/-/g, ''))\n}\n\nexport function generateTimeOrderedNanoLikeId(): string {\n  return radixUtil.convertHexToNanoIdAlphabet(v7().toLowerCase().replace(/-/g, ''))\n}", "/**\n * Normalizes an email address to a standard format.\n * Trims whitespace and converts to lowercase.\n *\n * @param email - Email address to normalize\n * @returns Normalized email address\n *\n * @example\n * normalizeEmail(\"  User@Example.COM  \") // returns \"user@example.com\"\n */\nexport function normalizeEmail(email: string): string {\n  return email.trim().toLowerCase();\n}\n", "/**\n * Normalizes a phone number to E.164 format: +[country code][subscriber number]\n *\n * Examples:\n *   \"(415) 555-2671\"     \u2192 \"+14155552671\"\n *   \"415-555-2671\"       \u2192 \"+14155552671\"\n *   \"4155552671\"         \u2192 \"+14155552671\" (assumes US)\n *   \"+1-415-555-2671\"    \u2192 \"+14155552671\"\n *   \"+44 20 7183 8750\"   \u2192 \"+442071838750\"\n *\n * @param phone - Phone number in various formats\n * @returns E.164 formatted phone number (+ followed by digits only)\n * @throws Error if phone number is invalid or cannot be normalized\n */\nexport function normalizePhone(phone: string): string {\n  if (!phone || phone.trim().length === 0) {\n    throw new Error('Phone number cannot be empty');\n  }\n\n  // Remove all whitespace, dashes, parentheses, dots\n  let normalized = phone.replace(/[\\s\\-\\(\\)\\.\\[\\]]/g, '');\n\n  // If it starts with +, keep it. Otherwise extract only digits\n  let hasPlus = normalized.startsWith('+');\n  let digits = normalized.replace(/\\D/g, ''); // Extract only digits\n\n  // If already has +, return + plus the digits\n  if (hasPlus) {\n    normalized = '+' + digits;\n  } else {\n    // No country code provided - assume US (+1) for 10 or 11 digit numbers\n    if (digits.length === 10) {\n      // 10 digits \u2192 US number without country code\n      normalized = '+1' + digits;\n    } else if (digits.length === 11 && digits.startsWith('1')) {\n      // 11 digits starting with 1 \u2192 US number with country code\n      normalized = '+' + digits;\n    } else if (digits.length >= 7 && digits.length <= 15) {\n      // Other valid lengths - require explicit + country code\n      throw new Error(`Phone number must include country code (use +): ${phone}`);\n    } else {\n      throw new Error(`Invalid phone number length: ${phone}`);\n    }\n  }\n\n  // Validate E.164 format: + followed by 7-15 digits\n  if (!/^\\+[1-9]\\d{6,14}$/.test(normalized)) {\n    throw new Error(`Invalid E.164 format: ${normalized} (from: ${phone})`);\n  }\n\n  return normalized;\n}\n", "export function rollOneDie(numSides: number): number { // min and max included \n  return Math.floor(Math.random() * (numSides) + 1)\n}\n\nexport function xTimesRollDie(numRolls: number, numSides: number): number { // min and max included \n  let total: number = 0;\n  for( let ii = 0; ii < numRolls; ii++) {\n    total = total + rollOneDie(numSides)\n  }\n  return total\n}\n\nexport function beTrueXPercentOfTheTime(percent: number): boolean { // min and max included \n  const roll = rollOneDie(100)\n  return (roll <= percent) ? true : false\n}", "/**\n * Short code generation utilities for URL shorteners and similar use cases.\n *\n * Two alphabets are provided:\n *\n * - 58 chars (ALPHABET_58): Self-healing. Generates 0 and 1 but never O/o/l/I.\n *   If user mistypes O or o, normalizeShortCode58() corrects to 0.\n *   If user mistypes l or I, normalizeShortCode58() corrects to 1.\n *\n * - 56 chars (ALPHABET_56): Excludes ALL six confusable characters (0, 1, O, o, l, I).\n *   No normalization needed - every character is visually unambiguous.\n *\n * At 8 characters:\n * - 58^8 = 128 trillion combinations\n * - 56^8 = 96 trillion combinations\n */\n\n/**\n * 58-character alphabet for short code generation.\n * Only generates 0 and 1 (never O, o, l, I).\n * Self-healing: if user mistypes O/o, normalize to 0. If user mistypes l/I, normalize to 1.\n * Use normalizeShortCode58() on user input before lookup.\n */\nexport const ALPHABET_58 = '0123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnpqrstuvwxyz';\n\n/**\n * 56-character alphabet for short code generation.\n * Excludes 0, 1, O, o, l, I (all six confusable characters).\n * No normalization needed - every character is visually distinct.\n */\nexport const ALPHABET_56 = '23456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnpqrstuvwxyz';\n\n/**\n * Generate a random short code using the 58-character alphabet.\n * 58^8 = 128 trillion combinations at 8 characters.\n *\n * When looking up codes, use normalizeShortCode58() to handle user typos\n * (e.g., user types 'O' instead of '0').\n *\n * @param length - Number of characters (default: 8)\n * @returns Random short code string\n */\nexport function generateShortCode58(length: number = 8): string {\n  let code = '';\n  for (let i = 0; i < length; i++) {\n    const randomIndex = Math.floor(Math.random() * ALPHABET_58.length);\n    code += ALPHABET_58[randomIndex];\n  }\n  return code;\n}\n\n/**\n * Generate a random short code using the 56-character alphabet.\n * 56^8 = 96 trillion combinations at 8 characters.\n *\n * This alphabet excludes all confusable characters (0, 1, O, o, l, I),\n * so no normalization is needed on lookup.\n *\n * @param length - Number of characters (default: 8)\n * @returns Random short code string\n */\nexport function generateShortCode56(length: number = 8): string {\n  let code = '';\n  for (let i = 0; i < length; i++) {\n    const randomIndex = Math.floor(Math.random() * ALPHABET_56.length);\n    code += ALPHABET_56[randomIndex];\n  }\n  return code;\n}\n\n/**\n * Normalize a short code by auto-correcting confusable characters.\n * Use this when looking up codes generated with ALPHABET_58.\n *\n * Transformations:\n * - O, o \u2192 0 (letter O to digit zero)\n * - l, I \u2192 1 (lowercase L and uppercase I to digit one)\n *\n * This allows users to type 'jeanOcaI' and have it resolve to 'jean0ca1'.\n *\n * @param shortCode - The user-entered short code\n * @returns Normalized short code with confusables replaced\n */\nexport function normalizeShortCode58(shortCode: string): string {\n  return shortCode\n    .replace(/[Oo]/g, '0')  // O and o \u2192 0 (zero)\n    .replace(/[lI]/g, '1'); // l and I \u2192 1 (one)\n}\n\n/**\n * Calculate the number of possible combinations for a given alphabet and length.\n *\n * @param alphabetSize - Number of characters in the alphabet (e.g., 58 or 56)\n * @param length - Length of the short code\n * @returns Number of possible combinations\n */\nexport function calculateCombinations(alphabetSize: number, length: number): number {\n  return Math.pow(alphabetSize, length);\n}\n", "import { getLogger } from '../log/getLogger';\nimport { d4l } from '../log/logUtil';\n\nconst LOG = getLogger('request.requestUtil');\n\n/**\n * Minimal interface for HTTP request objects that support header retrieval.\n * Compatible with Express Request, Node.js IncomingMessage, etc.\n */\nexport interface HttpRequestLike {\n  get?(headerName: string): string | undefined;\n  headers?: Record<string, string | string[] | undefined>;\n  socket?: { remoteAddress?: string | null };\n}\n\n/**\n * Extracts the client IP address from an HTTP request, handling various proxy headers.\n *\n * Priority order:\n * 1. X-Forwarded-For header (first IP in the chain)\n * 2. X-Real-IP header\n * 3. Socket remote address\n *\n * @param req HTTP request object (Express Request, IncomingMessage, etc.)\n * @returns The client IP address or null if not available\n */\nexport function extractIpAddress(req: HttpRequestLike): string | null {\n  const getHeader = (name: string): string | undefined => {\n    if (req.get) {\n      return req.get(name);\n    }\n    if (req.headers) {\n      const value = req.headers[name.toLowerCase()];\n      return Array.isArray(value) ? value[0] : value;\n    }\n    return undefined;\n  };\n\n  const forwarded = getHeader('X-Forwarded-For');\n  const realIp = getHeader('X-Real-IP');\n  const socketAddr = req.socket?.remoteAddress || null;\n\n  LOG.debug(() => `extractIpAddress(): X-Forwarded-For = ${d4l(forwarded)},  X-Real-IP = ${d4l(realIp)},  socket = ${d4l(socketAddr)}`);\n\n  if (forwarded) {\n    const firstIp = forwarded.split(',')[0];\n    return firstIp ? firstIp.trim() : null;\n  }\n\n  if (realIp) {\n    return realIp;\n  }\n\n  return socketAddr;\n}\n", "/*\n * DO NOT use the logger herein!!  \n * Circular references!\n */\n\nexport function sendPlusOneCountToStathat(countStatName: string): void {\n  if (process.env.STATHAT_EZ_KEY != null && process.env.STATHAT_EZ_KEY.trim()?.length > 0) {\n\n    const controller = new AbortController()\n    // 1 second timeout:\n    const timeoutId = setTimeout(() => controller.abort(), 750)\n\n    const url = \"https://api.stathat.com/ez\"\n    // This param should either be 'ezkey' or 'email'... I'm not sure which\n    const ezKeyLabel = \"ezkey\" // vs email\n    const requestBody = `stat=${countStatName.trim()}&${ezKeyLabel}=${process.env.STATHAT_EZ_KEY?.trim()}&count=1`\n\n    /*\n     * % curl -v -d \"stat=sisu _ERROR&email=ezkey&count=1\" https://api.stathat.com/ez\n     */\n\n    // console.log(`Sending POST to Stathat url = '${url}',  requestBody = '${requestBody}'`)\n\n    // setTimeout is used to ensure that the fetch call is non-blocking and done out-of-band\n    setTimeout(() => {\n      const beforeAt = new Date()\n      // While still experimental, the global fetch API is available by default in Node.js 18\n      fetch(url, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/x-www-form-urlencoded'\n        },\n        signal: controller.signal,\n        body: requestBody\n      }).then(response => {\n        // completed request before timeout fired\n        const deltaInMs = new Date().getTime() - beforeAt.getTime()\n        // console.log(`Stathat fetch completed after ${deltaInMs} milliseconds,  with response = ${d4l(response)}`)\n\n        // If you only wanted to timeout the request, not the response, add:\n        clearTimeout(timeoutId)\n      }).catch(err => {\n        // console.log(`[STATHAT][ ERROR] Reason: ${d4l(err)}`)\n      })\n    }, 0)\n  }\n}\n\n\nexport function sendStatToKpitracks(requestBodyString: string): void {\n  let kpitracksEzKey = process.env.KPITRACKS_EZ_KEY\n  kpitracksEzKey = kpitracksEzKey?.trim()\n\n  if (kpitracksEzKey != null && kpitracksEzKey?.length > 0) {\n    const controller = new AbortController()\n    const timeoutId = setTimeout(() => controller.abort(), 750)\n    const url = \"https://stat.kpitracks.com/c\"\n    requestBodyString = requestBodyString + `&ezkey=${process.env.KPITRACKS_EZ_KEY?.trim()}`\n\n    console.log(`sendStatToKpitracks(): Sending POST to Stathat url = '${url}',  requestBodyString = '${requestBodyString}'`)\n\n    const beforeAt = new Date()\n    // While still experimental, the global fetch API is available by default in Node.js 18\n    fetch(url, { \n      method: 'POST', \n      signal: controller.signal,\n      body: requestBodyString\n    }).then(response => {\n      // completed request before timeout fired\n      const deltaInMs = new Date().getTime() - beforeAt.getTime()\n      // console.log(`Stathat fetch completed after ${deltaInMs} milliseconds,  with response = ${d4l(response)}`)\n\n      // If you only wanted to timeout the request, not the response, add:\n      clearTimeout(timeoutId)\n    }).catch(err => {\n      console.log(`sendStatToKpitracks(): Failed to send stat.  requestBodyString = ${requestBodyString},  Reason: ${JSON.stringify(err)}`);\n    })\n  }\n}", "/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// Updates to this file should also be replicated to @opentelemetry/core too.\n\n/**\n * - globalThis (New standard)\n * - self (Will return the current window instance for supported browsers)\n * - window (fallback for older browser implementations)\n * - global (NodeJS implementation)\n * - <object> (When all else fails)\n */\n\n/** only globals that common to node and browsers are allowed */\n// eslint-disable-next-line node/no-unsupported-features/es-builtins, no-undef\nexport const _globalThis: typeof globalThis =\n  typeof globalThis === 'object'\n    ? globalThis\n    : typeof self === 'object'\n    ? self\n    : typeof window === 'object'\n    ? window\n    : typeof global === 'object'\n    ? global\n    : ({} as typeof globalThis);\n", "/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// this is autogenerated file, see scripts/version-update.js\nexport const VERSION = '1.9.0';\n", "/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { VERSION } from '../version';\n\nconst re = /^(\\d+)\\.(\\d+)\\.(\\d+)(-(.+))?$/;\n\n/**\n * Create a function to test an API version to see if it is compatible with the provided ownVersion.\n *\n * The returned function has the following semantics:\n * - Exact match is always compatible\n * - Major versions must match exactly\n *    - 1.x package cannot use global 2.x package\n *    - 2.x package cannot use global 1.x package\n * - The minor version of the API module requesting access to the global API must be less than or equal to the minor version of this API\n *    - 1.3 package may use 1.4 global because the later global contains all functions 1.3 expects\n *    - 1.4 package may NOT use 1.3 global because it may try to call functions which don't exist on 1.3\n * - If the major version is 0, the minor version is treated as the major and the patch is treated as the minor\n * - Patch and build tag differences are not considered at this time\n *\n * @param ownVersion version which should be checked against\n */\nexport function _makeCompatibilityCheck(\n  ownVersion: string\n): (globalVersion: string) => boolean {\n  const acceptedVersions = new Set<string>([ownVersion]);\n  const rejectedVersions = new Set<string>();\n\n  const myVersionMatch = ownVersion.match(re);\n  if (!myVersionMatch) {\n    // we cannot guarantee compatibility so we always return noop\n    return () => false;\n  }\n\n  const ownVersionParsed = {\n    major: +myVersionMatch[1],\n    minor: +myVersionMatch[2],\n    patch: +myVersionMatch[3],\n    prerelease: myVersionMatch[4],\n  };\n\n  // if ownVersion has a prerelease tag, versions must match exactly\n  if (ownVersionParsed.prerelease != null) {\n    return function isExactmatch(globalVersion: string): boolean {\n      return globalVersion === ownVersion;\n    };\n  }\n\n  function _reject(v: string) {\n    rejectedVersions.add(v);\n    return false;\n  }\n\n  function _accept(v: string) {\n    acceptedVersions.add(v);\n    return true;\n  }\n\n  return function isCompatible(globalVersion: string): boolean {\n    if (acceptedVersions.has(globalVersion)) {\n      return true;\n    }\n\n    if (rejectedVersions.has(globalVersion)) {\n      return false;\n    }\n\n    const globalVersionMatch = globalVersion.match(re);\n    if (!globalVersionMatch) {\n      // cannot parse other version\n      // we cannot guarantee compatibility so we always noop\n      return _reject(globalVersion);\n    }\n\n    const globalVersionParsed = {\n      major: +globalVersionMatch[1],\n      minor: +globalVersionMatch[2],\n      patch: +globalVersionMatch[3],\n      prerelease: globalVersionMatch[4],\n    };\n\n    // if globalVersion has a prerelease tag, versions must match exactly\n    if (globalVersionParsed.prerelease != null) {\n      return _reject(globalVersion);\n    }\n\n    // major versions must match\n    if (ownVersionParsed.major !== globalVersionParsed.major) {\n      return _reject(globalVersion);\n    }\n\n    if (ownVersionParsed.major === 0) {\n      if (\n        ownVersionParsed.minor === globalVersionParsed.minor &&\n        ownVersionParsed.patch <= globalVersionParsed.patch\n      ) {\n        return _accept(globalVersion);\n      }\n\n      return _reject(globalVersion);\n    }\n\n    if (ownVersionParsed.minor <= globalVersionParsed.minor) {\n      return _accept(globalVersion);\n    }\n\n    return _reject(globalVersion);\n  };\n}\n\n/**\n * Test an API version to see if it is compatible with this API.\n *\n * - Exact match is always compatible\n * - Major versions must match exactly\n *    - 1.x package cannot use global 2.x package\n *    - 2.x package cannot use global 1.x package\n * - The minor version of the API module requesting access to the global API must be less than or equal to the minor version of this API\n *    - 1.3 package may use 1.4 global because the later global contains all functions 1.3 expects\n *    - 1.4 package may NOT use 1.3 global because it may try to call functions which don't exist on 1.3\n * - If the major version is 0, the minor version is treated as the major and the patch is treated as the minor\n * - Patch and build tag differences are not considered at this time\n *\n * @param version version of the API requesting an instance of the global API\n */\nexport const isCompatible = _makeCompatibilityCheck(VERSION);\n", "/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { MeterProvider } from '../metrics/MeterProvider';\nimport { ContextManager } from '../context/types';\nimport { DiagLogger } from '../diag/types';\nimport { _globalThis } from '../platform';\nimport { TextMapPropagator } from '../propagation/TextMapPropagator';\nimport type { TracerProvider } from '../trace/tracer_provider';\nimport { VERSION } from '../version';\nimport { isCompatible } from './semver';\n\nconst major = VERSION.split('.')[0];\nconst GLOBAL_OPENTELEMETRY_API_KEY = Symbol.for(\n  `opentelemetry.js.api.${major}`\n);\n\nconst _global = _globalThis as OTelGlobal;\n\nexport function registerGlobal<Type extends keyof OTelGlobalAPI>(\n  type: Type,\n  instance: OTelGlobalAPI[Type],\n  diag: DiagLogger,\n  allowOverride = false\n): boolean {\n  const api = (_global[GLOBAL_OPENTELEMETRY_API_KEY] = _global[\n    GLOBAL_OPENTELEMETRY_API_KEY\n  ] ?? {\n    version: VERSION,\n  });\n\n  if (!allowOverride && api[type]) {\n    // already registered an API of this type\n    const err = new Error(\n      `@opentelemetry/api: Attempted duplicate registration of API: ${type}`\n    );\n    diag.error(err.stack || err.message);\n    return false;\n  }\n\n  if (api.version !== VERSION) {\n    // All registered APIs must be of the same version exactly\n    const err = new Error(\n      `@opentelemetry/api: Registration of version v${api.version} for ${type} does not match previously registered API v${VERSION}`\n    );\n    diag.error(err.stack || err.message);\n    return false;\n  }\n\n  api[type] = instance;\n  diag.debug(\n    `@opentelemetry/api: Registered a global for ${type} v${VERSION}.`\n  );\n\n  return true;\n}\n\nexport function getGlobal<Type extends keyof OTelGlobalAPI>(\n  type: Type\n): OTelGlobalAPI[Type] | undefined {\n  const globalVersion = _global[GLOBAL_OPENTELEMETRY_API_KEY]?.version;\n  if (!globalVersion || !isCompatible(globalVersion)) {\n    return;\n  }\n  return _global[GLOBAL_OPENTELEMETRY_API_KEY]?.[type];\n}\n\nexport function unregisterGlobal(type: keyof OTelGlobalAPI, diag: DiagLogger) {\n  diag.debug(\n    `@opentelemetry/api: Unregistering a global for ${type} v${VERSION}.`\n  );\n  const api = _global[GLOBAL_OPENTELEMETRY_API_KEY];\n\n  if (api) {\n    delete api[type];\n  }\n}\n\ntype OTelGlobal = {\n  [GLOBAL_OPENTELEMETRY_API_KEY]?: OTelGlobalAPI;\n};\n\ntype OTelGlobalAPI = {\n  version: string;\n\n  diag?: DiagLogger;\n  trace?: TracerProvider;\n  context?: ContextManager;\n  metrics?: MeterProvider;\n  propagation?: TextMapPropagator;\n};\n", "/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { getGlobal } from '../internal/global-utils';\nimport { ComponentLoggerOptions, DiagLogger, DiagLogFunction } from './types';\n\n/**\n * Component Logger which is meant to be used as part of any component which\n * will add automatically additional namespace in front of the log message.\n * It will then forward all message to global diag logger\n * @example\n * const cLogger = diag.createComponentLogger({ namespace: '@opentelemetry/instrumentation-http' });\n * cLogger.debug('test');\n * // @opentelemetry/instrumentation-http test\n */\nexport class DiagComponentLogger implements DiagLogger {\n  private _namespace: string;\n\n  constructor(props: ComponentLoggerOptions) {\n    this._namespace = props.namespace || 'DiagComponentLogger';\n  }\n\n  public debug(...args: any[]): void {\n    return logProxy('debug', this._namespace, args);\n  }\n\n  public error(...args: any[]): void {\n    return logProxy('error', this._namespace, args);\n  }\n\n  public info(...args: any[]): void {\n    return logProxy('info', this._namespace, args);\n  }\n\n  public warn(...args: any[]): void {\n    return logProxy('warn', this._namespace, args);\n  }\n\n  public verbose(...args: any[]): void {\n    return logProxy('verbose', this._namespace, args);\n  }\n}\n\nfunction logProxy(\n  funcName: keyof DiagLogger,\n  namespace: string,\n  args: any\n): void {\n  const logger = getGlobal('diag');\n  // shortcut if logger not set\n  if (!logger) {\n    return;\n  }\n\n  args.unshift(namespace);\n  return logger[funcName](...(args as Parameters<DiagLogFunction>));\n}\n", "/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport type DiagLogFunction = (message: string, ...args: unknown[]) => void;\n\n/**\n * Defines an internal diagnostic logger interface which is used to log internal diagnostic\n * messages, you can set the default diagnostic logger via the {@link DiagAPI} setLogger function.\n * API provided implementations include :-\n * - a No-Op {@link createNoopDiagLogger}\n * - a {@link DiagLogLevel} filtering wrapper {@link createLogLevelDiagLogger}\n * - a general Console {@link DiagConsoleLogger} version.\n */\nexport interface DiagLogger {\n  /** Log an error scenario that was not expected and caused the requested operation to fail. */\n  error: DiagLogFunction;\n\n  /**\n   * Log a warning scenario to inform the developer of an issues that should be investigated.\n   * The requested operation may or may not have succeeded or completed.\n   */\n  warn: DiagLogFunction;\n\n  /**\n   * Log a general informational message, this should not affect functionality.\n   * This is also the default logging level so this should NOT be used for logging\n   * debugging level information.\n   */\n  info: DiagLogFunction;\n\n  /**\n   * Log a general debug message that can be useful for identifying a failure.\n   * Information logged at this level may include diagnostic details that would\n   * help identify a failure scenario.\n   * For example: Logging the order of execution of async operations.\n   */\n  debug: DiagLogFunction;\n\n  /**\n   * Log a detailed (verbose) trace level logging that can be used to identify failures\n   * where debug level logging would be insufficient, this level of tracing can include\n   * input and output parameters and as such may include PII information passing through\n   * the API. As such it is recommended that this level of tracing should not be enabled\n   * in a production environment.\n   */\n  verbose: DiagLogFunction;\n}\n\n/**\n * Defines the available internal logging levels for the diagnostic logger, the numeric values\n * of the levels are defined to match the original values from the initial LogLevel to avoid\n * compatibility/migration issues for any implementation that assume the numeric ordering.\n */\nexport enum DiagLogLevel {\n  /** Diagnostic Logging level setting to disable all logging (except and forced logs) */\n  NONE = 0,\n\n  /** Identifies an error scenario */\n  ERROR = 30,\n\n  /** Identifies a warning scenario */\n  WARN = 50,\n\n  /** General informational log message */\n  INFO = 60,\n\n  /** General debug log message */\n  DEBUG = 70,\n\n  /**\n   * Detailed trace level logging should only be used for development, should only be set\n   * in a development environment.\n   */\n  VERBOSE = 80,\n\n  /** Used to set the logging level to include all logging */\n  ALL = 9999,\n}\n\n/**\n * Defines options for ComponentLogger\n */\nexport interface ComponentLoggerOptions {\n  namespace: string;\n}\n\nexport interface DiagLoggerOptions {\n  /**\n   * The {@link DiagLogLevel} used to filter logs sent to the logger.\n   *\n   * @defaultValue DiagLogLevel.INFO\n   */\n  logLevel?: DiagLogLevel;\n\n  /**\n   * Setting this value to `true` will suppress the warning message normally emitted when registering a logger when another logger is already registered.\n   */\n  suppressOverrideMessage?: boolean;\n}\n\nexport interface DiagLoggerApi {\n  /**\n   * Set the global DiagLogger and DiagLogLevel.\n   * If a global diag logger is already set, this will override it.\n   *\n   * @param logger - The {@link DiagLogger} instance to set as the default logger.\n   * @param options - A {@link DiagLoggerOptions} object. If not provided, default values will be set.\n   * @returns `true` if the logger was successfully registered, else `false`\n   */\n  setLogger(logger: DiagLogger, options?: DiagLoggerOptions): boolean;\n\n  /**\n   *\n   * @param logger - The {@link DiagLogger} instance to set as the default logger.\n   * @param logLevel - The {@link DiagLogLevel} used to filter logs sent to the logger. If not provided it will default to {@link DiagLogLevel.INFO}.\n   * @returns `true` if the logger was successfully registered, else `false`\n   */\n  setLogger(logger: DiagLogger, logLevel?: DiagLogLevel): boolean;\n}\n", "/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { DiagLogFunction, DiagLogger, DiagLogLevel } from '../types';\n\nexport function createLogLevelDiagLogger(\n  maxLevel: DiagLogLevel,\n  logger: DiagLogger\n): DiagLogger {\n  if (maxLevel < DiagLogLevel.NONE) {\n    maxLevel = DiagLogLevel.NONE;\n  } else if (maxLevel > DiagLogLevel.ALL) {\n    maxLevel = DiagLogLevel.ALL;\n  }\n\n  // In case the logger is null or undefined\n  logger = logger || {};\n\n  function _filterFunc(\n    funcName: keyof DiagLogger,\n    theLevel: DiagLogLevel\n  ): DiagLogFunction {\n    const theFunc = logger[funcName];\n\n    if (typeof theFunc === 'function' && maxLevel >= theLevel) {\n      return theFunc.bind(logger);\n    }\n    return function () {};\n  }\n\n  return {\n    error: _filterFunc('error', DiagLogLevel.ERROR),\n    warn: _filterFunc('warn', DiagLogLevel.WARN),\n    info: _filterFunc('info', DiagLogLevel.INFO),\n    debug: _filterFunc('debug', DiagLogLevel.DEBUG),\n    verbose: _filterFunc('verbose', DiagLogLevel.VERBOSE),\n  };\n}\n", "/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { DiagComponentLogger } from '../diag/ComponentLogger';\nimport { createLogLevelDiagLogger } from '../diag/internal/logLevelLogger';\nimport {\n  ComponentLoggerOptions,\n  DiagLogFunction,\n  DiagLogger,\n  DiagLoggerApi,\n  DiagLogLevel,\n} from '../diag/types';\nimport {\n  getGlobal,\n  registerGlobal,\n  unregisterGlobal,\n} from '../internal/global-utils';\n\nconst API_NAME = 'diag';\n\n/**\n * Singleton object which represents the entry point to the OpenTelemetry internal\n * diagnostic API\n */\nexport class DiagAPI implements DiagLogger, DiagLoggerApi {\n  private static _instance?: DiagAPI;\n\n  /** Get the singleton instance of the DiagAPI API */\n  public static instance(): DiagAPI {\n    if (!this._instance) {\n      this._instance = new DiagAPI();\n    }\n\n    return this._instance;\n  }\n\n  /**\n   * Private internal constructor\n   * @private\n   */\n  private constructor() {\n    function _logProxy(funcName: keyof DiagLogger): DiagLogFunction {\n      return function (...args) {\n        const logger = getGlobal('diag');\n        // shortcut if logger not set\n        if (!logger) return;\n        return logger[funcName](...args);\n      };\n    }\n\n    // Using self local variable for minification purposes as 'this' cannot be minified\n    const self = this;\n\n    // DiagAPI specific functions\n\n    const setLogger: DiagLoggerApi['setLogger'] = (\n      logger,\n      optionsOrLogLevel = { logLevel: DiagLogLevel.INFO }\n    ) => {\n      if (logger === self) {\n        // There isn't much we can do here.\n        // Logging to the console might break the user application.\n        // Try to log to self. If a logger was previously registered it will receive the log.\n        const err = new Error(\n          'Cannot use diag as the logger for itself. Please use a DiagLogger implementation like ConsoleDiagLogger or a custom implementation'\n        );\n        self.error(err.stack ?? err.message);\n        return false;\n      }\n\n      if (typeof optionsOrLogLevel === 'number') {\n        optionsOrLogLevel = {\n          logLevel: optionsOrLogLevel,\n        };\n      }\n\n      const oldLogger = getGlobal('diag');\n      const newLogger = createLogLevelDiagLogger(\n        optionsOrLogLevel.logLevel ?? DiagLogLevel.INFO,\n        logger\n      );\n      // There already is an logger registered. We'll let it know before overwriting it.\n      if (oldLogger && !optionsOrLogLevel.suppressOverrideMessage) {\n        const stack = new Error().stack ?? '<failed to generate stacktrace>';\n        oldLogger.warn(`Current logger will be overwritten from ${stack}`);\n        newLogger.warn(\n          `Current logger will overwrite one already registered from ${stack}`\n        );\n      }\n\n      return registerGlobal('diag', newLogger, self, true);\n    };\n\n    self.setLogger = setLogger;\n\n    self.disable = () => {\n      unregisterGlobal(API_NAME, self);\n    };\n\n    self.createComponentLogger = (options: ComponentLoggerOptions) => {\n      return new DiagComponentLogger(options);\n    };\n\n    self.verbose = _logProxy('verbose');\n    self.debug = _logProxy('debug');\n    self.info = _logProxy('info');\n    self.warn = _logProxy('warn');\n    self.error = _logProxy('error');\n  }\n\n  public setLogger!: DiagLoggerApi['setLogger'];\n  /**\n   *\n   */\n  public createComponentLogger!: (\n    options: ComponentLoggerOptions\n  ) => DiagLogger;\n\n  // DiagLogger implementation\n  public verbose!: DiagLogFunction;\n  public debug!: DiagLogFunction;\n  public info!: DiagLogFunction;\n  public warn!: DiagLogFunction;\n  public error!: DiagLogFunction;\n\n  /**\n   * Unregister the global logger and return to Noop\n   */\n  public disable!: () => void;\n}\n", "/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Context } from './types';\n\n/** Get a key to uniquely identify a context value */\nexport function createContextKey(description: string) {\n  // The specification states that for the same input, multiple calls should\n  // return different keys. Due to the nature of the JS dependency management\n  // system, this creates problems where multiple versions of some package\n  // could hold different keys for the same property.\n  //\n  // Therefore, we use Symbol.for which returns the same key for the same input.\n  return Symbol.for(description);\n}\n\nclass BaseContext implements Context {\n  private _currentContext!: Map<symbol, unknown>;\n\n  /**\n   * Construct a new context which inherits values from an optional parent context.\n   *\n   * @param parentContext a context from which to inherit values\n   */\n  constructor(parentContext?: Map<symbol, unknown>) {\n    // for minification\n    const self = this;\n\n    self._currentContext = parentContext ? new Map(parentContext) : new Map();\n\n    self.getValue = (key: symbol) => self._currentContext.get(key);\n\n    self.setValue = (key: symbol, value: unknown): Context => {\n      const context = new BaseContext(self._currentContext);\n      context._currentContext.set(key, value);\n      return context;\n    };\n\n    self.deleteValue = (key: symbol): Context => {\n      const context = new BaseContext(self._currentContext);\n      context._currentContext.delete(key);\n      return context;\n    };\n  }\n\n  /**\n   * Get a value from the context.\n   *\n   * @param key key which identifies a context value\n   */\n  public getValue!: (key: symbol) => unknown;\n\n  /**\n   * Create a new context which inherits from this context and has\n   * the given key set to the given value.\n   *\n   * @param key context key for which to set the value\n   * @param value value to set for the given key\n   */\n  public setValue!: (key: symbol, value: unknown) => Context;\n\n  /**\n   * Return a new context which inherits from this context but does\n   * not contain a value for the given key.\n   *\n   * @param key context key for which to clear a value\n   */\n  public deleteValue!: (key: symbol) => Context;\n}\n\n/** The root context is used as the default parent context when there is no active context */\nexport const ROOT_CONTEXT: Context = new BaseContext();\n", "/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ROOT_CONTEXT } from './context';\nimport * as types from './types';\n\nexport class NoopContextManager implements types.ContextManager {\n  active(): types.Context {\n    return ROOT_CONTEXT;\n  }\n\n  with<A extends unknown[], F extends (...args: A) => ReturnType<F>>(\n    _context: types.Context,\n    fn: F,\n    thisArg?: ThisParameterType<F>,\n    ...args: A\n  ): ReturnType<F> {\n    return fn.call(thisArg, ...args);\n  }\n\n  bind<T>(_context: types.Context, target: T): T {\n    return target;\n  }\n\n  enable(): this {\n    return this;\n  }\n\n  disable(): this {\n    return this;\n  }\n}\n", "/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { NoopContextManager } from '../context/NoopContextManager';\nimport { Context, ContextManager } from '../context/types';\nimport {\n  getGlobal,\n  registerGlobal,\n  unregisterGlobal,\n} from '../internal/global-utils';\nimport { DiagAPI } from './diag';\n\nconst API_NAME = 'context';\nconst NOOP_CONTEXT_MANAGER = new NoopContextManager();\n\n/**\n * Singleton object which represents the entry point to the OpenTelemetry Context API\n */\nexport class ContextAPI {\n  private static _instance?: ContextAPI;\n\n  /** Empty private constructor prevents end users from constructing a new instance of the API */\n  private constructor() {}\n\n  /** Get the singleton instance of the Context API */\n  public static getInstance(): ContextAPI {\n    if (!this._instance) {\n      this._instance = new ContextAPI();\n    }\n\n    return this._instance;\n  }\n\n  /**\n   * Set the current context manager.\n   *\n   * @returns true if the context manager was successfully registered, else false\n   */\n  public setGlobalContextManager(contextManager: ContextManager): boolean {\n    return registerGlobal(API_NAME, contextManager, DiagAPI.instance());\n  }\n\n  /**\n   * Get the currently active context\n   */\n  public active(): Context {\n    return this._getContextManager().active();\n  }\n\n  /**\n   * Execute a function with an active context\n   *\n   * @param context context to be active during function execution\n   * @param fn function to execute in a context\n   * @param thisArg optional receiver to be used for calling fn\n   * @param args optional arguments forwarded to fn\n   */\n  public with<A extends unknown[], F extends (...args: A) => ReturnType<F>>(\n    context: Context,\n    fn: F,\n    thisArg?: ThisParameterType<F>,\n    ...args: A\n  ): ReturnType<F> {\n    return this._getContextManager().with(context, fn, thisArg, ...args);\n  }\n\n  /**\n   * Bind a context to a target function or event emitter\n   *\n   * @param context context to bind to the event emitter or function. Defaults to the currently active context\n   * @param target function or event emitter to bind\n   */\n  public bind<T>(context: Context, target: T): T {\n    return this._getContextManager().bind(context, target);\n  }\n\n  private _getContextManager(): ContextManager {\n    return getGlobal(API_NAME) || NOOP_CONTEXT_MANAGER;\n  }\n\n  /** Disable and remove the global context manager */\n  public disable() {\n    this._getContextManager().disable();\n    unregisterGlobal(API_NAME, DiagAPI.instance());\n  }\n}\n", "/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nexport enum TraceFlags {\n  /** Represents no flag set. */\n  NONE = 0x0,\n  /** Bit to represent whether trace is sampled in trace flags. */\n  SAMPLED = 0x1 << 0,\n}\n", "/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { SpanContext } from './span_context';\nimport { TraceFlags } from './trace_flags';\n\nexport const INVALID_SPANID = '0000000000000000';\nexport const INVALID_TRACEID = '00000000000000000000000000000000';\nexport const INVALID_SPAN_CONTEXT: SpanContext = {\n  traceId: INVALID_TRACEID,\n  spanId: INVALID_SPANID,\n  traceFlags: TraceFlags.NONE,\n};\n", "/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Exception } from '../common/Exception';\nimport { TimeInput } from '../common/Time';\nimport { SpanAttributes } from './attributes';\nimport { INVALID_SPAN_CONTEXT } from './invalid-span-constants';\nimport { Span } from './span';\nimport { SpanContext } from './span_context';\nimport { SpanStatus } from './status';\nimport { Link } from './link';\n\n/**\n * The NonRecordingSpan is the default {@link Span} that is used when no Span\n * implementation is available. All operations are no-op including context\n * propagation.\n */\nexport class NonRecordingSpan implements Span {\n  constructor(\n    private readonly _spanContext: SpanContext = INVALID_SPAN_CONTEXT\n  ) {}\n\n  // Returns a SpanContext.\n  spanContext(): SpanContext {\n    return this._spanContext;\n  }\n\n  // By default does nothing\n  setAttribute(_key: string, _value: unknown): this {\n    return this;\n  }\n\n  // By default does nothing\n  setAttributes(_attributes: SpanAttributes): this {\n    return this;\n  }\n\n  // By default does nothing\n  addEvent(_name: string, _attributes?: SpanAttributes): this {\n    return this;\n  }\n\n  addLink(_link: Link): this {\n    return this;\n  }\n\n  addLinks(_links: Link[]): this {\n    return this;\n  }\n\n  // By default does nothing\n  setStatus(_status: SpanStatus): this {\n    return this;\n  }\n\n  // By default does nothing\n  updateName(_name: string): this {\n    return this;\n  }\n\n  // By default does nothing\n  end(_endTime?: TimeInput): void {}\n\n  // isRecording always returns false for NonRecordingSpan.\n  isRecording(): boolean {\n    return false;\n  }\n\n  // By default does nothing\n  recordException(_exception: Exception, _time?: TimeInput): void {}\n}\n", "/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { createContextKey } from '../context/context';\nimport { Context } from '../context/types';\nimport { Span } from './span';\nimport { SpanContext } from './span_context';\nimport { NonRecordingSpan } from './NonRecordingSpan';\nimport { ContextAPI } from '../api/context';\n\n/**\n * span key\n */\nconst SPAN_KEY = createContextKey('OpenTelemetry Context Key SPAN');\n\n/**\n * Return the span if one exists\n *\n * @param context context to get span from\n */\nexport function getSpan(context: Context): Span | undefined {\n  return (context.getValue(SPAN_KEY) as Span) || undefined;\n}\n\n/**\n * Gets the span from the current context, if one exists.\n */\nexport function getActiveSpan(): Span | undefined {\n  return getSpan(ContextAPI.getInstance().active());\n}\n\n/**\n * Set the span on a context\n *\n * @param context context to use as parent\n * @param span span to set active\n */\nexport function setSpan(context: Context, span: Span): Context {\n  return context.setValue(SPAN_KEY, span);\n}\n\n/**\n * Remove current span stored in the context\n *\n * @param context context to delete span from\n */\nexport function deleteSpan(context: Context): Context {\n  return context.deleteValue(SPAN_KEY);\n}\n\n/**\n * Wrap span context in a NoopSpan and set as span in a new\n * context\n *\n * @param context context to set active span on\n * @param spanContext span context to be wrapped\n */\nexport function setSpanContext(\n  context: Context,\n  spanContext: SpanContext\n): Context {\n  return setSpan(context, new NonRecordingSpan(spanContext));\n}\n\n/**\n * Get the span context of the span if it exists.\n *\n * @param context context to get values from\n */\nexport function getSpanContext(context: Context): SpanContext | undefined {\n  return getSpan(context)?.spanContext();\n}\n", "/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { INVALID_SPANID, INVALID_TRACEID } from './invalid-span-constants';\nimport { NonRecordingSpan } from './NonRecordingSpan';\nimport { Span } from './span';\nimport { SpanContext } from './span_context';\n\nconst VALID_TRACEID_REGEX = /^([0-9a-f]{32})$/i;\nconst VALID_SPANID_REGEX = /^[0-9a-f]{16}$/i;\n\nexport function isValidTraceId(traceId: string): boolean {\n  return VALID_TRACEID_REGEX.test(traceId) && traceId !== INVALID_TRACEID;\n}\n\nexport function isValidSpanId(spanId: string): boolean {\n  return VALID_SPANID_REGEX.test(spanId) && spanId !== INVALID_SPANID;\n}\n\n/**\n * Returns true if this {@link SpanContext} is valid.\n * @return true if this {@link SpanContext} is valid.\n */\nexport function isSpanContextValid(spanContext: SpanContext): boolean {\n  return (\n    isValidTraceId(spanContext.traceId) && isValidSpanId(spanContext.spanId)\n  );\n}\n\n/**\n * Wrap the given {@link SpanContext} in a new non-recording {@link Span}\n *\n * @param spanContext span context to be wrapped\n * @returns a new non-recording {@link Span} with the provided context\n */\nexport function wrapSpanContext(spanContext: SpanContext): Span {\n  return new NonRecordingSpan(spanContext);\n}\n", "/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ContextAPI } from '../api/context';\nimport { Context } from '../context/types';\nimport { getSpanContext, setSpan } from '../trace/context-utils';\nimport { NonRecordingSpan } from './NonRecordingSpan';\nimport { Span } from './span';\nimport { isSpanContextValid } from './spancontext-utils';\nimport { SpanOptions } from './SpanOptions';\nimport { SpanContext } from './span_context';\nimport { Tracer } from './tracer';\n\nconst contextApi = ContextAPI.getInstance();\n\n/**\n * No-op implementations of {@link Tracer}.\n */\nexport class NoopTracer implements Tracer {\n  // startSpan starts a noop span.\n  startSpan(\n    name: string,\n    options?: SpanOptions,\n    context = contextApi.active()\n  ): Span {\n    const root = Boolean(options?.root);\n    if (root) {\n      return new NonRecordingSpan();\n    }\n\n    const parentFromContext = context && getSpanContext(context);\n\n    if (\n      isSpanContext(parentFromContext) &&\n      isSpanContextValid(parentFromContext)\n    ) {\n      return new NonRecordingSpan(parentFromContext);\n    } else {\n      return new NonRecordingSpan();\n    }\n  }\n\n  startActiveSpan<F extends (span: Span) => ReturnType<F>>(\n    name: string,\n    fn: F\n  ): ReturnType<F>;\n  startActiveSpan<F extends (span: Span) => ReturnType<F>>(\n    name: string,\n    opts: SpanOptions | undefined,\n    fn: F\n  ): ReturnType<F>;\n  startActiveSpan<F extends (span: Span) => ReturnType<F>>(\n    name: string,\n    opts: SpanOptions | undefined,\n    ctx: Context | undefined,\n    fn: F\n  ): ReturnType<F>;\n  startActiveSpan<F extends (span: Span) => ReturnType<F>>(\n    name: string,\n    arg2?: F | SpanOptions,\n    arg3?: F | Context,\n    arg4?: F\n  ): ReturnType<F> | undefined {\n    let opts: SpanOptions | undefined;\n    let ctx: Context | undefined;\n    let fn: F;\n\n    if (arguments.length < 2) {\n      return;\n    } else if (arguments.length === 2) {\n      fn = arg2 as F;\n    } else if (arguments.length === 3) {\n      opts = arg2 as SpanOptions | undefined;\n      fn = arg3 as F;\n    } else {\n      opts = arg2 as SpanOptions | undefined;\n      ctx = arg3 as Context | undefined;\n      fn = arg4 as F;\n    }\n\n    const parentContext = ctx ?? contextApi.active();\n    const span = this.startSpan(name, opts, parentContext);\n    const contextWithSpanSet = setSpan(parentContext, span);\n\n    return contextApi.with(contextWithSpanSet, fn, undefined, span);\n  }\n}\n\nfunction isSpanContext(spanContext: any): spanContext is SpanContext {\n  return (\n    typeof spanContext === 'object' &&\n    typeof spanContext['spanId'] === 'string' &&\n    typeof spanContext['traceId'] === 'string' &&\n    typeof spanContext['traceFlags'] === 'number'\n  );\n}\n", "/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Context } from '../context/types';\nimport { NoopTracer } from './NoopTracer';\nimport { Span } from './span';\nimport { SpanOptions } from './SpanOptions';\nimport { Tracer } from './tracer';\nimport { TracerOptions } from './tracer_options';\n\nconst NOOP_TRACER = new NoopTracer();\n\n/**\n * Proxy tracer provided by the proxy tracer provider\n */\nexport class ProxyTracer implements Tracer {\n  // When a real implementation is provided, this will be it\n  private _delegate?: Tracer;\n\n  constructor(\n    private _provider: TracerDelegator,\n    public readonly name: string,\n    public readonly version?: string,\n    public readonly options?: TracerOptions\n  ) {}\n\n  startSpan(name: string, options?: SpanOptions, context?: Context): Span {\n    return this._getTracer().startSpan(name, options, context);\n  }\n\n  startActiveSpan<F extends (span: Span) => unknown>(\n    _name: string,\n    _options: F | SpanOptions,\n    _context?: F | Context,\n    _fn?: F\n  ): ReturnType<F> {\n    const tracer = this._getTracer();\n    return Reflect.apply(tracer.startActiveSpan, tracer, arguments);\n  }\n\n  /**\n   * Try to get a tracer from the proxy tracer provider.\n   * If the proxy tracer provider has no delegate, return a noop tracer.\n   */\n  private _getTracer() {\n    if (this._delegate) {\n      return this._delegate;\n    }\n\n    const tracer = this._provider.getDelegateTracer(\n      this.name,\n      this.version,\n      this.options\n    );\n\n    if (!tracer) {\n      return NOOP_TRACER;\n    }\n\n    this._delegate = tracer;\n    return this._delegate;\n  }\n}\n\nexport interface TracerDelegator {\n  getDelegateTracer(\n    name: string,\n    version?: string,\n    options?: TracerOptions\n  ): Tracer | undefined;\n}\n", "/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { NoopTracer } from './NoopTracer';\nimport { Tracer } from './tracer';\nimport { TracerOptions } from './tracer_options';\nimport { TracerProvider } from './tracer_provider';\n\n/**\n * An implementation of the {@link TracerProvider} which returns an impotent\n * Tracer for all calls to `getTracer`.\n *\n * All operations are no-op.\n */\nexport class NoopTracerProvider implements TracerProvider {\n  getTracer(\n    _name?: string,\n    _version?: string,\n    _options?: TracerOptions\n  ): Tracer {\n    return new NoopTracer();\n  }\n}\n", "/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Tracer } from './tracer';\nimport { TracerProvider } from './tracer_provider';\nimport { ProxyTracer } from './ProxyTracer';\nimport { NoopTracerProvider } from './NoopTracerProvider';\nimport { TracerOptions } from './tracer_options';\n\nconst NOOP_TRACER_PROVIDER = new NoopTracerProvider();\n\n/**\n * Tracer provider which provides {@link ProxyTracer}s.\n *\n * Before a delegate is set, tracers provided are NoOp.\n *   When a delegate is set, traces are provided from the delegate.\n *   When a delegate is set after tracers have already been provided,\n *   all tracers already provided will use the provided delegate implementation.\n */\nexport class ProxyTracerProvider implements TracerProvider {\n  private _delegate?: TracerProvider;\n\n  /**\n   * Get a {@link ProxyTracer}\n   */\n  getTracer(name: string, version?: string, options?: TracerOptions): Tracer {\n    return (\n      this.getDelegateTracer(name, version, options) ??\n      new ProxyTracer(this, name, version, options)\n    );\n  }\n\n  getDelegate(): TracerProvider {\n    return this._delegate ?? NOOP_TRACER_PROVIDER;\n  }\n\n  /**\n   * Set the delegate tracer provider\n   */\n  setDelegate(delegate: TracerProvider) {\n    this._delegate = delegate;\n  }\n\n  getDelegateTracer(\n    name: string,\n    version?: string,\n    options?: TracerOptions\n  ): Tracer | undefined {\n    return this._delegate?.getTracer(name, version, options);\n  }\n}\n", "/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// Split module-level variable definition into separate files to allow\n// tree-shaking on each api instance.\nimport { ContextAPI } from './api/context';\n/** Entrypoint for context API */\nexport const context = ContextAPI.getInstance();\n", "/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  getGlobal,\n  registerGlobal,\n  unregisterGlobal,\n} from '../internal/global-utils';\nimport { ProxyTracerProvider } from '../trace/ProxyTracerProvider';\nimport {\n  isSpanContextValid,\n  wrapSpanContext,\n} from '../trace/spancontext-utils';\nimport { Tracer } from '../trace/tracer';\nimport { TracerProvider } from '../trace/tracer_provider';\nimport {\n  deleteSpan,\n  getActiveSpan,\n  getSpan,\n  getSpanContext,\n  setSpan,\n  setSpanContext,\n} from '../trace/context-utils';\nimport { DiagAPI } from './diag';\n\nconst API_NAME = 'trace';\n\n/**\n * Singleton object which represents the entry point to the OpenTelemetry Tracing API\n */\nexport class TraceAPI {\n  private static _instance?: TraceAPI;\n\n  private _proxyTracerProvider = new ProxyTracerProvider();\n\n  /** Empty private constructor prevents end users from constructing a new instance of the API */\n  private constructor() {}\n\n  /** Get the singleton instance of the Trace API */\n  public static getInstance(): TraceAPI {\n    if (!this._instance) {\n      this._instance = new TraceAPI();\n    }\n\n    return this._instance;\n  }\n\n  /**\n   * Set the current global tracer.\n   *\n   * @returns true if the tracer provider was successfully registered, else false\n   */\n  public setGlobalTracerProvider(provider: TracerProvider): boolean {\n    const success = registerGlobal(\n      API_NAME,\n      this._proxyTracerProvider,\n      DiagAPI.instance()\n    );\n    if (success) {\n      this._proxyTracerProvider.setDelegate(provider);\n    }\n    return success;\n  }\n\n  /**\n   * Returns the global tracer provider.\n   */\n  public getTracerProvider(): TracerProvider {\n    return getGlobal(API_NAME) || this._proxyTracerProvider;\n  }\n\n  /**\n   * Returns a tracer from the global tracer provider.\n   */\n  public getTracer(name: string, version?: string): Tracer {\n    return this.getTracerProvider().getTracer(name, version);\n  }\n\n  /** Remove the global tracer provider */\n  public disable() {\n    unregisterGlobal(API_NAME, DiagAPI.instance());\n    this._proxyTracerProvider = new ProxyTracerProvider();\n  }\n\n  public wrapSpanContext = wrapSpanContext;\n\n  public isSpanContextValid = isSpanContextValid;\n\n  public deleteSpan = deleteSpan;\n\n  public getSpan = getSpan;\n\n  public getActiveSpan = getActiveSpan;\n\n  public getSpanContext = getSpanContext;\n\n  public setSpan = setSpan;\n\n  public setSpanContext = setSpanContext;\n}\n", "/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// Split module-level variable definition into separate files to allow\n// tree-shaking on each api instance.\nimport { TraceAPI } from './api/trace';\n/** Entrypoint for trace API */\nexport const trace = TraceAPI.getInstance();\n", "\nimport { tryGetEnvVar, resetEnvVarCache, isEagerAutoSanitizeEnabled } from \"../env/environmentUtil\";\nimport { sendStatToKpitracks } from \"../stat/statUtil\";\nimport { context as otelContext, trace, isSpanContextValid, Span } from '@opentelemetry/api';\nimport { sanitizePII, eagerSanitizePII } from './piiSanitizer';\n\nlet AsyncLocalStorage: any | undefined;\n\nif (typeof window === \"undefined\" && typeof global !== \"undefined\") {\n  const { AsyncLocalStorage: ALS } = require(\"async_hooks\");\n  AsyncLocalStorage = ALS;\n}\n\nlet asyncLocalStorage: any | undefined;\nif (AsyncLocalStorage != null) {\n  asyncLocalStorage = new AsyncLocalStorage();\n}\n\nclass LoggerFactory {\n  private static mapOfLoggers: Map<string, Logger>;\n\n  public static getLogger(loggerName: string): Logger {\n    if (LoggerFactory.mapOfLoggers == null) {\n      LoggerFactory.mapOfLoggers = new Map()\n    }\n\n    let logger: Logger = this.mapOfLoggers.get(loggerName) as Logger\n    if (logger == null){\n      logger = new Logger(loggerName)\n      LoggerFactory.mapOfLoggers.set(loggerName, logger)\n    }\n    return logger\n  }\n\n  public static resetLoggerCache(): void {\n    LoggerFactory.mapOfLoggers = new Map();\n  }\n}\n\ntype stringorstringfn = string | (() => string)\n\nclass Logger {\n  constructor(private readonly loggerName: string) {}\n\n  private buildLogMsg(severity: string, msg: stringorstringfn, context: JSONContext | undefined | Error): string {\n    if (isTruelike(tryGetEnvVar('LOG_USE_JSON_FORMAT'))) {\n      return this.buildLogMsgJsonFormat(severity, msg, context);\n    } else {\n      return this.buildLogMsgPlainText(severity, msg, context);\n    }\n  }\n\n  private buildLogMsgJsonFormat(severity: string, msg: stringorstringfn, context: JSONContext | undefined | Error): string {\n    const json: any = {}\n    if (typeof process !== 'undefined' && isTruelike(tryGetEnvVar('LOG_PREPEND_TIMESTAMP'))) {\n      json[\"at\"] = new Date().toISOString()\n    }\n\n    severity = severity.replace(/[\\[\\]]/g, \"\").trim()\n\n    json[\"lvl\"] = severity\n    json[\"logger\"] = this.loggerName\n\n    if (typeof msg === 'function') {\n      json[\"msg\"] = msg()\n    } else {\n      json[\"msg\"] = msg\n    }\n\n    context = this.buildCompleteJsonContext(context)\n    \n    // testing\n    // context[\"spanId\"] = \"from context\"\n    // json[\"spanId\"] = \"from orig\"\n\n    // In the merged JSON, the root context should take presedence over the context\n    const mergedJson = { ...context, ...json }\n\n\n    return JSON.stringify(mergedJson)\n  }\n\n  private buildCompleteJsonContext(context: JSONContext | undefined | Error): JSONContext {\n    // Convert Error to JSONContext\n    let jsonContext: JSONContext = {};\n    if (context instanceof Error) {\n      jsonContext = {\n        error: context.message,\n        errorName: context.name,\n        errorStack: context.stack\n      };\n    } else if (context != null) {\n      jsonContext = { ...context };\n    }\n\n    if (asyncLocalStorage != null) {\n      try {\n        const storeInLocalStorage = asyncLocalStorage.getStore();\n        if (storeInLocalStorage != null && typeof storeInLocalStorage === 'object') {\n          const storeId = storeInLocalStorage.storeId;\n          if (storeId != null) {\n            jsonContext = Object.assign({}, jsonContext, { storeId });\n          }\n        }\n      } catch (err) {\n      }\n    }\n\n\n    const span = trace.getSpan(otelContext.active());\n    if (span) {\n      const { traceId, spanId } = span.spanContext();\n      // console.log(`traceId = '${traceId}', spanId = '${spanId}'`)\n      // https://opentelemetry.io/docs/specs/otel/compatibility/logging_trace_context/#overview non-otlp JSON logs use trace_id, not traceId.\n      jsonContext = Object.assign({}, jsonContext, { trace_id: traceId, span_id: spanId })\n    } else {\n      // console.log(\"No Span\")\n    }\n\n    // Sanitize PII fields based on environment configuration\n    if (isEagerAutoSanitizeEnabled()) {\n      // LOG_EAGER_AUTO_SANITIZE: use eagerSanitizePII (keeps field names, blurs values)\n      jsonContext = eagerSanitizePII(jsonContext);\n    } else if (tryGetEnvVar('LOG_HASH_SECRET')) {\n      // LOG_HASH_SECRET only: use sanitizePII (renames to _hash, removes original)\n      jsonContext = sanitizePII(jsonContext);\n    }\n\n    return jsonContext\n  }\n\n\n  private buildLogMsgPlainText(severity: string, msg: stringorstringfn, context: JSONContext | undefined | Error): string {\n    const messageParts = [];\n    if (typeof process !== 'undefined' && isTruelike(tryGetEnvVar('LOG_PREPEND_TIMESTAMP'))) {\n      messageParts.push(new Date().toUTCString())\n    }\n    messageParts.push(severity)\n    // messageParts.push(JSON.stringify(context))\n    messageParts.push(this.loggerName)\n\n    if (typeof msg === 'function') {\n      messageParts.push(msg())\n    } else {\n      messageParts.push(msg)\n    }\n    \n    context = this.buildCompleteJsonContext(context)\n\n\n    const wouldBeJsonContextString = JSON.stringify(context)\n    if (wouldBeJsonContextString != null && wouldBeJsonContextString.length > 0 && wouldBeJsonContextString != \"{}\" && wouldBeJsonContextString != \"{ }\") {\n      messageParts.push(wouldBeJsonContextString)\n    }\n    return messageParts.join(\" \")\n  }\n\n  private writeLogMsgToTerminal(msg: string, ...extra: any[]): void {\n    if (typeof process !== 'undefined' && isTruelike(tryGetEnvVar('LOG_TO_STDERR'))) {\n      if (extra.length === 0) {\n        console.error(msg)\n      } else if (extra.length > 0) {\n        console.error(msg, extra)\n      }\n    } else {\n      if (extra.length === 0) {\n        console.log(msg)\n      } else if (extra.length > 0) {\n        console.log(msg, extra)\n      }\n    }\n  }\n\n  public trace(msg: stringorstringfn, context: JSONContext | Error | undefined = undefined, ...extra: any[]): void {\n    if (isLogLevelEnabled(this.loggerName, 'TRACE')) {\n      const completeMsg = this.buildLogMsg(\"[ TRACE]\", msg, context)\n      this.writeLogMsgToTerminal(completeMsg)\n    }\n  }\n\n  public debug(msg: stringorstringfn, context: JSONContext | Error | undefined = undefined, ...extra: any[]): void {\n    if (isLogLevelEnabled(this.loggerName, 'DEBUG')) {\n      const completeMsg = this.buildLogMsg(\"[ DEBUG]\", msg, context)\n      this.writeLogMsgToTerminal(completeMsg)\n    }\n  }\n\n  public info(msg: stringorstringfn, context: JSONContext | Error | undefined = undefined, ...extra: any[]): void {\n    if (isLogLevelEnabled(this.loggerName, 'INFO')) {\n      const completeMsg = this.buildLogMsg(\"[  INFO]\", msg, context)\n      this.writeLogMsgToTerminal(completeMsg)\n    }\n  }\n\n  public notice(msg: stringorstringfn, context: JSONContext | Error | undefined = undefined, ...extra: any[]): void {\n    if (isLogLevelEnabled(this.loggerName, 'NOTICE')) {\n      const completeMsg = this.buildLogMsg(\"[NOTICE]\", msg, context)\n      this.writeLogMsgToTerminal(completeMsg)\n    }\n  }\n\n\n  public fatal(msg: stringorstringfn, context: JSONContext | Error | undefined = undefined, ...extra: any[]): void {\n    if (!isLogLevelEnabled(this.loggerName, 'FATAL')) {\n      return;\n    }\n\n    if (typeof process !== 'undefined' && process.env?.STATHAT_EZ_KEY != null && process.env?.STATHAT_EZ_KEY.trim()?.length > 0 && process.env?.STATHAT_FATAL_KEY != null && process.env?.STATHAT_FATAL_KEY.trim()?.length > 0) {\n\n      const controller = new AbortController()\n      // 1 second timeout:\n      const timeoutId = setTimeout(() => controller.abort(), 750)\n\n      const url = \"https://api.stathat.com/ez\"\n      // This param should either be 'ezkey' or 'email'... I'm not sure which\n      const ezKeyLabel = \"ezkey\" // vs email\n      const requestBody = `stat=${process.env.STATHAT_FATAL_KEY?.trim()}&${ezKeyLabel}=${process.env.STATHAT_EZ_KEY?.trim()}&count=1`\n\n      /*\n       * % curl -v -d \"stat=sisu _ERROR&email=ezkey&count=1\" https://api.stathat.com/ez\n       */\n\n      // console.log(`Sending POST to Stathat url = '${url}',  requestBody = '${requestBody}'`)\n\n      const beforeAt = new Date()\n      // While still experimental, the global fetch API is available by default in Node.js 18\n      fetch(url, {\n        method: 'POST',\n        headers:{\n          'Content-Type': 'application/x-www-form-urlencoded'\n        },\n        signal: controller.signal,\n        body: requestBody\n      }).then(response => {\n        // completed request before timeout fired\n        const deltaInMs = new Date().getTime() - beforeAt.getTime()\n        // console.log(`Stathat fetch completed after ${deltaInMs} milliseconds,  with response = ${d4l(response)}`)\n\n        // If you only wanted to timeout the request, not the response, add:\n        clearTimeout(timeoutId)\n      }).catch(err => {\n        // console.log(`[STATHAT][ ERROR] Reason: ${d4l(err)}`)\n      })\n    }\n\n    if (typeof process !== 'undefined' && process.env?.KPITRACKS_FATAL_KEY != null && process.env?.KPITRACKS_FATAL_KEY?.trim()?.length > 0) {\n      sendStatToKpitracks(`stat=${process.env.KPITRACKS_FATAL_KEY?.trim()}&count=1`)\n    }\n    const completeMsg = this.buildLogMsg(\"[ FATAL][ ERROR]\", msg, context)\n    this.writeLogMsgToTerminal(completeMsg)\n  }\n\n  public warn(msg: string, context: JSONContext | Error | undefined = undefined, ...extra: any[]): void {\n    if (!isLogLevelEnabled(this.loggerName, 'WARN')) {\n      return;\n    }\n\n    if (typeof process !== 'undefined' && process.env?.STATHAT_EZ_KEY != null && process.env?.STATHAT_EZ_KEY?.trim()?.length > 0 && process.env?.STATHAT_WARN_KEY != null && process.env?.STATHAT_WARN_KEY?.trim()?.length > 0) {\n\n      const controller = new AbortController()\n      // 1 second timeout:\n      const timeoutId = setTimeout(() => controller.abort(), 750)\n\n      const url = \"https://api.stathat.com/ez\"\n      // This param should either be 'ezkey' or 'email'... I'm not sure which\n      const ezKeyLabel = \"ezkey\" // vs email\n      const requestBody = `stat=${process.env.STATHAT_WARN_KEY?.trim()}&${ezKeyLabel}=${process.env.STATHAT_EZ_KEY?.trim()}&count=1`\n\n      /*\n       * % curl -v -d \"stat=sisu _ERROR&email=ezkey&count=1\" https://api.stathat.com/ez\n       */\n\n      // console.log(`Sending POST to Stathat url = '${url}',  requestBody = '${requestBody}'`)\n\n      const beforeAt = new Date()\n      // While still experimental, the global fetch API is available by default in Node.js 18\n      fetch(url, {\n        method: 'POST',\n        headers:{\n          'Content-Type': 'application/x-www-form-urlencoded'\n        },\n        signal: controller.signal,\n        body: requestBody\n      }).then(response => {\n        // completed request before timeout fired\n        const deltaInMs = new Date().getTime() - beforeAt.getTime()\n        // console.log(`Stathat fetch completed after ${deltaInMs} milliseconds,  with response = ${d4l(response)}`)\n\n        // If you only wanted to timeout the request, not the response, add:\n        clearTimeout(timeoutId)\n      }).catch(err => {\n        // console.log(`[STATHAT][ ERROR] Reason: ${d4l(err)}`)\n      })\n    }\n\n    if (typeof process !== 'undefined' && process.env?.KPITRACKS_WARN_KEY != null && process.env?.KPITRACKS_WARN_KEY?.trim()?.length > 0) {\n      sendStatToKpitracks(`stat=${process.env.KPITRACKS_WARN_KEY?.trim()}&count=1`)\n    }\n    const completeMsg = this.buildLogMsg(\"[  WARN]\", msg, context)\n    this.writeLogMsgToTerminal(completeMsg)\n  }\n\n\n  public error(msg: string, context: JSONContext | Error | undefined = undefined, ...extra: any[]): void {\n    if (!isLogLevelEnabled(this.loggerName, 'ERROR')) {\n      return;\n    }\n\n    // console.log(`error(): STATHAT_EZ_KEY = '${process.env.STATHAT_EZ_KEY}',  STATHAT_ERROR_KEY = '${process.env.STATHAT_ERROR_KEY}'`)\n\n    if (typeof process !== 'undefined' && process.env?.STATHAT_EZ_KEY != null && process.env?.STATHAT_EZ_KEY?.trim()?.length > 0 && process.env?.STATHAT_ERROR_KEY != null && process.env?.STATHAT_ERROR_KEY?.trim()?.length > 0) {\n      // TODO: Change this to run as a promise\n      // try {\n        // stathat.trackEZCount(process.env.STATHAT_EZ_KEY?.trim(), process.env.STATHAT_ERROR_KEY?.trim(), 1, function(status: any, json: any) {});\n\n\n      const controller = new AbortController()\n      // 1 second timeout:\n      const timeoutId = setTimeout(() => controller.abort(), 750)\n\n      const url = \"https://api.stathat.com/ez\"\n      // This param should either be 'ezkey' or 'email'... I'm not sure which\n      const ezKeyLabel = \"ezkey\" // vs email\n      const requestBody = `stat=${process.env.STATHAT_ERROR_KEY?.trim()}&${ezKeyLabel}=${process.env.STATHAT_EZ_KEY?.trim()}&count=1`\n\n      /*\n       * % curl -v -d \"stat=sisu _ERROR&email=ezkey&count=1\" https://api.stathat.com/ez\n       */\n\n      // console.log(`Sending POST to Stathat url = '${url}',  requestBody = '${requestBody}'`)\n\n      const beforeAt = new Date()\n      // While still experimental, the global fetch API is available by default in Node.js 18\n      fetch(url, {\n        method: 'POST',\n        headers:{\n          'Content-Type': 'application/x-www-form-urlencoded'\n        },\n        signal: controller.signal,\n        body: requestBody\n      }).then(response => {\n        // completed request before timeout fired\n        const deltaInMs = new Date().getTime() - beforeAt.getTime()\n        // console.log(`Stathat fetch completed after ${deltaInMs} milliseconds,  with response = ${d4l(response)}`)\n\n        // If you only wanted to timeout the request, not the response, add:\n        clearTimeout(timeoutId)\n      }).catch(err => {\n        // console.log(`[STATHAT][ ERROR] Reason: ${d4l(err)}`)\n      })\n\n      // } catch(err) {\n      //   const stathatError = this.buildLogMsg(\"[STATHAT][ ERROR]\", msg, context)\n      //   console.log(stathatError)\n      // }\n    }\n\n    if (typeof process !== 'undefined' && process.env?.KPITRACKS_ERROR_KEY != null && process.env?.KPITRACKS_ERROR_KEY?.trim()?.length > 0) {\n      sendStatToKpitracks(`stat=${process.env.KPITRACKS_ERROR_KEY?.trim()}&count=1`)\n    }\n\n    const completeMsg = this.buildLogMsg(\"[ ERROR]\", msg, context)\n    this.writeLogMsgToTerminal(completeMsg)\n  }\n}\n\nexport function getLogger(loggerName: string): Logger {\n  return LoggerFactory.getLogger(loggerName)\n} \n\nexport function withStoreId(storeId: string, fn: () => any) {\n  if (typeof asyncLocalStorage != 'undefined' && asyncLocalStorage != null) {\n    let storeInLocalStorage: { storeId?: string } = asyncLocalStorage.getStore();\n    if (storeInLocalStorage == null) {\n      storeInLocalStorage = {}\n    }\n    storeInLocalStorage.storeId = storeId;\n\n    return asyncLocalStorage.run(storeInLocalStorage, fn);\n  } else {\n    return fn();\n  }\n}\n\nfunction isTruelike(input: boolean | string | number | undefined): boolean {\n  if (input == null) {\n    return false\n  }\n  if ([\n    'true', 'yes', 't', 'y', '1'\n  ].includes(input.toString().trim().toLowerCase())) {\n    return true\n  }\n  return false\n}\n\ntype JSONContext = { [key: string]: any }\n\n// Log level configuration types\nexport type LogLevel = 'TRACE' | 'DEBUG' | 'INFO' | 'NOTICE' | 'WARN' | 'ERROR' | 'FATAL';\n\nexport interface LogLevelRule {\n  pattern: string;\n  level: LogLevel;\n}\n\n/**\n * Global log level rules configuration.\n *\n * You can directly modify this from your application code:\n *\n * ```typescript\n * import { LOG_RULES } from 'ts-gist-pile';\n *\n * // Add rules\n * LOG_RULES.levels.push(\n *   { pattern: 'api.users', level: 'TRACE' },\n *   { pattern: 'api.*', level: 'DEBUG' },\n *   { pattern: '*', level: 'INFO' }\n * );\n *\n * // Or replace entirely\n * LOG_RULES.levels = [\n *   { pattern: 'api.*', level: 'DEBUG' }\n * ];\n * ```\n *\n * **Priority:** Rules are evaluated in order (first match wins).\n * If a logger name matches ANY pattern in LOG_RULES.levels, that rule\n * takes complete precedence over legacy env vars (LOG_DEBUG, LOG_TRACE, etc.),\n * regardless of whether the rule is more or less restrictive.\n *\n * **Example:**\n * ```typescript\n * LOG_RULES.levels = [{ pattern: '*', level: 'WARN' }];\n * process.env.LOG_DEBUG = '1';  // This is IGNORED for all loggers\n *\n * const logger = getLogger('MyService');\n * logger.debug('test');  // Won't appear (WARN level from rule)\n * logger.warn('test');   // Will appear\n * ```\n *\n * Only loggers that don't match any pattern will fall back to env vars.\n */\nexport const LOG_RULES: { levels: LogLevelRule[] } = {\n  levels: []\n};\n\n/**\n * Determines if a logger name matches a pattern.\n * Supports:\n * - Exact matches: \"api.users\" matches \"api.users\"\n * - Prefix wildcards: \"*.users\" matches \"api.users\", \"db.users\"\n * - Suffix wildcards: \"api.*\" matches \"api.users\", \"api.products\"\n * - Middle wildcards: \"api.*.service\" matches \"api.users.service\", \"api.products.service\"\n *\n * @param loggerName The logger name to match\n * @param pattern The pattern to match against\n * @returns true if the logger name matches the pattern\n */\nfunction matchesPattern(loggerName: string, pattern: string): boolean {\n  // Exact match\n  if (pattern === loggerName) {\n    return true;\n  }\n\n  // No wildcard - must be exact match (already checked above)\n  if (!pattern.includes('*')) {\n    return false;\n  }\n\n  // Convert pattern to regex\n  // Escape special regex characters except *\n  const regexPattern = pattern\n    .split('*')\n    .map(part => part.replace(/[.+?^${}()|[\\]\\\\]/g, '\\\\$&'))\n    .join('.*');\n\n  const regex = new RegExp(`^${regexPattern}$`);\n  return regex.test(loggerName);\n}\n\n/**\n * Parses log level rules from LOG_RULES.levels.\n *\n * Rules are evaluated in order (first match wins), so put the most\n * specific patterns first and general fallback patterns last.\n *\n * Usage in your app:\n * ```typescript\n * // In your app's config/log-levels.ts\n * import { LOG_RULES } from 'ts-gist-pile';\n *\n * LOG_RULES.levels = [\n *   { pattern: \"api.users.*\", level: \"DEBUG\" },\n *   { pattern: \"api.*\", level: \"INFO\" },\n *   { pattern: \"*\", level: \"WARN\" }\n * ];\n *\n * // Then in your app entry point:\n * import './config/log-levels';  // Load FIRST, before creating loggers\n * ```\n *\n * @returns Array of log level rules, or empty array if not configured\n */\nfunction parseLogLevelRules(): LogLevelRule[] {\n  return LOG_RULES.levels;\n}\n\n/**\n * Finds the first matching rule for a logger name.\n * Rules are evaluated in order from first to last.\n * The first rule that matches is used (first match wins).\n *\n * This allows users to put the most specific rules at the front\n * and more general fallback rules towards the back.\n *\n * Example:\n * [\n *   {\"pattern\": \"api.users.controller\", \"level\": \"TRACE\"},  // Most specific\n *   {\"pattern\": \"api.users.*\", \"level\": \"DEBUG\"},           // More general\n *   {\"pattern\": \"api.*\", \"level\": \"INFO\"},                  // Even more general\n *   {\"pattern\": \"*\", \"level\": \"WARN\"}                       // Fallback\n * ]\n *\n * @param loggerName The logger name to find a rule for\n * @param rules The array of log level rules (in priority order)\n * @returns The matching log level, or null if no rule matches\n */\nfunction findMatchingLogLevel(loggerName: string, rules: LogLevelRule[]): LogLevel | null {\n  if (rules.length === 0) {\n    return null;\n  }\n\n  // Find the first matching rule\n  for (const rule of rules) {\n    if (matchesPattern(loggerName, rule.pattern)) {\n      return rule.level;\n    }\n  }\n\n  return null;\n}\n\n// Cache parsed rules to avoid reparsing on every log call\nlet cachedLogLevelRules: LogLevelRule[] | null = null;\n\n/**\n * Gets the configured log level rules, using a cache to avoid reparsing.\n * @returns Array of log level rules\n */\nfunction getLogLevelRules(): LogLevelRule[] {\n  if (cachedLogLevelRules === null) {\n    cachedLogLevelRules = parseLogLevelRules();\n  }\n  return cachedLogLevelRules;\n}\n\n/**\n * Resets the cached log level rules and logger instances.\n * This is primarily useful for testing, to force re-reading the configuration\n * and recreating logger instances with the new configuration.\n *\n * Note: This does NOT reset the environment variable memoization cache,\n * as that would cause tryGetEnvVar to log debug messages again.\n * @internal\n */\nexport function resetLogLevelRulesCache(): void {\n  cachedLogLevelRules = null;\n  cachedParsedLogLevel = undefined;\n  LoggerFactory.resetLoggerCache();\n}\n\n// Cache for parsed LOG_LEVEL to avoid repeated parsing and warnings\nlet cachedParsedLogLevel: LogLevel | null | undefined = undefined;\n\n/**\n * Parses the LOG_LEVEL environment variable and returns the corresponding LogLevel.\n *\n * @returns The parsed log level, or null if LOG_LEVEL is not set or invalid\n */\nfunction parseLogLevelFromEnv(): LogLevel | null {\n  if (cachedParsedLogLevel !== undefined) {\n    return cachedParsedLogLevel;\n  }\n\n  const logLevelValue = tryGetEnvVar('LOG_LEVEL');\n  if (!logLevelValue) {\n    cachedParsedLogLevel = null;\n    return null;\n  }\n\n  const normalizedValue = logLevelValue.trim().toUpperCase();\n  const validLevels: LogLevel[] = ['TRACE', 'DEBUG', 'INFO', 'NOTICE', 'WARN', 'ERROR', 'FATAL'];\n\n  if (validLevels.includes(normalizedValue as LogLevel)) {\n    cachedParsedLogLevel = normalizedValue as LogLevel;\n    return cachedParsedLogLevel;\n  }\n\n  // Invalid LOG_LEVEL value - log a warning (only once due to caching)\n  console.log(`ts-gist-pile: Invalid LOG_LEVEL value: '${logLevelValue}'. Valid values are: ${validLevels.join(', ')}`);\n  cachedParsedLogLevel = null;\n  return null;\n}\n\n/**\n * Determines if a specific log level should be enabled for a logger.\n *\n * Priority order:\n * 1. Pattern-based rules (LOG_RULES.levels) - If ANY pattern matches, uses that rule exclusively\n * 2. Individual level environment variables (LOG_TRACE, LOG_DEBUG, LOG_INFO)\n * 3. LOG_LEVEL environment variable (sets multiple levels at once)\n * 4. Default behavior (NOTICE and above always enabled)\n *\n * Individual level env vars override LOG_LEVEL. For example:\n * - LOG_LEVEL=trace LOG_TRACE=0 \u2192 trace is disabled, but debug/info/etc. are enabled\n * - LOG_LEVEL=trace LOG_DEBUG=0 \u2192 trace is enabled, debug is disabled, info/etc. are enabled\n *\n * IMPORTANT: If a pattern matches in LOG_RULES.levels, the rule takes complete precedence\n * over all env vars, regardless of whether it's more or less restrictive.\n *\n * Example:\n * ```\n * LOG_RULES.levels = [{ pattern: '*', level: 'WARN' }];\n * process.env.LOG_DEBUG = '1';  // IGNORED - rule matches all loggers\n *\n * getLogger('MyService').debug('test');  // Won't appear (WARN from rule)\n * ```\n *\n * @param loggerName The logger name\n * @param level The log level to check\n * @returns true if the log level is enabled\n */\nfunction isLogLevelEnabled(loggerName: string, level: LogLevel): boolean {\n  // Check for pattern-based configuration first\n  const rules = getLogLevelRules();\n  const configuredLevel = findMatchingLogLevel(loggerName, rules);\n\n  if (configuredLevel !== null) {\n    // Use pattern-based configuration\n    const levelHierarchy: LogLevel[] = ['TRACE', 'DEBUG', 'INFO', 'NOTICE', 'WARN', 'ERROR', 'FATAL'];\n    const configuredIndex = levelHierarchy.indexOf(configuredLevel);\n    const requestedIndex = levelHierarchy.indexOf(level);\n    return requestedIndex >= configuredIndex;\n  }\n\n  // Fall back to environment variable checks\n  if (typeof process === 'undefined') {\n    // In browser, only NOTICE and above are enabled by default\n    return ['NOTICE', 'WARN', 'ERROR', 'FATAL'].includes(level);\n  }\n\n  // Check individual level env vars first (they override LOG_LEVEL)\n  let individualLevelSet = false;\n  let individualLevelEnabled = false;\n\n  switch (level) {\n    case 'TRACE':\n      const traceEnv = tryGetEnvVar('LOG_TRACE');\n      if (traceEnv !== undefined) {\n        individualLevelSet = true;\n        individualLevelEnabled = isTruelike(traceEnv);\n      }\n      break;\n    case 'DEBUG':\n      const debugEnv = tryGetEnvVar('LOG_DEBUG');\n      if (debugEnv !== undefined) {\n        individualLevelSet = true;\n        individualLevelEnabled = isTruelike(debugEnv);\n      }\n      break;\n    case 'INFO':\n      const infoEnv = tryGetEnvVar('LOG_INFO');\n      if (infoEnv !== undefined) {\n        individualLevelSet = true;\n        individualLevelEnabled = isTruelike(infoEnv);\n      }\n      break;\n    case 'NOTICE':\n      const noticeEnv = tryGetEnvVar('LOG_NOTICE');\n      if (noticeEnv !== undefined) {\n        individualLevelSet = true;\n        individualLevelEnabled = isTruelike(noticeEnv);\n      }\n      break;\n    case 'WARN':\n      const warnEnv = tryGetEnvVar('LOG_WARN');\n      if (warnEnv !== undefined) {\n        individualLevelSet = true;\n        individualLevelEnabled = isTruelike(warnEnv);\n      }\n      break;\n    case 'ERROR':\n      const errorEnv = tryGetEnvVar('LOG_ERROR');\n      if (errorEnv !== undefined) {\n        individualLevelSet = true;\n        individualLevelEnabled = isTruelike(errorEnv);\n      }\n      break;\n    case 'FATAL':\n      const fatalEnv = tryGetEnvVar('LOG_FATAL');\n      if (fatalEnv !== undefined) {\n        individualLevelSet = true;\n        individualLevelEnabled = isTruelike(fatalEnv);\n      }\n      break;\n  }\n\n  // If an individual level env var was set, use that (it overrides LOG_LEVEL)\n  if (individualLevelSet) {\n    return individualLevelEnabled;\n  }\n\n  // Check LOG_LEVEL env var\n  const logLevel = parseLogLevelFromEnv();\n  if (logLevel !== null) {\n    const levelHierarchy: LogLevel[] = ['TRACE', 'DEBUG', 'INFO', 'NOTICE', 'WARN', 'ERROR', 'FATAL'];\n    const configuredIndex = levelHierarchy.indexOf(logLevel);\n    const requestedIndex = levelHierarchy.indexOf(level);\n    return requestedIndex >= configuredIndex;\n  }\n\n  // Default behavior: NOTICE and above are always enabled\n  return ['NOTICE', 'WARN', 'ERROR', 'FATAL'].includes(level);\n}", "/**\n * Retry utility for handling transient failures with exponential backoff\n *\n * @module retry/retryUtil\n */\n\n/**\n * Options for configuring retry behavior\n */\nexport interface RetryOptions<T> {\n  /**\n   * Maximum number of attempts (including initial attempt)\n   * @default 3\n   */\n  maxAttempts: number;\n\n  /**\n   * Initial delay in milliseconds before first retry\n   * For exponential backoff, this is the base delay\n   * @default 100\n   */\n  backoffMs: number;\n\n  /**\n   * Maximum delay in milliseconds (caps exponential backoff)\n   * @default undefined (no cap)\n   */\n  maxDelayMs?: number;\n\n  /**\n   * Backoff multiplier for exponential backoff\n   * Delay calculation: backoffMs * (backoffMultiplier ^ (attempt - 1))\n   * Set to 1 for constant backoff\n   * @default 2 (exponential backoff)\n   */\n  backoffMultiplier?: number;\n\n  /**\n   * Jitter factor to prevent thundering herd (0.0 to 1.0)\n   * Adds randomness: delay * (1 + random(-jitter, +jitter))\n   * @default 0.1\n   */\n  jitter?: number;\n\n  /**\n   * Predicate to determine if retry should occur\n   * Called with both error (if thrown) and result (if successful)\n   * Return true to retry, false to stop\n   *\n   * @param error - The error thrown (if any)\n   * @param result - The result returned (if no error)\n   * @param attempt - Current attempt number (1-indexed)\n   * @returns true to retry, false to return/throw\n   *\n   * @example\n   * // Retry on specific errors\n   * shouldRetry: (error) => error?.code === 'ECONNRESET'\n   *\n   * @example\n   * // Retry on null results (eventual consistency)\n   * shouldRetry: (error, result) => result == null\n   *\n   * @example\n   * // Retry on both errors and null results\n   * shouldRetry: (error, result) => error != null || result == null\n   */\n  shouldRetry: (error: unknown, result: T | undefined, attempt: number) => boolean;\n\n  /**\n   * Optional callback invoked before each retry attempt\n   *\n   * @param error - The error that triggered the retry\n   * @param result - The result that triggered the retry (if no error)\n   * @param attempt - Attempt number that just failed (1-indexed)\n   * @param delayMs - Milliseconds until next retry\n   */\n  onRetry?: (error: unknown, result: T | undefined, attempt: number, delayMs: number) => void;\n\n  /**\n   * Optional callback invoked when all retries are exhausted\n   *\n   * @param lastError - The last error thrown (if any)\n   * @param lastResult - The last result returned (if no error)\n   * @param totalAttempts - Total number of attempts made\n   */\n  onFailure?: (lastError: unknown, lastResult: T | undefined, totalAttempts: number) => void;\n}\n\n/**\n * Default retry options - conservative settings suitable for most use cases\n */\nexport const DEFAULT_RETRY_OPTIONS: Partial<RetryOptions<unknown>> = {\n  maxAttempts: 3,\n  backoffMs: 100,\n  backoffMultiplier: 2,\n  jitter: 0.1,\n};\n\n/**\n * Calculate delay with exponential backoff and jitter\n */\nfunction calculateDelay(\n  attempt: number,\n  backoffMs: number,\n  backoffMultiplier: number,\n  jitter: number,\n  maxDelayMs?: number\n): number {\n  // Exponential backoff: backoffMs * (multiplier ^ (attempt - 1))\n  let delay = backoffMs * Math.pow(backoffMultiplier, attempt - 1);\n\n  // Apply cap if specified\n  if (maxDelayMs !== undefined) {\n    delay = Math.min(delay, maxDelayMs);\n  }\n\n  // Apply jitter: delay * (1 + random(-jitter, +jitter))\n  if (jitter > 0) {\n    const jitterAmount = delay * jitter * (Math.random() * 2 - 1);\n    delay = delay + jitterAmount;\n  }\n\n  return Math.max(0, Math.floor(delay));\n}\n\n/**\n * Retry an async operation with exponential backoff\n *\n * @template T - The return type of the async operation\n * @param operation - The async function to retry\n * @param options - Retry configuration options\n * @returns The result of the operation if successful\n * @throws The last error if all retries are exhausted\n *\n * @example\n * // Retry on network errors\n * const data = await retryWithBackoff(\n *   () => fetch('https://api.example.com/data'),\n *   {\n *     maxAttempts: 5,\n *     backoffMs: 100,\n *     shouldRetry: (error) => error?.code === 'ECONNRESET'\n *   }\n * );\n *\n * @example\n * // Retry until result is non-null (eventual consistency)\n * const doc = await retryWithBackoff(\n *   () => documentStore.getDocument('users', { userId: 'test-user' }),\n *   {\n *     maxAttempts: 5,\n *     backoffMs: 100,\n *     shouldRetry: (error, result) => result == null\n *   }\n * );\n *\n * @example\n * // Retry with logging\n * const result = await retryWithBackoff(\n *   () => unreliableOperation(),\n *   {\n *     maxAttempts: 3,\n *     backoffMs: 200,\n *     shouldRetry: (error) => error != null,\n *     onRetry: (error, result, attempt, delayMs) => {\n *       console.log(`Attempt ${attempt} failed, retrying in ${delayMs}ms...`);\n *     },\n *     onFailure: (error, result, attempts) => {\n *       console.error(`All ${attempts} attempts failed`);\n *     }\n *   }\n * );\n */\nexport async function retryWithBackoff<T>(\n  operation: () => Promise<T>,\n  options: RetryOptions<T>\n): Promise<T> {\n  const {\n    maxAttempts,\n    backoffMs,\n    maxDelayMs,\n    backoffMultiplier = DEFAULT_RETRY_OPTIONS.backoffMultiplier!,\n    jitter = DEFAULT_RETRY_OPTIONS.jitter!,\n    shouldRetry,\n    onRetry,\n    onFailure,\n  } = options;\n\n  let lastError: unknown;\n  let lastResult: T | undefined;\n\n  for (let attempt = 1; attempt <= maxAttempts; attempt++) {\n    try {\n      const result = await operation();\n      lastResult = result;\n      lastError = undefined;\n\n      // Check if we should retry based on the result\n      const shouldRetryResult = shouldRetry(undefined, result, attempt);\n\n      if (!shouldRetryResult || attempt === maxAttempts) {\n        return result;\n      }\n\n      // Need to retry - calculate delay and wait\n      const delayMs = calculateDelay(attempt, backoffMs, backoffMultiplier, jitter, maxDelayMs);\n\n      if (onRetry) {\n        onRetry(undefined, result, attempt, delayMs);\n      }\n\n      await new Promise((resolve) => setTimeout(resolve, delayMs));\n    } catch (error) {\n      lastError = error;\n      lastResult = undefined;\n\n      // Check if we should retry based on the error\n      const shouldRetryError = shouldRetry(error, undefined, attempt);\n\n      if (!shouldRetryError || attempt === maxAttempts) {\n        // Don't retry, or out of attempts\n        if (onFailure && attempt === maxAttempts) {\n          onFailure(error, undefined, attempt);\n        }\n        throw error;\n      }\n\n      // Need to retry - calculate delay and wait\n      const delayMs = calculateDelay(attempt, backoffMs, backoffMultiplier, jitter, maxDelayMs);\n\n      if (onRetry) {\n        onRetry(error, undefined, attempt, delayMs);\n      }\n\n      await new Promise((resolve) => setTimeout(resolve, delayMs));\n    }\n  }\n\n  // This shouldn't be reachable, but TypeScript needs it\n  if (onFailure) {\n    onFailure(lastError, lastResult, maxAttempts);\n  }\n\n  if (lastError !== undefined) {\n    throw lastError;\n  }\n\n  return lastResult as T;\n}\n", "export function recursivelyFilterPropertiesInPlace<T>(obj: T, listOfPropertyNamesToRemove: Array<string>): void {\n  if(Array.isArray(obj)){\n    obj.forEach((item) => {\n      recursivelyFilterPropertiesInPlace(item, listOfPropertyNamesToRemove)\n    });\n  }\n  else if(typeof obj === 'object' && obj != null){\n    Object.getOwnPropertyNames(obj).forEach(function(key){\n      if(listOfPropertyNamesToRemove.indexOf(key) !== -1)delete (obj as any)[key];\n      else recursivelyFilterPropertiesInPlace((obj as any)[key],listOfPropertyNamesToRemove);\n    });\n  }\n}\n\nexport function recursivelyFilterPropertiesCopy<T>(obj: T, listOfPropertyNamesToRemove: Array<string>): T {\n  const clone = structuredClone(obj)\n  recursivelyFilterPropertiesInPlace(clone, listOfPropertyNamesToRemove)\n  return clone;\n}", "/**\n * Lightweight dependency injection container\n *\n * Provides a simple, type-safe alternative to inversify for registering\n * and retrieving service instances. Unlike inversify, this container:\n * - Requires manual instantiation (no decorators)\n * - Only supports constant value bindings (no transient/singleton scopes)\n * - Has minimal overhead and dependencies\n *\n * @example\n * ```typescript\n * import { Container } from '@jgithub/ts-gist-pile';\n *\n * const TYPES = {\n *   UserService: 'UserService',\n *   Logger: 'Logger'\n * };\n *\n * const container = new Container();\n *\n * // Register services\n * const logger = new ConsoleLogger();\n * container.bind<Logger>(TYPES.Logger).toConstantValue(logger);\n *\n * const userService = new UserServiceImpl(logger);\n * container.bind<UserService>(TYPES.UserService).toConstantValue(userService);\n *\n * // Retrieve services\n * const retrievedService = container.get<UserService>(TYPES.UserService);\n * ```\n */\nexport class Container {\n  private readonly bindings: Map<string | symbol, unknown> = new Map();\n\n  /**\n   * Bind a service identifier to a value\n   *\n   * @param serviceIdentifier - A string or symbol that uniquely identifies the service\n   * @returns A binding interface that allows you to specify the value\n   *\n   * @example\n   * ```typescript\n   * container.bind<MyService>(TYPES.MyService).toConstantValue(myServiceInstance);\n   * ```\n   */\n  public bind<T>(serviceIdentifier: string | symbol): ConstantServiceBinder<T> {\n    return new ConstantServiceBinder<T>(this.bindings, serviceIdentifier);\n  }\n\n  /**\n   * Rebind a service identifier to a new value\n   *\n   * This is useful for replacing an existing binding (e.g., for testing) or creating\n   * a new binding if one doesn't exist. It's functionally equivalent to unbind + bind.\n   *\n   * @param serviceIdentifier - A string or symbol that uniquely identifies the service\n   * @returns A binding interface that allows you to specify the value\n   *\n   * @example\n   * ```typescript\n   * // Replace an existing service with a mock for testing\n   * container.rebind<MyService>(TYPES.MyService).toConstantValue(mockServiceInstance);\n   * ```\n   */\n  public rebind<T>(serviceIdentifier: string | symbol): ConstantServiceBinder<T> {\n    this.unbind(serviceIdentifier); // Remove existing binding if it exists\n    return new ConstantServiceBinder<T>(this.bindings, serviceIdentifier);\n  }\n\n  /**\n   * Retrieve a service instance by its identifier\n   *\n   * @param serviceIdentifier - The string or symbol that identifies the service\n   * @returns The service instance\n   * @throws {Error} If no binding exists for the given identifier\n   *\n   * @example\n   * ```typescript\n   * const service = container.get<MyService>(TYPES.MyService);\n   * ```\n   */\n  public get<T>(serviceIdentifier: string | symbol): T {\n    if (!this.bindings.has(serviceIdentifier)) {\n      const identifierStr = typeof serviceIdentifier === 'symbol'\n        ? serviceIdentifier.toString()\n        : serviceIdentifier;\n      throw new Error(`No binding found for service identifier: ${identifierStr}`);\n    }\n    return this.bindings.get(serviceIdentifier) as T;\n  }\n\n  /**\n   * Check if a binding exists for the given service identifier\n   *\n   * @param serviceIdentifier - The string or symbol that identifies the service\n   * @returns true if a binding exists, false otherwise\n   */\n  public isBound(serviceIdentifier: string | symbol): boolean {\n    return this.bindings.has(serviceIdentifier);\n  }\n\n  /**\n   * Remove a binding for the given service identifier\n   *\n   * @param serviceIdentifier - The string or symbol that identifies the service\n   * @returns true if the binding was removed, false if it didn't exist\n   */\n  public unbind(serviceIdentifier: string | symbol): boolean {\n    return this.bindings.delete(serviceIdentifier);\n  }\n\n  /**\n   * Remove all bindings from the container\n   */\n  public unbindAll(): void {\n    this.bindings.clear();\n  }\n\n  /**\n   * Get the number of bindings in the container\n   */\n  public get size(): number {\n    return this.bindings.size;\n  }\n}\n\n/**\n * Fluent interface for binding a constant value to a service identifier\n * This mimics the inversify API: container.bind<T>(key).toConstantValue(value)\n */\nclass ConstantServiceBinder<T> {\n  constructor(\n    private readonly bindings: Map<string | symbol, unknown>,\n    private readonly serviceIdentifier: string | symbol\n  ) {}\n\n  /**\n   * Bind the service identifier to a constant value\n   *\n   * @param value - The instance to bind\n   * @returns void\n   *\n   * @example\n   * ```typescript\n   * container.bind<Logger>(TYPES.Logger).toConstantValue(new ConsoleLogger());\n   * ```\n   */\n  public toConstantValue(value: T): void {\n    this.bindings.set(this.serviceIdentifier, value);\n  }\n}\n", "export const safeStringify = (obj: any, indent = 0) => {\n  let cache: any = []\n  try {\n    const retval = JSON.stringify(\n      obj,\n      (key, value) =>\n        typeof value === 'object' && value !== null\n          ? cache.includes(value)\n            ? undefined // Duplicate reference found, discard key\n            : cache.push(value) && value // Store value in our collection\n          : value,\n      indent\n    )\n    cache = null\n    return retval\n  } catch (err) {\n    cache = null\n    return undefined;\n  }  \n}\n", "export class BooleanStringPair {\n  private readonly booleanValue: boolean\n  private readonly stringValue: string\n\n  constructor(booleanValue: boolean, stringValue: string) {\n    this.booleanValue = booleanValue\n    this.stringValue = stringValue\n  }\n\n  public getBooleanValue(): boolean {\n    return this.booleanValue\n  }\n\n  public getStringValue(): string {\n    return this.stringValue\n  }\n}", "export class OptionallyCachedValue<T> {\n  private readonly cachedFlag: boolean\n  private readonly value: T\n\n  constructor(cachedFlag: boolean, value: T) {\n    this.cachedFlag = cachedFlag\n    this.value = value\n  }\n\n  public isCached(): boolean {\n    return this.cachedFlag\n  }\n\n  public getValue(): T {\n    return this.value\n  }\n}", "import { v6 } from 'uuid';\nimport { BooleanStringPair } from '../container/BooleanStringPair';\nimport { OptionallyCachedValue } from '../container/OptionallyCachedValue';\n\nexport class ObjectIdFinder {\n  private static readonly _mapOfObjectIds: WeakMap<object, string> = new WeakMap<object, string>()\n\n  /**\n   * \n   * @param obj \n   * @returns a OptionallyCachedValue<string> object where the boolean value is true if the object is already being tracked/cached.\n   */\n\n  public static genget(obj: object): OptionallyCachedValue<string> {\n    let objectId: string | undefined = ObjectIdFinder._mapOfObjectIds.get(obj)!\n    \n    if (objectId != null) {\n      return new OptionallyCachedValue(true, objectId)\n    } else {\n      objectId = v6()\n      ObjectIdFinder._mapOfObjectIds.set(obj, objectId)\n      return new OptionallyCachedValue(false, objectId)\n    }\n  }\n\n  public static gengetObjectId(obj: object): string /* UUID */ {\n    const pair = ObjectIdFinder.genget(obj);\n    return pair.getValue();\n  }\n}", "import { DateProviderService } from \"./DateProviderService\";\n\nexport class DateProviderServiceImpl implements DateProviderService {\n  public getNow(): Date {\n    return new Date();\n  }\n}", "import * as dateUtil from \"./dateUtil\";\nimport { DateProviderService } from \"./DateProviderService\";\nimport { UtcGetterService } from \"./UtcGetterService\";\n\nexport class UtcGetterServiceImpl implements UtcGetterService {\n  constructor(private readonly dateProviderService: DateProviderService){}\n\n  public getYyyyMmDdStringAtUtc(): string {\n    return dateUtil.dateToYyyyMmDdStringAtUtc(this.dateProviderService.getNow())\n  }\n\n  public getSpecifiedDateAsUtc(anyDate: Date): Date // UTC date {\n  {\n    const dateAtUtc: Date = new Date(this.dateProviderService.getNow().toUTCString())\n    return dateAtUtc;\n  }\n\n}", "import { Brand } from '../type/Brand';\n\n/**\n * Immutable UTC timestamp as an ISO 8601 string.\n *\n * This branded type provides an immutable alternative to Date objects,\n * which are mutable and can lead to unexpected behavior in domain models.\n *\n * Format: YYYY-MM-DDTHH:mm:ss.sssZ (always in UTC)\n *\n * @example\n * const now = ImmutableUtc.now();\n * const later = ImmutableUtc.fromDate(new Date('2024-12-31T23:59:59Z'));\n * const date = ImmutableUtc.toDate(now);\n */\nexport type ImmutableUtc = Brand<string, 'ImmutableUtc'>;\n\nexport const ImmutableUtc = {\n  /**\n   * Creates an ImmutableUtc from a Date object.\n   *\n   * @param date - The Date object to convert\n   * @returns An immutable UTC timestamp string\n   *\n   * @example\n   * const date = new Date('2024-01-15T10:30:00Z');\n   * const immutable = ImmutableUtc.fromDate(date);\n   * // immutable = '2024-01-15T10:30:00.000Z'\n   */\n  fromDate: (date: Date): ImmutableUtc => {\n    if (!(date instanceof Date)) {\n      throw new Error('ImmutableUtc.fromDate() requires a Date object');\n    }\n    if (isNaN(date.getTime())) {\n      throw new Error('ImmutableUtc.fromDate() received an invalid Date');\n    }\n    return date.toISOString() as ImmutableUtc;\n  },\n\n  /**\n   * Creates an ImmutableUtc representing the current moment.\n   *\n   * @returns An immutable UTC timestamp string for now\n   *\n   * @example\n   * const now = ImmutableUtc.now();\n   */\n  now: (): ImmutableUtc => {\n    return new Date().toISOString() as ImmutableUtc;\n  },\n\n  /**\n   * Parses an ISO 8601 string into a Date object.\n   *\n   * @param dateString - ISO 8601 formatted date string\n   * @returns A Date object\n   * @throws Error if the string cannot be parsed into a valid date\n   *\n   * @example\n   * const date = ImmutableUtc.parse('2024-01-15T10:30:00.000Z');\n   */\n  parse: (dateString: string): Date => {\n    if (typeof dateString !== 'string') {\n      throw new Error('ImmutableUtc.parse() requires a string');\n    }\n    const date = new Date(dateString);\n    if (isNaN(date.getTime())) {\n      throw new Error(`ImmutableUtc.parse() received an invalid date string: ${dateString}`);\n    }\n    return date;\n  },\n\n  /**\n   * Converts an ImmutableUtc to a Date object.\n   *\n   * @param immutableUtc - The immutable UTC timestamp\n   * @returns A Date object\n   * @throws Error if the timestamp cannot be parsed into a valid date\n   *\n   * @example\n   * const immutable = ImmutableUtc.now();\n   * const date = ImmutableUtc.toDate(immutable);\n   */\n  toDate: (immutableUtc: ImmutableUtc): Date => {\n    return ImmutableUtc.parse(immutableUtc);\n  },\n\n  /**\n   * Creates an ImmutableUtc from a Unix timestamp (milliseconds since epoch).\n   *\n   * @param timestamp - Unix timestamp in milliseconds\n   * @returns An immutable UTC timestamp string\n   * @throws Error if the timestamp is not a valid number\n   *\n   * @example\n   * const immutable = ImmutableUtc.fromMillis(1705318200000);\n   * // immutable = '2024-01-15T10:30:00.000Z'\n   */\n  fromMillis: (timestamp: number): ImmutableUtc => {\n    if (typeof timestamp !== 'number' || isNaN(timestamp)) {\n      throw new Error('ImmutableUtc.fromMillis() requires a valid number');\n    }\n    return ImmutableUtc.fromDate(new Date(timestamp));\n  },\n\n  /**\n   * Converts an ImmutableUtc to a Unix timestamp (milliseconds since epoch).\n   *\n   * @param immutableUtc - The immutable UTC timestamp\n   * @returns Unix timestamp in milliseconds\n   *\n   * @example\n   * const immutable = ImmutableUtc.now();\n   * const millis = ImmutableUtc.toMillis(immutable);\n   */\n  toMillis: (immutableUtc: ImmutableUtc): number => {\n    return ImmutableUtc.toDate(immutableUtc).getTime();\n  },\n\n  /**\n   * Creates an ImmutableUtc from a Unix timestamp (seconds since epoch).\n   *\n   * @param timestamp - Unix timestamp in seconds\n   * @returns An immutable UTC timestamp string\n   * @throws Error if the timestamp is not a valid number\n   *\n   * @example\n   * const immutable = ImmutableUtc.fromSeconds(1705318200);\n   * // immutable = '2024-01-15T10:30:00.000Z'\n   */\n  fromSeconds: (timestamp: number): ImmutableUtc => {\n    if (typeof timestamp !== 'number' || isNaN(timestamp)) {\n      throw new Error('ImmutableUtc.fromSeconds() requires a valid number');\n    }\n    return ImmutableUtc.fromMillis(timestamp * 1000);\n  },\n\n  /**\n   * Converts an ImmutableUtc to a Unix timestamp (seconds since epoch).\n   *\n   * @param immutableUtc - The immutable UTC timestamp\n   * @returns Unix timestamp in seconds\n   *\n   * @example\n   * const immutable = ImmutableUtc.now();\n   * const seconds = ImmutableUtc.toSeconds(immutable);\n   */\n  toSeconds: (immutableUtc: ImmutableUtc): number => {\n    return Math.floor(ImmutableUtc.toMillis(immutableUtc) / 1000);\n  },\n\n  /**\n   * Checks if a string is a valid ImmutableUtc (valid ISO 8601 date string).\n   *\n   * @param value - The value to check\n   * @returns True if the value is a valid ISO 8601 date string\n   *\n   * @example\n   * ImmutableUtc.isValid('2024-01-15T10:30:00.000Z'); // true\n   * ImmutableUtc.isValid('not-a-date'); // false\n   */\n  isValid: (value: any): value is ImmutableUtc => {\n    if (typeof value !== 'string') {\n      return false;\n    }\n    try {\n      const date = new Date(value);\n      return !isNaN(date.getTime()) && date.toISOString() === value;\n    } catch {\n      return false;\n    }\n  },\n\n  /**\n   * Compares two ImmutableUtc timestamps.\n   *\n   * @param a - First timestamp\n   * @param b - Second timestamp\n   * @returns Negative if a < b, 0 if equal, positive if a > b\n   *\n   * @example\n   * const earlier = ImmutableUtc.build(new Date('2024-01-01'));\n   * const later = ImmutableUtc.build(new Date('2024-12-31'));\n   * ImmutableUtc.compare(earlier, later); // negative number\n   */\n  compare: (a: ImmutableUtc, b: ImmutableUtc): number => {\n    return ImmutableUtc.toMillis(a) - ImmutableUtc.toMillis(b);\n  },\n\n  /**\n   * Returns the earlier of two ImmutableUtc timestamps.\n   *\n   * @param a - First timestamp\n   * @param b - Second timestamp\n   * @returns The earlier timestamp\n   */\n  min: (a: ImmutableUtc, b: ImmutableUtc): ImmutableUtc => {\n    return ImmutableUtc.compare(a, b) <= 0 ? a : b;\n  },\n\n  /**\n   * Returns the later of two ImmutableUtc timestamps.\n   *\n   * @param a - First timestamp\n   * @param b - Second timestamp\n   * @returns The later timestamp\n   */\n  max: (a: ImmutableUtc, b: ImmutableUtc): ImmutableUtc => {\n    return ImmutableUtc.compare(a, b) >= 0 ? a : b;\n  }\n};\n", "import { Brand } from '../type/Brand';\nimport { isWellFormedCanonicalUuid } from '../string/stringUtil';\nimport { v4, v7 } from 'uuid';\n\n/**\n * Canonical UUID as a branded lowercase string with hyphens.\n *\n * This branded type ensures UUIDs are always in canonical format:\n * lowercase, with hyphens in the standard positions.\n *\n * Format: xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx (all lowercase hex)\n *\n * @example\n * const id = CanonicalUuid.v4();\n * const parsed = CanonicalUuid.fromString('550e8400-e29b-41d4-a716-446655440000');\n * const asString = CanonicalUuid.toString(id);\n */\nexport type CanonicalUuid = Brand<string, 'CanonicalUuid'>;\n\nexport const CanonicalUuid = {\n  /**\n   * Creates a CanonicalUuid from a string, validating and normalizing it.\n   *\n   * The input will be converted to lowercase and validated against\n   * the canonical UUID format.\n   *\n   * @param uuid - UUID string to validate and normalize\n   * @returns A canonical UUID\n   * @throws Error if the string is not a valid UUID\n   *\n   * @example\n   * const id = CanonicalUuid.fromString('550E8400-E29B-41D4-A716-446655440000');\n   * // id = '550e8400-e29b-41d4-a716-446655440000'\n   */\n  fromString: (uuid: string): CanonicalUuid => {\n    if (typeof uuid !== 'string') {\n      throw new Error('CanonicalUuid.fromString() requires a string');\n    }\n\n    const normalized = uuid.toLowerCase().trim();\n\n    if (!isWellFormedCanonicalUuid(normalized)) {\n      throw new Error(`CanonicalUuid.fromString() received an invalid UUID: ${uuid}`);\n    }\n\n    return normalized as CanonicalUuid;\n  },\n\n  /**\n   * Alias for fromString() for consistency with other parse methods.\n   *\n   * @param uuid - UUID string to validate and normalize\n   * @returns A canonical UUID\n   * @throws Error if the string is not a valid UUID\n   */\n  parse: (uuid: string): CanonicalUuid => {\n    return CanonicalUuid.fromString(uuid);\n  },\n\n  /**\n   * Generates a new random UUID v4.\n   *\n   * UUIDv4 uses random numbers and is suitable for general-purpose unique identifiers.\n   *\n   * @returns A new random canonical UUID\n   *\n   * @example\n   * const id = CanonicalUuid.v4();\n   * // id = '550e8400-e29b-41d4-a716-446655440000'\n   */\n  v4: (): CanonicalUuid => {\n    return v4().toLowerCase() as CanonicalUuid;\n  },\n\n  /**\n   * Generates a new time-ordered UUID v7.\n   *\n   * UUIDv7 includes a timestamp and can be sorted chronologically,\n   * making it ideal for database primary keys and time-ordered identifiers.\n   *\n   * @returns A new time-ordered canonical UUID\n   *\n   * @example\n   * const id = CanonicalUuid.v7();\n   * // id = '01878a4a-52d9-7000-8000-000000000000'\n   */\n  v7: (): CanonicalUuid => {\n    return v7().toLowerCase() as CanonicalUuid;\n  },\n\n  /**\n   * Converts a CanonicalUuid to a plain string.\n   *\n   * This is mostly for API consistency - CanonicalUuid is already a string,\n   * but this makes the conversion explicit.\n   *\n   * @param uuid - The canonical UUID\n   * @returns The UUID as a plain string\n   *\n   * @example\n   * const id = CanonicalUuid.v4();\n   * const str = CanonicalUuid.toString(id);\n   */\n  toString: (uuid: CanonicalUuid): string => {\n    return uuid as string;\n  },\n\n  /**\n   * Checks if a value is a valid CanonicalUuid.\n   *\n   * @param value - The value to check\n   * @returns True if the value is a valid canonical UUID\n   *\n   * @example\n   * CanonicalUuid.isValid('550e8400-e29b-41d4-a716-446655440000'); // true\n   * CanonicalUuid.isValid('550E8400-E29B-41D4-A716-446655440000'); // true (case-insensitive check)\n   * CanonicalUuid.isValid('not-a-uuid'); // false\n   * CanonicalUuid.isValid('550e8400e29b41d4a716446655440000'); // false (missing hyphens)\n   */\n  isValid: (value: any): value is CanonicalUuid => {\n    if (typeof value !== 'string') {\n      return false;\n    }\n    return isWellFormedCanonicalUuid(value);\n  },\n\n  /**\n   * Compares two CanonicalUuids lexicographically.\n   *\n   * This is particularly useful for v7 UUIDs, which are time-ordered.\n   * Earlier v7 UUIDs will sort before later ones.\n   *\n   * @param a - First UUID\n   * @param b - Second UUID\n   * @returns Negative if a < b, 0 if equal, positive if a > b\n   *\n   * @example\n   * const earlier = CanonicalUuid.v7();\n   * await sleep(10);\n   * const later = CanonicalUuid.v7();\n   * CanonicalUuid.compare(earlier, later); // negative number\n   */\n  compare: (a: CanonicalUuid, b: CanonicalUuid): number => {\n    return a.localeCompare(b);\n  },\n\n  /**\n   * Returns the lexicographically earlier of two UUIDs.\n   *\n   * For v7 UUIDs, this returns the chronologically earlier UUID.\n   *\n   * @param a - First UUID\n   * @param b - Second UUID\n   * @returns The earlier UUID\n   */\n  min: (a: CanonicalUuid, b: CanonicalUuid): CanonicalUuid => {\n    return CanonicalUuid.compare(a, b) <= 0 ? a : b;\n  },\n\n  /**\n   * Returns the lexicographically later of two UUIDs.\n   *\n   * For v7 UUIDs, this returns the chronologically later UUID.\n   *\n   * @param a - First UUID\n   * @param b - Second UUID\n   * @returns The later UUID\n   */\n  max: (a: CanonicalUuid, b: CanonicalUuid): CanonicalUuid => {\n    return CanonicalUuid.compare(a, b) >= 0 ? a : b;\n  },\n\n  /**\n   * Extracts the version number from a UUID.\n   *\n   * @param uuid - The UUID to inspect\n   * @returns The version number (1-7)\n   *\n   * @example\n   * const v4Id = CanonicalUuid.v4();\n   * CanonicalUuid.getVersion(v4Id); // 4\n   *\n   * const v7Id = CanonicalUuid.v7();\n   * CanonicalUuid.getVersion(v7Id); // 7\n   */\n  getVersion: (uuid: CanonicalUuid): number => {\n    // Version is in the 15th character (M in: xxxxxxxx-xxxx-Mxxx-xxxx-xxxxxxxxxxxx)\n    const versionChar = uuid.charAt(14);\n    return parseInt(versionChar, 16);\n  },\n\n  /**\n   * Checks if a UUID is a v7 (time-ordered) UUID.\n   *\n   * @param uuid - The UUID to check\n   * @returns True if the UUID is version 7\n   */\n  isV7: (uuid: CanonicalUuid): boolean => {\n    return CanonicalUuid.getVersion(uuid) === 7;\n  },\n\n  /**\n   * Checks if a UUID is a v4 (random) UUID.\n   *\n   * @param uuid - The UUID to check\n   * @returns True if the UUID is version 4\n   */\n  isV4: (uuid: CanonicalUuid): boolean => {\n    return CanonicalUuid.getVersion(uuid) === 4;\n  }\n};\n", "import { SimplestKeyValueStore } from './SimplestKeyValueStore';\n\n/**\n * Eviction mode for in-memory key-value store.\n * Currently only LRU (Least Recently Used) is supported.\n */\nexport const EvictionMode = {\n  /** Least Recently Used - evicts the least recently accessed items first */\n  LRU: 'LRU'\n} as const;\n\nexport type EvictionMode = typeof EvictionMode[keyof typeof EvictionMode];\n\n/**\n * Configuration options for SimplestKeyValueStoreInMemImpl.\n */\nexport interface SimplestKeyValueStoreInMemOptions {\n  /**\n   * Maximum aggregate memory usage in bytes (approximate).\n   * When exceeded, items will be evicted according to the eviction mode.\n   *\n   * @example\n   * maxAggregateMemoryInBytes: 10 * 1024 * 1024 // 10 MB\n   */\n  maxAggregateMemoryInBytes: number;\n\n  /**\n   * Eviction mode to use when memory limit is reached.\n   * Currently only LRU (Least Recently Used) is supported.\n   */\n  evictionMode: EvictionMode;\n}\n\ninterface StoredEntry {\n  value: Uint8Array | null;\n  createdAt: number; // timestamp in milliseconds\n  ttlInSeconds?: number;\n}\n\n/**\n * Simple in-memory implementation of SimplestKeyValueStore with LRU eviction.\n *\n * Features:\n * - LRU (Least Recently Used) eviction when memory limit is reached\n * - Approximate memory tracking to prevent OOM\n * - TTL support with lazy expiration\n * - null value support for negative caching\n *\n * Memory estimation:\n * - Key overhead: ~2 bytes per character (UTF-16)\n * - Value: exact byteLength of Uint8Array\n * - Entry overhead: ~100 bytes (timestamps, metadata, Map overhead)\n *\n * @example\n * const store = new SimplestKeyValueStoreInMemImpl({\n *   maxAggregateMemoryInBytes: 10 * 1024 * 1024, // 10 MB\n *   evictionMode: EvictionMode.LRU\n * });\n *\n * const encoder = new TextEncoder();\n * await store.put('key1', encoder.encode('value1'), 60);\n *\n * const result = await store.get('key1');\n * if (result) {\n *   const decoder = new TextDecoder();\n *   console.log(decoder.decode(result.value)); // 'value1'\n * }\n */\nexport class SimplestKeyValueStoreInMemImpl implements SimplestKeyValueStore {\n  private readonly maxAggregateMemoryInBytes: number;\n  private readonly evictionMode: EvictionMode;\n  private readonly store: Map<string, StoredEntry>;\n  private currentMemoryUsage: number;\n\n  // Memory overhead estimates (in bytes)\n  private static readonly ENTRY_OVERHEAD = 100; // metadata, timestamps, Map overhead\n  private static readonly BYTES_PER_CHAR = 2; // UTF-16 approximation\n\n  constructor(options: SimplestKeyValueStoreInMemOptions) {\n    this.maxAggregateMemoryInBytes = options.maxAggregateMemoryInBytes;\n    this.evictionMode = options.evictionMode;\n    this.store = new Map();\n    this.currentMemoryUsage = 0;\n\n    if (this.maxAggregateMemoryInBytes <= 0) {\n      throw new Error('maxAggregateMemoryInBytes must be greater than 0');\n    }\n\n    if (this.evictionMode !== EvictionMode.LRU) {\n      throw new Error(`Unsupported eviction mode: ${this.evictionMode}`);\n    }\n  }\n\n  async put(key: string, value: Uint8Array | null, ttlInSeconds?: number): Promise<void> {\n    // Remove old entry if exists (to update memory accounting)\n    if (this.store.has(key)) {\n      await this.delete(key);\n    }\n\n    // Calculate memory needed for this entry\n    const entryMemory = this.estimateEntryMemory(key, value);\n\n    // Evict items if necessary to make room\n    while (this.currentMemoryUsage + entryMemory > this.maxAggregateMemoryInBytes && this.store.size > 0) {\n      this.evictOldest();\n    }\n\n    // Check if single entry is too large for the store\n    if (entryMemory > this.maxAggregateMemoryInBytes) {\n      throw new Error(\n        `Entry size (${entryMemory} bytes) exceeds maxAggregateMemoryInBytes (${this.maxAggregateMemoryInBytes} bytes)`\n      );\n    }\n\n    // Store the entry\n    const entry: StoredEntry = {\n      value,\n      createdAt: Date.now(),\n      ttlInSeconds\n    };\n\n    this.store.set(key, entry);\n    this.currentMemoryUsage += entryMemory;\n  }\n\n  async get(key: string): Promise<{ value: Uint8Array | null; ageInSeconds: number } | undefined> {\n    const entry = this.store.get(key);\n\n    if (!entry) {\n      return undefined;\n    }\n\n    const now = Date.now();\n    const ageInSeconds = Math.floor((now - entry.createdAt) / 1000);\n\n    // Check if expired\n    if (entry.ttlInSeconds !== undefined && ageInSeconds >= entry.ttlInSeconds) {\n      // Lazy deletion of expired entry\n      await this.delete(key);\n      return undefined;\n    }\n\n    // LRU: Move to end (most recently used)\n    this.store.delete(key);\n    this.store.set(key, entry);\n\n    return {\n      value: entry.value,\n      ageInSeconds\n    };\n  }\n\n  async exists(key: string): Promise<boolean> {\n    const entry = this.store.get(key);\n\n    if (!entry) {\n      return false;\n    }\n\n    const now = Date.now();\n    const ageInSeconds = Math.floor((now - entry.createdAt) / 1000);\n\n    // Check if expired\n    if (entry.ttlInSeconds !== undefined && ageInSeconds >= entry.ttlInSeconds) {\n      // Lazy deletion of expired entry\n      await this.delete(key);\n      return false;\n    }\n\n    // LRU: Move to end (most recently used)\n    this.store.delete(key);\n    this.store.set(key, entry);\n\n    return true;\n  }\n\n  async delete(key: string): Promise<boolean> {\n    const entry = this.store.get(key);\n\n    if (!entry) {\n      return false;\n    }\n\n    this.store.delete(key);\n    this.currentMemoryUsage -= this.estimateEntryMemory(key, entry.value);\n\n    return true;\n  }\n\n  /**\n   * Get current approximate memory usage in bytes.\n   */\n  getCurrentMemoryUsage(): number {\n    return this.currentMemoryUsage;\n  }\n\n  /**\n   * Get number of entries currently stored.\n   */\n  getEntryCount(): number {\n    return this.store.size;\n  }\n\n  /**\n   * Clear all entries from the store.\n   */\n  clear(): void {\n    this.store.clear();\n    this.currentMemoryUsage = 0;\n  }\n\n  /**\n   * Estimate memory usage for a single entry (approximate).\n   */\n  private estimateEntryMemory(key: string, value: Uint8Array | null): number {\n    const keyMemory = key.length * SimplestKeyValueStoreInMemImpl.BYTES_PER_CHAR;\n    const valueMemory = value?.byteLength ?? 0;\n    const overhead = SimplestKeyValueStoreInMemImpl.ENTRY_OVERHEAD;\n\n    return keyMemory + valueMemory + overhead;\n  }\n\n  /**\n   * Evict the oldest (least recently used) entry.\n   */\n  private evictOldest(): void {\n    // Map maintains insertion order; first key is least recently used\n    const firstKey = this.store.keys().next().value;\n\n    if (firstKey !== undefined) {\n      this.delete(firstKey); // async but we can use synchronously here since it's internal\n    }\n  }\n}\n", "import * as stringUtil from \"../string/stringUtil\";\n\nexport class CsvDataExtractor {\n  private readonly headerNameToIndexMap: Map<string, number> = new Map();\n  private readonly numNamedColumns: number;\n\n  constructor(private readonly numHeaderRows: number, private rowsOfCells: Array<Array<any>>) {\n    if (!Array.isArray(rowsOfCells)) {\n      throw new Error(\"Invalid Rows-of-Cells\")\n    }\n\n    const numRows = rowsOfCells.length\n\n    const mostRelevantRowIndex = numHeaderRows - 1;\n    const headerRowOfCells = rowsOfCells[mostRelevantRowIndex];\n    \n\n    if (!Array.isArray(headerRowOfCells)) {\n      throw new Error(\"Invalid Header-Row-of-Cells\")\n    }\n\n    this.numNamedColumns = headerRowOfCells.length\n\n    for (let ii = 0; ii < this.numNamedColumns; ++ii) {\n      const headerName = headerRowOfCells[ii]\n      if (stringUtil.isBlank(headerName)) {\n        throw new Error(\"Header column missing a name\")\n      }\n      if (this.headerNameToIndexMap.has(headerName)) {\n        throw new Error(`Duplicate header: ${headerName}`)\n      }\n      this.headerNameToIndexMap.set(headerName, ii)\n    }\n  }\n\n  public getIndexOfHeaderName(headerName: string): number {\n    const retval: number | undefined = this.headerNameToIndexMap.get(headerName);\n    if (typeof retval === 'undefined') {\n      throw new  Error(`No column matching headerName = ${headerName}`)\n    } \n    return retval;\n  }\n\n  public getDataCorrespondingToHeaderInRow(headerName: string, rowOfData: Array<any>): any {\n    if (!Array.isArray(rowOfData)) {\n      throw new Error(\"Invalid row of data\")\n    }\n    const index = this.getIndexOfHeaderName(headerName);\n    return rowOfData[index];\n  }  \n}", "import { LlmQuery } from \"./LlmQuery\";\nimport { JsonValue } from \"../json/JsonValue\";\nimport { LlmQAndA } from \"./LlmQAndA\";\nimport { JsonObjectOrArray } from \"../json/JsonObjectOrArray\";\n\n/**\n * Mutable Rich model associated with the anemic model 'LlmQuery'\n */\n\nexport class LlmQueryImpl implements LlmQuery {\n  private readonly _attr: LlmQuery = {} as LlmQuery;\n\n  constructor(llmQuery: LlmQuery) {\n    this._attr = llmQuery || {}\n  }\n\n  public addQuestion(questionText: string): void {\n    this._attr.qAndA = this._attr.qAndA || []\n    this._attr.qAndA.push({question: questionText} as LlmQAndA)\n  }\n\n  public get prompt(): string {\n    return this._attr.prompt;\n  }\n\n  public set prompt(input: string) {\n    this._attr.prompt = input;\n  }\n\n  public get additionalContext(): JsonObjectOrArray {\n    return this._attr.additionalContext;\n  }\n\n  public set additionalContext(input: JsonObjectOrArray) {\n    this._attr.additionalContext = input;\n  }\n\n  public get qAndA(): Array<LlmQAndA> {\n    return this._attr.qAndA;\n  }\n\n  public set qAndA(input: Array<LlmQAndA>) {\n    this._attr.qAndA = input;\n  }\n}", "import { AddEventHandlerService } from '../AddEventHandlerService'\nimport { Span, Tracer } from './trace'\nimport { getLogger } from \"../../log/getLogger\"\nimport { d4l } from \"../../log/logUtil\"\n\nconst LOG = getLogger(\"NoOpAddEventHandler\");\n/**\n * A no-op implementation of AddEventHandlerService for testing purposes.\n * This handler does nothing when addEvent is called.\n */\nexport class NoOpAddEventHandler implements AddEventHandlerService {\n  public addEvent(tracer: Tracer, span: Span, name: string, attributes?: Record<string, any>, time?: Date | number): void {\n    // No-op: does nothing\n    LOG.debug(() => `addEvent(): Entering with tracer = ${d4l(tracer)},  span = ${d4l(span)},  name = ${d4l(name)},  attributes = ${d4l(attributes)},  time = ${d4l(time)}`);\n  }\n}", "import { SpanEndHandlingService } from '../SpanEndHandlingService'\nimport { Span } from './trace'\nimport { getLogger } from \"../../log/getLogger\"\nimport { d4l } from \"../../log/logUtil\"\n\nconst LOG = getLogger(\"NoOpSpanEndHandler\");\n\n/**\n * A no-op implementation of SpanEndHandlingService for testing purposes.\n * This handler does nothing when spanEndJustInvoked is called.\n */\nexport class NoOpSpanEndHandler implements SpanEndHandlingService {\n  public spanEndJustInvoked(span: Span): void {\n    // No-op: does nothing\n    LOG.debug(() => `spanEndJustInvoked(): Entering with span = ${d4l(span)}`);\n  }\n}", "/**\n * Retry policy configuration for handling eventual consistency\n * and transient failures in document databases.\n *\n * Example usage:\n * ```typescript\n * const policy: RetryPolicy = {\n *   maxAttempts: 5,\n *   initialDelayMs: 100,\n *   maxDelayMs: 10000,\n *   backoffMultiplier: 2,\n *   jitter: 0.1,\n *   retryableOperations: ['get', 'query'] // Only retry reads\n * };\n *\n * // Wrap your document store with retry logic\n * const retryableStore = new RetryableDocumentStoreServiceImpl(\n *   baseDocumentStore,\n *   policy\n * );\n * ```\n */\nexport interface RetryPolicy {\n  /**\n   * Maximum number of retry attempts\n   * @default 3\n   */\n  maxAttempts: number;\n\n  /**\n   * Initial delay in milliseconds before first retry\n   * @default 100\n   */\n  initialDelayMs: number;\n\n  /**\n   * Maximum delay in milliseconds (caps exponential backoff)\n   * @default 5000\n   */\n  maxDelayMs: number;\n\n  /**\n   * Backoff multiplier for exponential backoff\n   * Delay calculation: initialDelayMs * (backoffMultiplier ^ (attempt - 1))\n   * @default 2\n   */\n  backoffMultiplier: number;\n\n  /**\n   * Jitter factor to prevent thundering herd (0.0 to 1.0)\n   * Adds randomness: delay * (1 + random(-jitter, +jitter))\n   * @default 0.1\n   */\n  jitter: number;\n\n  /**\n   * Which operations should be retried\n   * Generally safer to only retry idempotent reads\n   * @default ['get', 'query']\n   */\n  retryableOperations: ('get' | 'query' | 'put' | 'delete' | 'update')[];\n}\n\n/**\n * Default retry policy - conservative settings suitable for most use cases\n */\nexport const DEFAULT_RETRY_POLICY: RetryPolicy = {\n  maxAttempts: 3,\n  initialDelayMs: 100,\n  maxDelayMs: 2000,\n  backoffMultiplier: 2,\n  jitter: 0.1,\n  retryableOperations: ['get', 'query'], // Only retry reads by default\n};\n\n/**\n * Aggressive retry policy for production environments with high availability requirements\n */\nexport const AGGRESSIVE_RETRY_POLICY: RetryPolicy = {\n  maxAttempts: 5,\n  initialDelayMs: 50,\n  maxDelayMs: 10000,\n  backoffMultiplier: 2,\n  jitter: 0.15,\n  retryableOperations: ['get', 'query', 'put', 'update'], // Retry writes too\n};\n", "/**\n * Options for handling read-after-write consistency in eventually consistent databases.\n *\n * In systems like DynamoDB, a write may not be immediately visible on subsequent reads\n * due to eventual consistency. These options control polling behavior to wait for\n * consistency.\n *\n * Example usage:\n * ```typescript\n * const options: ReadAfterWriteOptions = {\n *   timeoutMs: 5000,\n *   pollIntervalMs: 100,\n *   validator: (data) => {\n *     // Ensure the data has the expected shape\n *     return data !== null && typeof data === 'object';\n *   }\n * };\n *\n * // Use with a consistency helper\n * await consistencyHelper.putDocumentAndWaitForConsistency(\n *   'users',\n *   user,\n *   { userId: user.id },\n *   options\n * );\n * ```\n */\nexport interface ReadAfterWriteOptions {\n  /**\n   * Maximum time to wait for consistency (milliseconds)\n   * @default 5000\n   */\n  timeoutMs: number;\n\n  /**\n   * Delay between polling attempts (milliseconds)\n   * @default 100\n   */\n  pollIntervalMs: number;\n\n  /**\n   * Optional validator function to verify data consistency\n   * Returns true if the data meets consistency requirements\n   *\n   * Useful for checking not just presence but correctness:\n   * - Field values match expected state\n   * - Related records are visible\n   * - Secondary indexes are updated\n   *\n   * @param data - The document retrieved from the database\n   * @returns true if data is consistent, false to continue polling\n   */\n  validator?: (data: unknown) => boolean;\n}\n\n/**\n * Default read-after-write options - suitable for most use cases\n */\nexport const DEFAULT_READ_AFTER_WRITE_OPTIONS: ReadAfterWriteOptions = {\n  timeoutMs: 5000,\n  pollIntervalMs: 100,\n};\n\n/**\n * Fast read-after-write options - for low-latency requirements\n */\nexport const FAST_READ_AFTER_WRITE_OPTIONS: ReadAfterWriteOptions = {\n  timeoutMs: 1000,\n  pollIntervalMs: 50,\n};\n\n/**\n * Patient read-after-write options - for complex consistency scenarios\n */\nexport const PATIENT_READ_AFTER_WRITE_OPTIONS: ReadAfterWriteOptions = {\n  timeoutMs: 30000,\n  pollIntervalMs: 500,\n};\n"],
  "mappings": "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",
  "names": ["index_browser_exports", "__export", "AGGRESSIVE_RETRY_POLICY", "BooleanStringPair", "CanonicalUuid", "Container", "CsvDataExtractor", "DEFAULT_READ_AFTER_WRITE_OPTIONS", "DEFAULT_RETRY_OPTIONS", "DEFAULT_RETRY_POLICY", "DateProviderServiceImpl", "EvictionMode", "FAST_READ_AFTER_WRITE_OPTIONS", "ImmutableUtc", "LOG_RULES", "LlmQueryImpl", "NoOpAddEventHandler", "NoOpSpanEndHandler", "ObjectIdFinder", "OptionallyCachedValue", "PATIENT_READ_AFTER_WRITE_OPTIONS", "SimplestKeyValueStoreInMemImpl", "UtcGetterServiceImpl", "anyUtil_exports", "arrayUtil_exports", "b4l", "blur", "blurIfEnabled", "blurWhereNeeded", "booleanUtil_exports", "c4l", "cloneUtil_exports", "d4l", "d4lObfuscate", "d4lPii", "dateUtil_exports", "diceUtil_exports", "emailUtil_exports", "environmentUtil_exports", "extendedExceptionList_exports", "extractIpAddress", "functionUtil_exports", "getLogger", "idUtil_exports", "jsonUtil_exports", "logUtil_exports", "mapUtil_exports", "numberUtil_exports", "objectUtil_exports", "p4l", "phoneUtil_exports", "plain", "radixUtil_exports", "requestUtil_exports", "retryUtil_exports", "retryWithBackoff", "s4l", "safeStringify", "shortcodeUtil_exports", "statUtil_exports", "stringUtil_exports", "tryUtil_exports", "uuidUtil_exports", "withStoreId", "anyUtil_exports", "__export", "hasValue", "isNullish", "input", "objectUtil_exports", "cloneUtil_exports", "__export", "cloneDeep", "cloneWithOverrides", "obj", "original", "overrides", "stringUtil_exports", "__export", "isBlank", "isEmpty", "isPresent", "isWellFormedCanonicalUuid", "padLeftWithZeros", "tryRemoveDoubleSlashesIfPresent", "tryRemoveTrailingSlashesIfPresent", "input", "regexp", "notLessThanXDigits", "workingValue", "opt", "booleanUtil_exports", "__export", "doesImplyTrue", "isTrueIsh", "isTrueLike", "isTruelike", "input", "logUtil_exports", "__export", "b4l", "blur", "blurIfEnabled", "blurWhereNeeded", "c4l", "d4l", "d4lObfuscate", "d4lPii", "p4l", "plain", "s4l", "environmentUtil_exports", "__export", "isDevelopmentLikeEnv", "isEagerAutoSanitizeEnabled", "isProductionLikeEnv", "isStagingLikeEnv", "isTestLikeEnv", "resetEnvVarCache", "tryGetEnvVar", "memoized", "envVarName", "retval", "prefixes", "ii", "prefix", "effectiveEnvVarName", "nodeEnv", "value", "isTruelike", "input", "smartObfuscate", "input", "len", "parts", "local", "domain", "words", "nodeCrypto", "PII_FIELDS", "isPIISecureModeEnabled", "secret", "tryGetEnvVar", "hashPII", "value", "hashPIIValue", "sanitizePII", "obj", "item", "sanitized", "key", "lowerKey", "keyWithoutUnderscore", "piiField", "lowerPIIField", "hashedKey", "scanStringValueForPII", "input", "result", "match", "digits", "parts", "local", "domain", "p", "first", "last", "eagerSanitizePII", "obj", "item", "sanitized", "key", "value", "lowerKey", "keyWithoutUnderscore", "isPIIField", "PII_FIELDS", "piiField", "lowerPIIField", "obfuscated", "smartObfuscate", "isPIISecureModeEnabled", "hash", "hashPIIValue", "stringValue", "scanned", "d4l", "input", "logOptions", "smartObfuscate", "stackStr", "parts", "inputAsArray", "objectToLog", "isEagerAutoSanitizeEnabled", "eagerSanitizePII", "whateverAsJsonReturns", "localSafeStringify", "d4lObfuscate", "sanitized", "obfuscated", "isPIISecureModeEnabled", "hash", "hashPIIValue", "d4lPii", "scanObjectForPII", "obj", "item", "scanStringForPII", "scanned", "key", "value", "result", "match", "digits", "local", "domain", "p", "first", "last", "blurWhereNeeded", "plain", "blur", "blurIfEnabled", "p4l", "b4l", "c4l", "s4l", "indent", "cache", "retval", "numberUtil_exports", "__export", "ensureNumber", "tryAsNumber", "input", "workingInput", "err", "dateUtil_exports", "__export", "dateToYyyyMmDdStringAtUtc", "generateSortedFiveMinuteBucketsForYearInSeconds", "getDateInLondon", "getMillisecondsBetweenDates", "getMillisecondsBetweenEpochAndDate", "getSecondsBetweenDates", "getSecondsBetweenEpochAndDate", "isIso8601", "isIso8601Utc", "isValidDateObject", "year", "firstMomentOfYear", "firstMomentOfNextYear", "retval", "workingValueInMilliseconds", "date", "dateAtUtc", "padLeftWithZeros", "input", "notLessThanXDigits", "workingValue", "start", "end", "obj", "d", "mapUtil_exports", "__export", "getKeys", "myMap", "functionUtil_exports", "__export", "tryFn", "fn", "extendedExceptionList_exports", "__export", "ActuallyUnauthenticated401Exception", "ArgumentException", "BadRequest400Exception", "Forbidden403Exception", "InternalServerError500Exception", "NotFound404Exception", "NotImplementedException", "ProgrammerErrorException", "ServiceUnavailable503Exception", "ProgrammerErrorException", "_ProgrammerErrorException", "msg", "BadRequest400Exception", "_BadRequest400Exception", "msg", "ActuallyUnauthenticated401Exception", "_ActuallyUnauthenticated401Exception", "msg", "Forbidden403Exception", "_Forbidden403Exception", "msg", "NotFound404Exception", "_NotFound404Exception", "msg", "ArgumentException", "_ArgumentException", "msg", "InternalServerError500Exception", "_InternalServerError500Exception", "msg", "ServiceUnavailable503Exception", "_ServiceUnavailable503Exception", "msg", "NotImplementedException", "_NotImplementedException", "msg", "arrayUtil_exports", "__export", "existsButIsEmpty", "hasExactlyOneItem", "isPopulated", "tryParseStringToArray", "input", "parts", "result", "part", "trimmedPart", "tryUtil_exports", "__export", "tryCatchTuplify", "tryCatchTuplifyAsync", "fn", "error", "promise", "radixUtil_exports", "__export", "convertHexToBase62", "convertHexToNanoIdAlphabet", "decodeBase62ToNumber", "encodeNumberAsBase62", "BASE62_ALPHABET", "NANOID_ALPHABET", "encodeNumberAsBase62", "num", "result", "BASE62_ALPHABET", "BASE62_CHAR_MAP", "char", "i", "decodeBase62ToNumber", "str", "value", "convertHexToBase62", "hex", "decimal", "digit", "multiplyDecimalStringByInt", "addDecimalStrings", "quotient", "remainder", "divideDecimalStringByInt", "convertHexToNanoIdAlphabet", "NANOID_ALPHABET", "multiplier", "carry", "product", "a", "b", "j", "digitA", "digitB", "sum", "divisor", "accumulator", "q", "uuidUtil_exports", "__export", "generateV6", "generateV7", "regex_default", "validate", "uuid", "regex_default", "validate_default", "parse", "uuid", "validate_default", "v", "parse_default", "byteToHex", "i", "unsafeStringify", "arr", "offset", "getRandomValues", "rnds8", "rng", "_state", "v1", "options", "buf", "offset", "bytes", "isV6", "optionsKeys", "v1Bytes", "rng", "now", "rnds", "updateV1State", "unsafeStringify", "state", "msecs", "nsecs", "clockseq", "node", "tl", "tmh", "n", "v1_default", "v1ToV6", "uuid", "v1Bytes", "parse_default", "v6Bytes", "_v1ToV6", "unsafeStringify", "randomUUID", "native_default", "v4", "options", "buf", "offset", "native_default", "rnds", "rng", "i", "unsafeStringify", "v4_default", "v6", "options", "buf", "offset", "bytes", "v1_default", "v1ToV6", "i", "unsafeStringify", "v6_default", "_state", "v7", "options", "buf", "offset", "bytes", "v7Bytes", "rng", "now", "rnds", "updateV7State", "unsafeStringify", "state", "msecs", "seq", "v7_default", "generateV6", "v6_default", "generateV7", "v7_default", "idUtil_exports", "__export", "generateTimeOrderedBase62Id", "generateTimeOrderedNanoLikeId", "generateTimeOrderedBase62Id", "convertHexToBase62", "v7_default", "generateTimeOrderedNanoLikeId", "convertHexToNanoIdAlphabet", "emailUtil_exports", "__export", "normalizeEmail", "email", "phoneUtil_exports", "__export", "normalizePhone", "phone", "normalized", "hasPlus", "digits", "diceUtil_exports", "__export", "beTrueXPercentOfTheTime", "rollOneDie", "xTimesRollDie", "numSides", "numRolls", "total", "ii", "percent", "shortcodeUtil_exports", "__export", "ALPHABET_56", "ALPHABET_58", "calculateCombinations", "generateShortCode56", "generateShortCode58", "normalizeShortCode58", "length", "code", "i", "randomIndex", "shortCode", "alphabetSize", "requestUtil_exports", "__export", "extractIpAddress", "statUtil_exports", "__export", "sendPlusOneCountToStathat", "sendStatToKpitracks", "countStatName", "controller", "timeoutId", "url", "requestBody", "beforeAt", "response", "deltaInMs", "err", "requestBodyString", "kpitracksEzKey", "_globalThis", "VERSION", "re", "_makeCompatibilityCheck", "ownVersion", "acceptedVersions", "rejectedVersions", "myVersionMatch", "ownVersionParsed", "globalVersion", "_reject", "v", "_accept", "globalVersionMatch", "globalVersionParsed", "isCompatible", "VERSION", "major", "VERSION", "GLOBAL_OPENTELEMETRY_API_KEY", "_global", "_globalThis", "registerGlobal", "type", "instance", "diag", "allowOverride", "api", "_a", "err", "getGlobal", "globalVersion", "isCompatible", "_b", "unregisterGlobal", "DiagComponentLogger", "props", "args", "_i", "logProxy", "logProxy", "funcName", "namespace", "args", "logger", "getGlobal", "__spreadArray", "__read", "DiagLogLevel", "createLogLevelDiagLogger", "maxLevel", "logger", "DiagLogLevel", "_filterFunc", "funcName", "theLevel", "theFunc", "API_NAME", "DiagAPI", "_logProxy", "funcName", "args", "_i", "logger", "getGlobal", "__spreadArray", "__read", "self", "setLogger", "optionsOrLogLevel", "DiagLogLevel", "err", "_a", "oldLogger", "newLogger", "createLogLevelDiagLogger", "_b", "stack", "_c", "registerGlobal", "unregisterGlobal", "options", "DiagComponentLogger", "createContextKey", "description", "BaseContext", "parentContext", "self", "key", "value", "context", "ROOT_CONTEXT", "NoopContextManager", "ROOT_CONTEXT", "_context", "fn", "thisArg", "args", "_i", "__spreadArray", "__read", "target", "API_NAME", "NOOP_CONTEXT_MANAGER", "NoopContextManager", "ContextAPI", "contextManager", "registerGlobal", "DiagAPI", "context", "fn", "thisArg", "args", "_i", "_a", "__spreadArray", "__read", "target", "getGlobal", "unregisterGlobal", "TraceFlags", "INVALID_SPANID", "INVALID_TRACEID", "INVALID_SPAN_CONTEXT", "TraceFlags", "NonRecordingSpan", "_spanContext", "INVALID_SPAN_CONTEXT", "_key", "_value", "_attributes", "_name", "_link", "_links", "_status", "_endTime", "_exception", "_time", "SPAN_KEY", "createContextKey", "getSpan", "context", "getActiveSpan", "ContextAPI", "setSpan", "span", "deleteSpan", "setSpanContext", "spanContext", "NonRecordingSpan", "getSpanContext", "_a", "VALID_TRACEID_REGEX", "VALID_SPANID_REGEX", "isValidTraceId", "traceId", "INVALID_TRACEID", "isValidSpanId", "spanId", "INVALID_SPANID", "isSpanContextValid", "spanContext", "wrapSpanContext", "NonRecordingSpan", "contextApi", "ContextAPI", "NoopTracer", "name", "options", "context", "root", "NonRecordingSpan", "parentFromContext", "getSpanContext", "isSpanContext", "isSpanContextValid", "arg2", "arg3", "arg4", "opts", "ctx", "fn", "parentContext", "span", "contextWithSpanSet", "setSpan", "isSpanContext", "spanContext", "NOOP_TRACER", "NoopTracer", "ProxyTracer", "_provider", "name", "version", "options", "context", "_name", "_options", "_context", "_fn", "tracer", "NoopTracerProvider", "_name", "_version", "_options", "NoopTracer", "NOOP_TRACER_PROVIDER", "NoopTracerProvider", "ProxyTracerProvider", "name", "version", "options", "_a", "ProxyTracer", "delegate", "context", "ContextAPI", "API_NAME", "TraceAPI", "ProxyTracerProvider", "wrapSpanContext", "isSpanContextValid", "deleteSpan", "getSpan", "getActiveSpan", "getSpanContext", "setSpan", "setSpanContext", "provider", "success", "registerGlobal", "DiagAPI", "getGlobal", "name", "version", "unregisterGlobal", "trace", "TraceAPI", "AsyncLocalStorage", "ALS", "asyncLocalStorage", "LoggerFactory", "_LoggerFactory", "loggerName", "logger", "Logger", "severity", "msg", "context", "isTruelike", "tryGetEnvVar", "json", "mergedJson", "jsonContext", "storeInLocalStorage", "storeId", "span", "trace", "traceId", "spanId", "isEagerAutoSanitizeEnabled", "eagerSanitizePII", "sanitizePII", "messageParts", "wouldBeJsonContextString", "extra", "isLogLevelEnabled", "completeMsg", "controller", "timeoutId", "url", "requestBody", "beforeAt", "response", "deltaInMs", "err", "sendStatToKpitracks", "getLogger", "withStoreId", "fn", "input", "LOG_RULES", "matchesPattern", "pattern", "regexPattern", "part", "parseLogLevelRules", "findMatchingLogLevel", "rules", "rule", "cachedLogLevelRules", "getLogLevelRules", "cachedParsedLogLevel", "parseLogLevelFromEnv", "logLevelValue", "tryGetEnvVar", "normalizedValue", "validLevels", "isLogLevelEnabled", "loggerName", "level", "rules", "getLogLevelRules", "configuredLevel", "findMatchingLogLevel", "levelHierarchy", "configuredIndex", "individualLevelSet", "individualLevelEnabled", "traceEnv", "isTruelike", "debugEnv", "infoEnv", "noticeEnv", "warnEnv", "errorEnv", "fatalEnv", "logLevel", "LOG", "getLogger", "extractIpAddress", "req", "getHeader", "name", "value", "forwarded", "realIp", "socketAddr", "d4l", "firstIp", "retryUtil_exports", "__export", "DEFAULT_RETRY_OPTIONS", "retryWithBackoff", "calculateDelay", "attempt", "backoffMs", "backoffMultiplier", "jitter", "maxDelayMs", "delay", "jitterAmount", "operation", "options", "maxAttempts", "shouldRetry", "onRetry", "onFailure", "lastError", "lastResult", "result", "delayMs", "resolve", "error", "jsonUtil_exports", "__export", "recursivelyFilterPropertiesCopy", "recursivelyFilterPropertiesInPlace", "obj", "listOfPropertyNamesToRemove", "item", "key", "clone", "Container", "serviceIdentifier", "ConstantServiceBinder", "identifierStr", "bindings", "value", "safeStringify", "obj", "indent", "cache", "retval", "key", "value", "BooleanStringPair", "booleanValue", "stringValue", "OptionallyCachedValue", "cachedFlag", "value", "_ObjectIdFinder", "obj", "objectId", "OptionallyCachedValue", "v6_default", "ObjectIdFinder", "DateProviderServiceImpl", "UtcGetterServiceImpl", "dateProviderService", "dateToYyyyMmDdStringAtUtc", "anyDate", "ImmutableUtc", "date", "dateString", "immutableUtc", "timestamp", "value", "a", "b", "CanonicalUuid", "uuid", "normalized", "isWellFormedCanonicalUuid", "v4_default", "v7_default", "value", "a", "b", "versionChar", "EvictionMode", "_SimplestKeyValueStoreInMemImpl", "options", "key", "value", "ttlInSeconds", "entryMemory", "entry", "now", "ageInSeconds", "keyMemory", "valueMemory", "overhead", "firstKey", "SimplestKeyValueStoreInMemImpl", "CsvDataExtractor", "numHeaderRows", "rowsOfCells", "numRows", "mostRelevantRowIndex", "headerRowOfCells", "ii", "headerName", "isBlank", "retval", "rowOfData", "index", "LlmQueryImpl", "llmQuery", "questionText", "input", "LOG", "getLogger", "NoOpAddEventHandler", "tracer", "span", "name", "attributes", "time", "d4l", "LOG", "getLogger", "NoOpSpanEndHandler", "span", "d4l", "DEFAULT_RETRY_POLICY", "AGGRESSIVE_RETRY_POLICY", "DEFAULT_READ_AFTER_WRITE_OPTIONS", "FAST_READ_AFTER_WRITE_OPTIONS", "PATIENT_READ_AFTER_WRITE_OPTIONS"]
}
